{"remainingRequest":"/Library/WebServer/Documents/Projects/OPINIION FINAL/opiniionv4/node_modules/vue-loader/lib/index.js??vue-loader-options!/Library/WebServer/Documents/Projects/OPINIION FINAL/opiniionv4/src/components/CSVPreview.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Library/WebServer/Documents/Projects/OPINIION FINAL/opiniionv4/src/components/CSVPreview.vue","mtime":1581270622000},{"path":"/Library/WebServer/Documents/Projects/OPINIION FINAL/opiniionv4/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/Projects/OPINIION FINAL/opiniionv4/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/Projects/OPINIION FINAL/opiniionv4/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/Projects/OPINIION FINAL/opiniionv4/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBDdXN0b21lclNlcnZpY2UgZnJvbSAiLi8uLi9zZXJ2aWNlcy9DdXN0b21lclNlcnZpY2UiOwppbXBvcnQgVXNlclNlcnZpY2UgZnJvbSAiLi8uLi9zZXJ2aWNlcy9Vc2VyU2VydmljZSI7CmltcG9ydCB7IEV2ZW50U2VydmljZSB9IGZyb20gIi4uL21haW4iOwppbXBvcnQgdlNlbGVjdCBmcm9tICIuLi8uLi9ub2RlX21vZHVsZXMvdnVlLXNlbGVjdC9zcmMvY29tcG9uZW50cy9TZWxlY3QudnVlIjsKaW1wb3J0IFVwbG9hZFNlcnZpY2UgZnJvbSAnLi4vc2VydmljZXMvVXBsb2FkU2VydmljZSc7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImNzdlByZXZpZXciLAogIHByb3BzOiBbInJhd0RhdGEiLCAiZmlsZU5hbWUiXSwKICBjb21wb25lbnRzOiB7CiAgICB2U2VsZWN0CiAgfSwKICBkYXRhOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiB7CiAgICAgIGNzdjogW10sCiAgICAgIGN1c3RvbWVyOiB7CiAgICAgICAgY291bnRyeTogIisxIiwKICAgICAgICB0ZW1wbGF0ZTogImRlZmF1bHQiLAogICAgICAgIHN0YXR1czogImFjdGl2ZSIKICAgICAgfSwKICAgICAgbG9jYXRpb25PcHRpb25zOiBbXSwKICAgICAgY3VzdG9tZXJzTGlzdDogW10sCiAgICAgIHJlYWR5OiBmYWxzZSwKICAgICAgY3N2RGF0YTogW10sCiAgICAgIHRlbXBsYXRlT3B0aW9uczogWyJkZWZhdWx0IiwgIlExIiwgIlEyIiwgIlEzIiwgIlE0Il0sCiAgICAgIGludmFsaWRSZWNvcmRzOiAwLAogICAgICBoZWFkZXJzOiBbXSwKICAgICAgY3VzdG9tZXJIZWFkZXI6IFsiZmlyc3ROYW1lIiwgImxhc3ROYW1lIiwgInBob25lIiwgImVtYWlsIiwgIm5vdGVzIl0sCiAgICAgIGluZGV4MTogMCwKICAgICAgaW5kZXgyOiAxLAogICAgICBpbmRleDM6IDIsCiAgICAgIGluZGV4NDogMywKICAgICAgaW5kZXg1OiA0LAogICAgICB1cGRhdGVkT25jZTogZmFsc2UKICAgIH07CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5zZWxlY3RlZExvY2F0aW9uID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oImxvY2F0aW9uSWQiKTsKICAgIHRoaXMuZ2V0TG9jYXRpb25PcHRpb25zKCk7CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIGlzUmVhZHkoKSB7CiAgICAgIGlmICh0aGlzLnJhd0RhdGEubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMuY3N2RGF0YSA9IHRoaXMucmF3RGF0YTsKICAgICAgfQogICAgICBpZiAodGhpcy5jc3ZEYXRhICYmIHRoaXMuY3N2RGF0YS5sZW5ndGggPT0gdGhpcy5yYXdEYXRhLmxlbmd0aCkgewogICAgICAgIGlmICh0aGlzLmhlYWRlcnMubGVuZ3RoIDwgMSkgewogICAgICAgICAgdGhpcy5oZWFkZXJzID0gdGhpcy5jc3ZEYXRhLnNoaWZ0KCk7CiAgICAgICAgfQogICAgICAgIGlmICh0aGlzLmhlYWRlcnMpIHsKICAgICAgICAgIHRoaXMubWFwSGVhZGVycygpOwogICAgICAgICAgdGhpcy5tYXBEYXRhKCk7CiAgICAgICAgICB0aGlzLnVwZGF0ZWRPbmNlID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgdGhpcy5yZWFkeSA9IHRydWU7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgaXNSZWFkeShuKSB7CiAgICAgIGlmIChuID09IHRydWUpIHsKICAgICAgICAvLyBjb25zb2xlLmxvZyhuKTsKICAgICAgICBudWxsOwogICAgICB9CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICByZW1vdmVEdXBsaWNhdGVzKGxpc3QpIHsKICAgICAgbGV0IHZtID0gdGhpczsKICAgICAgLy8gUmVtb3ZlcyAidW5kZWZpbmVkIiBjdXN0b21lcnMgcHJpb3IgdG8gc2NydWJiaW5nIGFnYWluc3QgdGhlIGNzdiBpdHNlbGYuCiAgICAgIGxldCBpbml0aWFsU2NydWJMaXN0ID0gbGlzdC5maWx0ZXIoZSA9PiBlKTsKICAgICAgLy8gUmVkdWNlIHRvIGEgbmV3IGFycmF5CiAgICAgIGxldCBmaWx0ZXJlZEFyciA9IGluaXRpYWxTY3J1Ykxpc3QucmVkdWNlKChhY2MsIGN1cnJlbnQpID0+IHsKICAgICAgICAvLyBBcyBsb25nIGFzIHRoZSBjdXJyZW50IGN1c3RvbWVyIHJlY29yZCBoYXMgZWl0aGVyIHBob25lIG51bWJlciBvciBlbWFpbCwgcHJvY2VlZCB0byBjaGVjayBpdCBmb3IgZHVwZXMsIG90aGVyd2lzZSBtb3ZlIG9uIHdpdGggdGhlIGN1cnJlbnQgYWNjdW11bGF0b3IuCiAgICAgICAgaWYoY3VycmVudC5waG9uZSB8fCBjdXJyZW50LmVtYWlsKSB7CiAgICAgICAgICAvLyBGaW5kIHdoZXRoZXIgYW55IGN1c3RvbWVycyBpbiB0aGUgbGlzdCB1cCB0byB0aGlzIHBvaW50IGhhdmUgZWl0aGVyIHRoZSBzYW1lIGVtYWlsLCBvciBpdCdzIGJsYW5rLCBvciB0aGUgc2FtZSBmb3IgcGhvbmUgbnVtYmVyLgogICAgICAgICAgbGV0IGZvdW5kID0gYWNjLmZpbmQoY3VzdG9tZXIgPT4geyByZXR1cm4gKGN1c3RvbWVyLmVtYWlsID09IGN1cnJlbnQuZW1haWwgJiYgY3VycmVudC5lbWFpbCAhPSAnJykgfHwgKGN1c3RvbWVyLnBob25lID09IGN1cnJlbnQucGhvbmUgJiYgY3VycmVudC5waG9uZSAhPSAnJykgfSkKICAgICAgICAgIC8vIElmIHRoZXJlIGlzbid0IGFueXRoaW5nIGZvdW5kIGZvciBlaXRoZXIgZW1haWwgb3IgcGhvbmUgYnVtYmVyLCBhZGQgaXQgdG8gdGhlIGxpc3QsIHVubGVzcyBwaG9uZSBleGlzdHMgYW5kIGlzbid0IDEwIGRpZ2l0cy4KICAgICAgICAgIGlmKCFmb3VuZCAmJiAoIGN1cnJlbnQucGhvbmUgPT0gJycgfHwgY3VycmVudC5waG9uZS5sZW5ndGggPT0gMTAgKSkgewogICAgICAgICAgICByZXR1cm4gYWNjLmNvbmNhdChbY3VycmVudF0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGFjYwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gYWNjOwogICAgICAgIH0KICAgICAgfSwgW10pCiAgICAgIHJldHVybiBmaWx0ZXJlZEFycjsKICAgIH0sCiAgICBtYXBIZWFkZXJzKCkgewogICAgICB0aGlzLmN1c3RvbWVySGVhZGVyLmZpcnN0TmFtZSA9IHRoaXMuaGVhZGVyc1swXS50cmltKCk7CiAgICAgIHRoaXMuY3VzdG9tZXJIZWFkZXIubGFzdE5hbWUgPSB0aGlzLmhlYWRlcnNbMV0udHJpbSgpOwogICAgICB0aGlzLmN1c3RvbWVySGVhZGVyLnBob25lID0gdGhpcy5oZWFkZXJzWzJdLnRyaW0oKTsKICAgICAgdGhpcy5jdXN0b21lckhlYWRlci5lbWFpbCA9IHRoaXMuaGVhZGVyc1szXS50cmltKCk7CiAgICAgIHRoaXMuY3VzdG9tZXJIZWFkZXIubm90ZXMgPSB0aGlzLmhlYWRlcnNbNF0udHJpbSgpOwogICAgICBpZiAoIXRoaXMudXBkYXRlZE9uY2UpIHsKICAgICAgICB0aGlzLmhlYWRlcnMucHVzaCgiTGVhdmUgQmxhbmsiKTsKICAgICAgfQogICAgfSwKICAgIG1hcERhdGEoKSB7CiAgICAgIHRoaXMuY3N2RGF0YS5tYXAoKGUsIGkpID0+IHsKICAgICAgICBlLm1hcCgoaCwgaikgPT4gewogICAgICAgICAgaCA9IGgudHJpbSgpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRMb2NhdGlvbk9wdGlvbnMoKSB7CiAgICAgIGlmICghdGhpcy5jdXN0b21lci5sb2NhdGlvbikgewogICAgICAgIFVzZXJTZXJ2aWNlLmdldEFsbFVzZXJMb2NhdGlvbnMoKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgIHJlc3BvbnNlLm1hcCgoZSwgaSkgPT4gewogICAgICAgICAgICB0aGlzLmxvY2F0aW9uT3B0aW9ucy5wdXNoKHsgdmFsdWU6IGUubG9jYXRpb25JZCwgbGFiZWw6IGUubmFtZSB9KTsKICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRMb2NhdGlvbikgewogICAgICAgICAgICB0aGlzLmxvY2F0aW9uT3B0aW9ucy5tYXAoKGUsIGkpID0+IHsKICAgICAgICAgICAgICBpZiAoZS52YWx1ZSA9PSB0aGlzLnNlbGVjdGVkTG9jYXRpb24pIHsKICAgICAgICAgICAgICAgIHRoaXMuY3VzdG9tZXIubG9jYXRpb25JZCA9IGU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIG9uSGVhZGVyQ2hhbmdlKGluZGV4TmFtZSwgdmFsdWUpIHsKICAgICAgdGhpc1tpbmRleE5hbWVdID0gdGhpcy5oZWFkZXJzLmluZGV4T2YodGhpcy5jdXN0b21lckhlYWRlclt2YWx1ZV0pOwogICAgfSwKICAgIGFkZEN1c3RvbWVycygpIHsKICAgICAgbGV0IHZtID0gdGhpczsKICAgICAgaWYgKHZtLnJlYWR5ID09IHRydWUpIHsKICAgICAgICBsZXQgYWRkaW5nQ3VzdG9tZXJzTGlzdCA9IHZtLmNzdkRhdGEubWFwKChlLCBpKSA9PiB7CiAgICAgICAgICBsZXQgY3VzdCA9IHt9OwogICAgICAgICAgaWYgKCBlW3ZtLmluZGV4M10gfHwgZVt2bS5pbmRleDRdKSB7CiAgICAgICAgICAgIGVbdm0uaW5kZXgxXSA/IGN1c3QuZmlyc3ROYW1lID0gZVt2bS5pbmRleDFdLnRyaW0oKSA6IGN1c3QuZmlyc3ROYW1lID0gZVt2bS5pbmRleDFdOwogICAgICAgICAgICBlW3ZtLmluZGV4Ml0gPyBjdXN0Lmxhc3ROYW1lID0gZVt2bS5pbmRleDJdLnRyaW0oKSA6IGN1c3QubGFzdE5hbWUgPSBlW3ZtLmluZGV4Ml07CiAgICAgICAgICAgIGVbdm0uaW5kZXgzXSA/IGVbdm0uaW5kZXgzXS5jaGFyQXQoMCkgPT0gMSA/IGN1c3QucGhvbmUgPSBlW3ZtLmluZGV4M10uc3Vic3RyKDEpLnJlcGxhY2UoL1xEL2csICIiKSA6IGN1c3QucGhvbmUgPSBlW3ZtLmluZGV4M10ucmVwbGFjZSgvXEQvZywgIiIpIDogY3VzdC5waG9uZSA9IGVbdm0uaW5kZXgzXTsKICAgICAgICAgICAgZVt2bS5pbmRleDRdID8gY3VzdC5lbWFpbCA9IGVbdm0uaW5kZXg0XS5yZXBsYWNlKC9ccy9nLCAiIikudG9Mb3dlckNhc2UoKSA6IGN1c3QuZW1haWwgPSBlW3ZtLmluZGV4NF07CiAgICAgICAgICAgIGVbdm0uaW5kZXg1XSA/IGN1c3Qubm90ZXMgPSBlW3ZtLmluZGV4NV0udHJpbSA6IGN1c3Qubm90ZXMgPSAnJzsKICAgICAgICAgICAgY3VzdC5jb3VudHJ5ID0gdGhpcy5jdXN0b21lci5jb3VudHJ5OwogICAgICAgICAgICByZXR1cm4gY3VzdAogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ0ludmFsaWQgQ3VzdG9tZXIgUmVjb3JkIC0gbXVzdCBpbmNsdWRlIGVpdGhlciBlbWFpbCBvciBwaG9uZSBudW1iZXInKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICAvLyBSZW1vdmVzICJ1bmRlZmluZWQiIGN1c3RvbWVycyBwcmlvciB0byBzY3J1YmJpbmcgYWdhaW5zdCB0aGUgY3N2IGl0c2VsZi4KICAgICAgICB2bS5jdXN0b21lcnNMaXN0ID0gdm0uY3VzdG9tZXJzTGlzdC5maWx0ZXIoZSA9PiBlKTsKICAgICAgICB2bS5jdXN0b21lcnNMaXN0ID0gdGhpcy5yZW1vdmVEdXBsaWNhdGVzKHZtLmN1c3RvbWVyc0xpc3QsICJlbWFpbCIpOwogICAgICAgIHZtLmN1c3RvbWVyc0xpc3QgPSB0aGlzLnJlbW92ZUR1cGxpY2F0ZXModm0uY3VzdG9tZXJzTGlzdCwgInBob25lIik7CiAgICAgICAgdm0uY3VzdG9tZXJzTGlzdC5tYXAoKGUsIGkpID0+IHsKICAgICAgICAgIGlmIChlLnBob25lLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgaWYgKGUucGhvbmUubGVuZ3RoICE9PSAxMCkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJJbnZhbGlkIFJlY29yZCBvciBEdXBsaWNhdGUiLCBlKTsKICAgICAgICAgICAgICB2bS5pbnZhbGlkUmVjb3JkcysrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgCiAgICAgICAgLy8gQmVsb3cgbm93IHRha2VzIGNhcmUgb2YgZHVwbGljYXRlcyBieSBwaG9uZSBvciBlbWFpbCBpbiBhIHNpbmdsZSBzdGVwLCBhcyB3ZWxsIGFzIGxlbmd0aCBvZiBwaG9uZSBudW1iZXIgb3Igd2hldGhlciB0aGV5IGhhdmUgYW4gZW1haWwgaW5zdGVhZC4KICAgICAgICBhZGRpbmdDdXN0b21lcnNMaXN0ID0gdGhpcy5yZW1vdmVEdXBsaWNhdGVzKGFkZGluZ0N1c3RvbWVyc0xpc3QpOwogICAgICAgIAogICAgICAgIC8vIGNvbnNvbGUubG9nKGFkZGluZ0N1c3RvbWVyc0xpc3QpOwogICAgICAgIAogICAgICAgIEV2ZW50U2VydmljZS4kZW1pdCgibG9hZGluZyIsICJzaG93Iik7CiAgICAgICAgdGhpcy5zYXZlQ3VzdG9tZXIoCiAgICAgICAgICB2bS5jdXN0b21lci5sb2NhdGlvbklkLnZhbHVlLAogICAgICAgICAgdm0uY3VzdG9tZXIudGVtcGxhdGUsCiAgICAgICAgICB2bS5jdXN0b21lci5zdGF0dXMsCiAgICAgICAgICBhZGRpbmdDdXN0b21lcnNMaXN0CiAgICAgICAgKTsKICAgICAgfQogICAgfSwKICAgIHNhdmVDdXN0b21lcihpZCwgdGVtcGxhdGUsIHN0YXR1cywgZGF0YSkgewogICAgICBFdmVudFNlcnZpY2UuJGVtaXQoImxvYWRpbmciLCAic2hvdyIpOwogICAgICBsZXQgdm0gPSB0aGlzOwogICAgICBsZXQgcmVjb3JkID0gewogICAgICAgIHJlY29yZE5hbWU6IHZtLmZpbGVOYW1lLAogICAgICAgIGZpbGVTaXplOiBkYXRhLmxlbmd0aCB8fCAnVW5rbm93bicsCiAgICAgICAgbG9jYXRpb25JZDogaWQsCiAgICAgICAgc3RhdHVzOiAnVXBsb2FkZWQnCiAgICAgIH0KICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIGlmIChkYXRhLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgcmVzb2x2ZSgnZG9uZSEnKTsKICAgICAgICAgIEV2ZW50U2VydmljZS4kZW1pdCgibG9hZGluZyIsICJoaWRlIik7CiAgICAgICAgICBVcGxvYWRTZXJ2aWNlLnNhdmVVcGxvYWRSZWNvcmQoaWQsIHJlY29yZCk7CiAgICAgICAgICB2bS5jbG9zZU1vZGFsKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBuZXdDdXN0b21lcnMgPSBkYXRhLnNwbGljZSgwLCAxMDApOwogICAgICAgICAgQ3VzdG9tZXJTZXJ2aWNlLnNhdmVNYW55Q3VzdG9tZXJzKGlkLCB0ZW1wbGF0ZSwgc3RhdHVzLCBuZXdDdXN0b21lcnMpLnRoZW4oZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJlc29sdmUodm0uc2F2ZUN1c3RvbWVyKGlkLCB0ZW1wbGF0ZSwgc3RhdHVzLCBkYXRhKSk7CiAgICAgICAgICB9LCBmdW5jdGlvbihlcnJvcikgewogICAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgICAgICBFdmVudFNlcnZpY2UuJGVtaXQoJ2Vycm9yTWVzc2FnZScsICJTb3JyeSwgc29tZXRoaW5nIHdlbnQgd3JvbmcuIFBsZWFzZSB0cnkgYWdhaW4uIikKICAgICAgICAgICAgdm0uY2xvc2VNb2RhbCgpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGNsb3NlTW9kYWwoKSB7CiAgICAgIHRoaXMuJGVtaXQoImNsb3NlTW9kYWwiKTsKICAgICAgdGhpcy5jc3YgPSBbXTsKICAgICAgdGhpcy5jc3ZEYXRhID0gW107CiAgICAgIHRoaXMuY3VzdG9tZXIgPSB7fTsKICAgICAgdGhpcy5sb2NhdGlvbk9wdGlvbnMgPSBbXTsKICAgICAgdGhpcy5jdXN0b21lcnNMaXN0ID0gW107CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["CSVPreview.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0GA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CSVPreview.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <transition name=\"modal\">\n    <div class='modal-mask' @click=\"closeModal()\">\n      <div class=\"modal-container\" @click.stop>\n        <div class=\"modal-header\">\n          <h3>Upload Preview <span> {{fileName}} </span></h3>\n        </div>\n        <div>\n          <label>Select Location: </label>\n          <div class=\"select-locations\">\n            <el-select v-model=\"customer.locationId\">\n              <el-option v-for='(option, optIndex) in locationOptions' :key=\"optIndex\" :value=\"option\" :label=\"option\">\n              </el-option>\n            </el-select>\n            <!-- <v-select :options=\"locationOptions\" v-model=\"customer.locationId\" maxHeight=\"120px\">\n              <span slot=\"no-options\">Sorry, no locations were found with that filter.</span>\n            </v-select> -->\n          </div>\n          <br/>\n          <label>Message Template: </label>\n          <select v-model=\"customer.template\" >\n            <option v-for=\"(template, tindex) in templateOptions\" :key=\"tindex\">{{template}}</option>\n            <option v-if=\"customer.location\" :value=\"customer.location\">{{customer.location}}</option>\n          </select>\n          <br />\n          <label>Customer Status: </label>\n          <select v-model=\"customer.status\" >\n            <option value=\"active\">Active</option>\n            <option value=\"inactive\">Inactive</option>\n          </select>\n          <br/>\n          <label>Customer Country: </label>\n          <select v-model=\"customer.country\">\n            <option value=\"+1\">USA</option>\n            <option value=\"+1\">Canada</option>\n            <option value=\"+63\">Phillipines</option>\n            <option value=\"+971\">UAE (Dubai)</option>\n            <option value=\"+61\">Australia</option>\n          </select>\n        </div>\n        <div class=\"modal-footer text-right\">\n          <button class=\"modal-default-button\" @click=\"addCustomers()\" :disabled=\"!ready && customer.locationId\">\n            Accept\n          </button>\n          <button class=\"modal-default-button\" @click=\"closeModal()\">\n            Close\n          </button>\n        </div>\n        <div class=\"customer-table\">\n          <div class=\"customer-header-row\">\n            <div class=\"customer-table-cell-0\">\n              <span>First Name</span>\n            </div>\n            <div class=\"customer-table-cell-1\">\n              <span>Last Name</span>\n            </div>\n            <div class=\"customer-table-cell-2\">\n              <span>Phone Number</span>\n            </div>\n            <div class=\"customer-table-cell-2\">\n              <span>Email</span>\n            </div>\n            <div class=\"customer-table-cell-3\">\n              <span>Notes</span>\n            </div>\n          </div>\n          <div class=\"customer-row\">\n            <div class=\"customer-table-cell-0\">\n              <select v-model=\"customerHeader.firstName\" @change=\"onHeaderChange('index1', 'firstName')\">\n                <option v-for=\"(header, hindex0) in headers\" :key=\"hindex0\">{{header}}</option>\n              </select>\n            </div>\n            <div class=\"customer-table-cell-1\">\n              <select v-model=\"customerHeader.lastName\" @change=\"onHeaderChange('index2', 'lastName')\">\n                <option v-for=\"(header, hindex1) in headers\" :key=\"hindex1\">{{header}}</option>\n              </select>\n            </div>\n            <div class=\"customer-table-cell-2\">\n              <select v-model=\"customerHeader.phone\" @change=\"onHeaderChange('index3', 'phone')\">\n                <option v-for=\"(header, hindex2) in headers\" :key=\"hindex2\">{{header}}</option>\n              </select>\n            </div>\n            <div class=\"customer-table-cell-5\">\n              <select v-model=\"customerHeader.email\" @change=\"onHeaderChange('index4', 'email')\">\n                <option v-for=\"(header, hindex3) in headers\" :key=\"hindex3\">{{header}}</option>\n              </select>\n            </div>\n            <div class=\"customer-table-cell-3\">\n              <select v-model=\"customerHeader.notes\" @change=\"onHeaderChange('index5', 'notes')\">\n                <option v-for=\"(header, hindex4) in headers\" :key=\"hindex4\">{{header}}</option>\n              </select>\n            </div>\n          </div>\n          <div class=\"customer-row quick-transition\" v-for=\"(customer, csvindex) in csvData\" :key=\"csvindex\" >\n            <input class=\"customer-table-cell-0 inputs\" v-model=\"customer[index1]\" :disabled=\"customerHeader.firstName == 'Leave Blank'\" />\n            <input class=\"customer-table-cell-1 inputs\" v-model=\"customer[index2]\" :disabled=\"customerHeader.lastName == 'Leave Blank'\" />\n            <input class=\"customer-table-cell-2 inputs\" v-model=\"customer[index3]\" :disabled=\"customerHeader.phone == 'Leave Blank'\" />\n            <input class=\"customer-table-cell-5 inputs\" v-model=\"customer[index4]\" :disabled=\"customerHeader.email == 'Leave Blank'\" />\n            <input class=\"customer-table-cell-3 inputs\" v-model=\"customer[index5]\" :disabled=\"customerHeader.notes == 'Leave Blank'\" />\n          </div>\n        </div>\n        </div>\n        </div>\n    </transition>\n</template>\n<script>\nimport CustomerService from \"./../services/CustomerService\";\nimport UserService from \"./../services/UserService\";\nimport { EventService } from \"../main\";\nimport vSelect from \"../../node_modules/vue-select/src/components/Select.vue\";\nimport UploadService from '../services/UploadService';\n\nexport default {\n  name: \"csvPreview\",\n  props: [\"rawData\", \"fileName\"],\n  components: {\n    vSelect\n  },\n  data: function() {\n    return {\n      csv: [],\n      customer: {\n        country: \"+1\",\n        template: \"default\",\n        status: \"active\"\n      },\n      locationOptions: [],\n      customersList: [],\n      ready: false,\n      csvData: [],\n      templateOptions: [\"default\", \"Q1\", \"Q2\", \"Q3\", \"Q4\"],\n      invalidRecords: 0,\n      headers: [],\n      customerHeader: [\"firstName\", \"lastName\", \"phone\", \"email\", \"notes\"],\n      index1: 0,\n      index2: 1,\n      index3: 2,\n      index4: 3,\n      index5: 4,\n      updatedOnce: false\n    };\n  },\n  created() {\n    this.selectedLocation = localStorage.getItem(\"locationId\");\n    this.getLocationOptions();\n  },\n\n  computed: {\n    isReady() {\n      if (this.rawData.length > 0) {\n        this.csvData = this.rawData;\n      }\n      if (this.csvData && this.csvData.length == this.rawData.length) {\n        if (this.headers.length < 1) {\n          this.headers = this.csvData.shift();\n        }\n        if (this.headers) {\n          this.mapHeaders();\n          this.mapData();\n          this.updatedOnce = true;\n        }\n        this.ready = true;\n        return true;\n      } else {\n        return false;\n      }\n    }\n  },\n  watch: {\n    isReady(n) {\n      if (n == true) {\n        // console.log(n);\n        null;\n      }\n    }\n  },\n  methods: {\n    removeDuplicates(list) {\n      let vm = this;\n      // Removes \"undefined\" customers prior to scrubbing against the csv itself.\n      let initialScrubList = list.filter(e => e);\n      // Reduce to a new array\n      let filteredArr = initialScrubList.reduce((acc, current) => {\n        // As long as the current customer record has either phone number or email, proceed to check it for dupes, otherwise move on with the current accumulator.\n        if(current.phone || current.email) {\n          // Find whether any customers in the list up to this point have either the same email, or it's blank, or the same for phone number.\n          let found = acc.find(customer => { return (customer.email == current.email && current.email != '') || (customer.phone == current.phone && current.phone != '') })\n          // If there isn't anything found for either email or phone bumber, add it to the list, unless phone exists and isn't 10 digits.\n          if(!found && ( current.phone == '' || current.phone.length == 10 )) {\n            return acc.concat([current]);\n          } else {\n            return acc\n          }\n        } else {\n          return acc;\n        }\n      }, [])\n      return filteredArr;\n    },\n    mapHeaders() {\n      this.customerHeader.firstName = this.headers[0].trim();\n      this.customerHeader.lastName = this.headers[1].trim();\n      this.customerHeader.phone = this.headers[2].trim();\n      this.customerHeader.email = this.headers[3].trim();\n      this.customerHeader.notes = this.headers[4].trim();\n      if (!this.updatedOnce) {\n        this.headers.push(\"Leave Blank\");\n      }\n    },\n    mapData() {\n      this.csvData.map((e, i) => {\n        e.map((h, j) => {\n          h = h.trim();\n        });\n      });\n    },\n    getLocationOptions() {\n      if (!this.customer.location) {\n        UserService.getAllUserLocations().then(response => {\n          response.map((e, i) => {\n            this.locationOptions.push({ value: e.locationId, label: e.name });\n          });\n          if (this.selectedLocation) {\n            this.locationOptions.map((e, i) => {\n              if (e.value == this.selectedLocation) {\n                this.customer.locationId = e;\n              }\n            });\n          }\n        });\n      }\n    },\n    onHeaderChange(indexName, value) {\n      this[indexName] = this.headers.indexOf(this.customerHeader[value]);\n    },\n    addCustomers() {\n      let vm = this;\n      if (vm.ready == true) {\n        let addingCustomersList = vm.csvData.map((e, i) => {\n          let cust = {};\n          if ( e[vm.index3] || e[vm.index4]) {\n            e[vm.index1] ? cust.firstName = e[vm.index1].trim() : cust.firstName = e[vm.index1];\n            e[vm.index2] ? cust.lastName = e[vm.index2].trim() : cust.lastName = e[vm.index2];\n            e[vm.index3] ? e[vm.index3].charAt(0) == 1 ? cust.phone = e[vm.index3].substr(1).replace(/\\D/g, \"\") : cust.phone = e[vm.index3].replace(/\\D/g, \"\") : cust.phone = e[vm.index3];\n            e[vm.index4] ? cust.email = e[vm.index4].replace(/\\s/g, \"\").toLowerCase() : cust.email = e[vm.index4];\n            e[vm.index5] ? cust.notes = e[vm.index5].trim : cust.notes = '';\n            cust.country = this.customer.country;\n            return cust\n          } else {\n            console.log('Invalid Customer Record - must include either email or phone number');\n          }\n        });\n        // Removes \"undefined\" customers prior to scrubbing against the csv itself.\n        vm.customersList = vm.customersList.filter(e => e);\n        vm.customersList = this.removeDuplicates(vm.customersList, \"email\");\n        vm.customersList = this.removeDuplicates(vm.customersList, \"phone\");\n        vm.customersList.map((e, i) => {\n          if (e.phone.length > 0) {\n            if (e.phone.length !== 10) {\n              console.log(\"Invalid Record or Duplicate\", e);\n              vm.invalidRecords++;\n            }\n          }\n        });\n        \n        // Below now takes care of duplicates by phone or email in a single step, as well as length of phone number or whether they have an email instead.\n        addingCustomersList = this.removeDuplicates(addingCustomersList);\n        \n        // console.log(addingCustomersList);\n        \n        EventService.$emit(\"loading\", \"show\");\n        this.saveCustomer(\n          vm.customer.locationId.value,\n          vm.customer.template,\n          vm.customer.status,\n          addingCustomersList\n        );\n      }\n    },\n    saveCustomer(id, template, status, data) {\n      EventService.$emit(\"loading\", \"show\");\n      let vm = this;\n      let record = {\n        recordName: vm.fileName,\n        fileSize: data.length || 'Unknown',\n        locationId: id,\n        status: 'Uploaded'\n      }\n      return new Promise(function(resolve, reject) {\n        if (data.length === 0) {\n          resolve('done!');\n          EventService.$emit(\"loading\", \"hide\");\n          UploadService.saveUploadRecord(id, record);\n          vm.closeModal();\n        } else {\n          var newCustomers = data.splice(0, 100);\n          CustomerService.saveManyCustomers(id, template, status, newCustomers).then(function() {\n            resolve(vm.saveCustomer(id, template, status, data));\n          }, function(error) {\n            reject(error);\n            EventService.$emit('errorMessage', \"Sorry, something went wrong. Please try again.\")\n            vm.closeModal();\n          });\n        }\n      })\n    },\n    closeModal() {\n      this.$emit(\"closeModal\");\n      this.csv = [];\n      this.csvData = [];\n      this.customer = {};\n      this.locationOptions = [];\n      this.customersList = [];\n    }\n  }\n};\n</script>\n\n<style scoped>\n.modal-container {\n  position: relative;\n  min-width: 510px;\n  max-width: 1000px;\n  margin: 40px auto 0;\n  padding: 20px 30px;\n  background-color: #fff;\n  border-radius: 2px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.33);\n  transition: all 0.3s ease;\n  position: sticky;\n  top: 40px;\n}\n.customer-table {\n  background: white;\n  font-size: 14px;\n  padding: 10px;\n  clear: both;\n}\n\ndiv.customer-table div.superadmin-row {\n  background: #ffff00;\n}\n\nselect {\n  margin-top: 10px;\n}\noption {\n  margin-left: 10px;\n}\n\n.select-locations {\n  width: 60%;\n}\n\n.customer-header-row {\n  width: calc(100% - 20px);\n  font-weight: bold;\n  padding: 10px;\n  border-top: 1px solid #efefef;\n  border-bottom: 1px solid #efefef;\n  height: 14px;\n  display: flex;\n  flex-wrap: nowrap;\n  justify-content: space-evenly;\n  cursor: pointer;\n}\n\n.customer-header-row div,\n.customer-row div {\n  margin: auto;\n}\n\n.customer-row {\n  width: calc(100% - 20px);\n  clear: both;\n  padding: 10px;\n  border-bottom: 1px solid #efefef;\n  height: auto;\n  display: flex;\n  flex-wrap: nowrap;\n  justify-content: space-evenly;\n}\n\n.customer-row:nth-child(even) {\n  /* background: #efefef; */\n}\n\n.customer-row input {\n  flex: 0 0 100px;\n  background: transparent;\n}\n\n.customer-row:hover {\n  background: #dfdfdf;\n}\n\n.customer-table-cell-details {\n  flex: 0 0 150px;\n}\n\n.customer-table-cell-0 {\n  flex: 0 0 180px;\n  /* cursor: pointer; */\n}\n\n.customer-table-cell-1 {\n  flex: 0 0 160px;\n  text-transform: capitalize;\n}\n\n.customer-table-cell-2 {\n  flex: 1 1 180px;\n  /* cursor: pointer; */\n}\n.customer-table-cell-5 {\n  flex: 1 1 150px;\n  /* cursor: pointer; */\n}\n\n.customer-table-cell-3 {\n  flex: 2 2 150px;\n}\n\n.customer-table-cell-4 {\n  flex: 0 0 100px;\n  text-align: center;\n}\n\n.customer-table-cell-4 span {\n  margin-right: 5px;\n  cursor: pointer;\n}\n\n.modal-header h3 span {\n  font-size: 14px;\n  float: right;\n  margin-right: 50px;\n}\n\n.modal-footer {\n  clear: both;\n  text-align: right;\n  margin-top: 20px;\n}\n\n.modal-default-button {\n  cursor: pointer;\n}\n\n.inputs {\n  width: 125px;\n}\n\noption {\n  text-transform: capitalize;\n}\n\n</style>\n"]}]}