{"remainingRequest":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/src/components/DashboardComponents/OpiniionAggregate.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/src/components/DashboardComponents/OpiniionAggregate.vue","mtime":1581270622000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCiNvcGluaWlvbi1hZ2dyZWdhdGUtcmF0aW5nIHsKICBmb250LXNpemU6IDUxcHg7CiAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgYm9yZGVyOiAxcHggc29saWQgIzU0NTQ1NDsKICBwYWRkaW5nOiA5cHg7Cn0KCiNvcGluaWlvbi1hZ2dyZWdhdGUtcmF0aW5nLXRpdGxlIHsKICBwYWRkaW5nLXRvcDogN3B4OwogIGZvbnQtc2l6ZTogMTRweDsKICBmb250LXdlaWdodDogNjAwOwogIHRleHQtYWxpZ246IGNlbnRlcjsKfQoKI29waW5paW9uLWFnZ3JlZ2F0ZS13cmFwcGVyIHsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIGp1c3RpZnktY29udGVudDogc3BhY2UtZXZlbmx5OwogIHBhZGRpbmc6IDA7Cn0KCiNvcGluaWlvbi1hZ2dyZWdhdGUtcmF0aW5nLXdyYXBwZXIgewogIGRpc3BsYXk6IGZsZXg7CiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKfQoKI29waW5paW9uLWFnZ3JlZ2F0ZS1yYXRpbmcgewogIGZvbnQtc2l6ZTogNTFweDsKICBmb250LXdlaWdodDogYm9sZDsKICBib3JkZXI6IDFweCBzb2xpZCAjNTQ1NDU0OwogIHBhZGRpbmc6IDlweDsKfQoKI29waW5paW9uLWFnZ3JlZ2F0ZS1yYXRpbmctdGl0bGUgewogIHBhZGRpbmctdG9wOiA3cHg7CiAgZm9udC1zaXplOiAxNHB4OwogIGZvbnQtd2VpZ2h0OiA2MDA7CiAgdGV4dC1hbGlnbjogY2VudGVyOwp9CgoKQG1lZGlhIChtaW4td2lkdGg6IDEyMDBweCkgewogICNvcGluaWlvbi1hZ2dyZWdhdGUtd3JhcHBlciB7CiAgICBtYXJnaW46IGF1dG8gMDsKICB9CgogICNvcGluaWlvbi1hZ2dyZWdhdGUtY2hhcnRqcy10b29sdGlwIHsKICAgIHRvcDogMTE1cHg7CiAgfQp9CgpAbWVkaWEgKG1pbi13aWR0aDogMTcwMHB4KSB7CiAgI29waW5paW9uLWFnZ3JlZ2F0ZS13cmFwcGVyIHsKICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7CiAgICBtYXJnaW46IGF1dG87CiAgfQoKICAjb3Bpbmlpb24tYWdncmVnYXRlLWNoYXJ0anMtdG9vbHRpcCB7CiAgICB0b3A6IDE1MnB4OwogIH0KfQo="},{"version":3,"sources":["OpiniionAggregate.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8OA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"OpiniionAggregate.vue","sourceRoot":"src/components/DashboardComponents","sourcesContent":["<template>\n  <div class=\"dashboard-tile\">\n    <div class=\"dashboard-tile-header cursor-default\" style=\"font-weight: bolder;\">Opiniion Aggregate Score</div>\n    <div class=\"dashboard-tile-body\">\n      <div class=\"dashboard-row dashboard-loader\" v-if=\"showLoading\"><i class=\"far fa-hourglass fa-spin\"></i></div>\n      <div id=\"opiniion-aggregate-wrapper\" class=\"dashboard-tile-body\" v-show=\"!showLoading && chartData\">\n        <bar-chart height=\"125\" width=\"200\" :chart-data=\"chartData\" :options=\"chartOptions\"/>\n        <div id=\"opiniion-aggregate-rating-wrapper\">\n          <div id=\"opiniion-aggregate-rating\"></div>\n          <div id=\"opiniion-aggregate-rating-title\">Opiniion Rating</div>\n        </div>\n      </div>\n      <div class=\"no-data\" v-show=\"!showLoading && !chartData\" style=\"position: relative; display: flex; align-items: center; justify-content: space-evenly;\">\n        No reviews generated.\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport BarChart from './../Charts/BarChart'\nimport DashboardService from './../../services/DashboardService'\nimport UserService from './../../services/UserService'\nimport {EventService} from '../../main'\n\nexport default {\n  name: 'opiniionAggregate',\n  components: {BarChart},\n  data: function() {\n    return {\n      userRole: null,\n      showLoading: true,\n      chartData: null,\n      chartOptions: {\n        maintainAspectRatio: false,\n        legend: {\n          display: false\n        },\n        hover: {\n          mode: 'index',\n          intersect: false,\n          onHover: function(e, el) {\n            // Grab the chart element.\n            var point = this.getElementAtEvent(e);\n\n            // Set the cursor style to pointer when hovering.\n            if (point.length) e.target.style.cursor = 'pointer';\n            else e.target.style.cursor = 'default';\n          }\n        },\n        scales: {\n          xAxes: [{\n            gridLines: {\n              drawBorder: false,\n              display: false\n            }\n          }],\n          yAxes: [{\n            minBarLength: 1,\n            ticks: {\n              beginAtZero: true,\n              display: false\n            },\n            gridLines: {\n              drawBorder: false,\n              display: false\n            }\n          }]\n        },\n        tooltips: {\n          // Disable the on-canvas tooltip\n          enabled: false,\n          mode: 'index',\n          intersect:  false,\n\n          custom: function(tooltipModel) {\n              // Tooltip Element\n              var tooltipEl = document.getElementById('opiniion-aggregate-chartjs-tooltip');\n\n              // Create element on first render\n              if (!tooltipEl) {\n                  tooltipEl = document.createElement('div');\n                  tooltipEl.id = 'opiniion-aggregate-chartjs-tooltip';\n                  tooltipEl.innerHTML = '<table></table>';\n                  document.body.appendChild(tooltipEl);\n              }\n\n              // Hide if no tooltip\n              if (tooltipModel.opacity === 0) {\n                  tooltipEl.style.opacity = 0;\n                  return;\n              }\n\n              // Set caret Position\n              tooltipEl.classList.remove('above', 'below', 'no-transform');\n              if (tooltipModel.yAlign) {\n                  tooltipEl.classList.add(tooltipModel.yAlign);\n              } else {\n                  tooltipEl.classList.add('no-transform');\n              }\n\n              function getBody(bodyItem) {\n                  return bodyItem.lines;\n              }\n\n              // Set Text\n              if (tooltipModel.body) {\n                  var titleLines = tooltipModel.title || [];\n                  var bodyLines = tooltipModel.body.map(getBody);\n\n                  var innerHtml = '<tbody';\n                  var tooltipTitle = \"\", tooltipBody = \"\";\n\n                  titleLines.forEach(function(title) {\n                    tooltipTitle = title;\n                  });\n\n                  bodyLines.forEach(function(body, i) {\n                    tooltipBody = body[0];\n                  });\n\n                  tooltipBody = tooltipBody.replace(\"New Customers: \", \"\");\n\n                  innerHtml += '<tr><td>' + tooltipTitle + ' - ' + tooltipBody + '</td></tr>';\n                  innerHtml += '</tbody>';\n\n                  var tableRoot = tooltipEl.querySelector('table');\n                  tableRoot.innerHTML = innerHtml;\n                  tableRoot.style.border = '1px solid #d4d4d4';\n                  tableRoot.style.borderRadius = '5px';\n                  tableRoot.style.padding = '5px 15px';\n              }\n\n              // `this` will be the overall tooltip\n              var position = this._chart.canvas.getBoundingClientRect();\n\n              // Display, position, and set styles for font\n              tooltipEl.style.opacity = 1;\n              tooltipEl.style.position = 'absolute';\n              // tooltipEl.style.left = position.left + window.pageXOffset + tooltipModel.caretX + 'px';\n               tooltipEl.style.left = position.width / 2 + position.left - 35 + 'px';\n              // tooltipEl.style.top = position.top + window.pageYOffset + tooltipModel.caretY + 'px';\n              ////tooltipEl.style.top = 210 + 'px';\n              tooltipEl.style.fontFamily = tooltipModel._bodyFontFamily;\n              tooltipEl.style.fontSize = tooltipModel.bodyFontSize + 'px';\n              tooltipEl.style.fontStyle = tooltipModel._bodyFontStyle;\n              tooltipEl.style.padding = tooltipModel.yPadding + 'px ' + tooltipModel.xPadding + 'px';\n              tooltipEl.style.pointerEvents = 'none';\n          }\n        },\n        'onClick' : (evt, item) => {\n          var source = item[0]['_model'].label;\n          // Hide the tooltip after the user clicks the chart.\n          var tooltipEl = document.getElementById('opiniion-aggregate-chartjs-tooltip');\n          tooltipEl.style.opacity = 0;\n\n          this.followLink('/feedback/' + source);\n        },\n        legend: {\n          display: false\n        },\n        title: {\n          display: false\n        },\n        cubicInterpolationMode: 'monotone'\n      }\n    }\n  },\n  created() {\n    this.getAggregateData();\n    EventService.$on('locationChange', this.getAggregateData);\n  },\n  beforeDestroy: function () {\n    EventService.$off('locationChange', this.getAggregateData);\n\n    // Hide the tooltip if it is visible.\n    var tooltipEl = document.getElementById('opiniion-aggregate-chartjs-tooltip');\n    if(tooltipEl) tooltipEl.style.opacity = 0;\n  },\n  methods: {\n    followLink(targetPage) {\n      this.$router.push(targetPage);\n    },\n    getAggregateData() {\n      this.showLoading = true;\n      var vm = this;\n      // Get the users role.\n      UserService.getUserRole().then(\n        function(response) {\n          vm.userRole = response.role;\n          // Don't make the data call if they are an admin.\n          if (vm.userRole != 'admin') {\n            DashboardService.getOpiniionAggregate().then(\n              function(response) {\n                vm.showLoading = false;\n                vm.chartData = {\n                  labels: [1, 2, 3, 4, 5],\n                  datasets: [{\n                    label: '',\n                    backgroundColor: \"rgba(79, 203, 198, 0.75)\",\n                    hoverBackgroundColor: \"#4fcbc6\",\n                    data: response\n                  }]\n                };\n                vm.populateOpiniionAggregateRating(response);\n              }, function(error) {\n                console.log(error);\n            });\n          }\n      })\n    },\n    populateOpiniionAggregateRating(data) {\n      var ratingHolder = document.getElementById(\"opiniion-aggregate-rating\");\n      var totalNumOfRatings = data.reduce((a, b) => a + b, 0);\n      var totalNumOfStars = 0;\n      var rating = 0;\n\n      if(totalNumOfRatings > 0) {\n        for (var i = 0; i < data.length; i++) {\n          if(data[i] > 0) {\n            totalNumOfStars += data[i] * (i + 1);\n          }\n        }\n\n        rating = totalNumOfStars / totalNumOfRatings;\n      }\n\n      ratingHolder.innerHTML = this.round(rating, 1).toFixed(1);\n    },\n    round(value, precision) {\n      var multiplier = Math.pow(10, precision || 0);\n      return Math.round(value * multiplier) / multiplier;\n    }\n  }\n}\n</script>\n\n<style>\n#opiniion-aggregate-rating {\n  font-size: 51px;\n  font-weight: bold;\n  border: 1px solid #545454;\n  padding: 9px;\n}\n\n#opiniion-aggregate-rating-title {\n  padding-top: 7px;\n  font-size: 14px;\n  font-weight: 600;\n  text-align: center;\n}\n\n#opiniion-aggregate-wrapper {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: space-evenly;\n  padding: 0;\n}\n\n#opiniion-aggregate-rating-wrapper {\n  display: flex;\n  flex-direction: column;\n}\n\n#opiniion-aggregate-rating {\n  font-size: 51px;\n  font-weight: bold;\n  border: 1px solid #545454;\n  padding: 9px;\n}\n\n#opiniion-aggregate-rating-title {\n  padding-top: 7px;\n  font-size: 14px;\n  font-weight: 600;\n  text-align: center;\n}\n\n\n@media (min-width: 1200px) {\n  #opiniion-aggregate-wrapper {\n    margin: auto 0;\n  }\n\n  #opiniion-aggregate-chartjs-tooltip {\n    top: 115px;\n  }\n}\n\n@media (min-width: 1700px) {\n  #opiniion-aggregate-wrapper {\n    flex-direction: row;\n    margin: auto;\n  }\n\n  #opiniion-aggregate-chartjs-tooltip {\n    top: 152px;\n  }\n}\n</style>\n"]}]}