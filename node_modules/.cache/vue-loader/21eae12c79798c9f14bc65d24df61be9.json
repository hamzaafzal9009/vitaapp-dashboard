{"remainingRequest":"/Library/WebServer/Documents/Projects/OPINIION FINAL/opiniionv4/node_modules/vue-loader/lib/index.js??vue-loader-options!/Library/WebServer/Documents/Projects/OPINIION FINAL/opiniionv4/src/components/Customers.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Library/WebServer/Documents/Projects/OPINIION FINAL/opiniionv4/src/components/Customers.vue","mtime":1581270622000},{"path":"/Library/WebServer/Documents/Projects/OPINIION FINAL/opiniionv4/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/Projects/OPINIION FINAL/opiniionv4/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/Projects/OPINIION FINAL/opiniionv4/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/Projects/OPINIION FINAL/opiniionv4/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCiAgaW1wb3J0IFVzZXJTZXJ2aWNlIGZyb20gIi4uL3NlcnZpY2VzL1VzZXJTZXJ2aWNlIjsKICBpbXBvcnQgUmVxdWVzdFJldmlldyBmcm9tICIuL1JlcXVlc3RSZXZpZXciOwogIGltcG9ydCBDdXN0b21lclNlcnZpY2UgZnJvbSAiLi4vc2VydmljZXMvQ3VzdG9tZXJTZXJ2aWNlIjsKICBpbXBvcnQgTG9jYXRpb25TZXJ2aWNlIGZyb20gIi4uL3NlcnZpY2VzL0xvY2F0aW9uU2VydmljZSI7CiAgaW1wb3J0IHsgRXZlbnRTZXJ2aWNlIH0gZnJvbSAiLi4vbWFpbiI7CiAgaW1wb3J0IEFkZEN1c3RvbWVyIGZyb20gIi4vQWRkQ3VzdG9tZXIiOwogIGltcG9ydCBDdXN0b21lckRldGFpbCBmcm9tICIuL0N1c3RvbWVyRGV0YWlsIjsKICBpbXBvcnQgQ1NWUHJldmlldyBmcm9tICIuL0NTVlByZXZpZXciOwogIGltcG9ydCBDU1ZPbGQgZnJvbSAiLi9DU1ZPbGQiOwogIGltcG9ydCBQYXBhIGZyb20gIi4uLy4uL25vZGVfbW9kdWxlcy9wYXBhcGFyc2UvcGFwYXBhcnNlLmpzIjsKICBpbXBvcnQgVnVlIGZyb20gJ3Z1ZScKICBpbXBvcnQgaW1hZ2VGaWxlIGZyb20gJy4uL2Fzc2V0cy9pbWFnZUZpbGUuanMnOwogIC8vIFZ1ZS51c2UoU2VsZWN0KQogIC8vIFZ1ZS51c2UoT3B0aW9uKQoKICBleHBvcnQgZGVmYXVsdCB7CiAgICBjb21wb25lbnRzIDogewogICAgICBDdXN0b21lckRldGFpbCwKICAgICAgQWRkQ3VzdG9tZXIsCiAgICAgIENTVlByZXZpZXcsCiAgICAgIENTVk9sZCwKICAgICAgUmVxdWVzdFJldmlldwogICAgfSwKICBkYXRhOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiB7CiAgICAgIHNlbGVjdGVkOiAiYWxsIiwKICAgICAgY3VzdG9tZXJzOiBbXSwKICAgICAgZmlsdGVyczogewogICAgICAgIHJhdGluZ3M6IFtdLAogICAgICAgIHN0YXR1czogW10sCiAgICAgICAgdGFnczogW10KICAgICAgfSwKICAgICAgc29ydE9wdGlvbnM6IFsnYXNjZW5kaW5nJywgJ2Rlc2NlbmRpbmcnXSwKICAgICAgc3RhdHVzRmlsdGVyT3B0aW9uczogW3tsYWJlbDogJ1N1YnNjcmliZWQnLCB2YWx1ZTogJ2FjdGl2ZSd9LCB7bGFiZWw6ICdVbnN1YnNjcmliZWQnLCB2YWx1ZTogJ2luYWN0aXZlJ31dLAogICAgICByZXF1ZXN0TW9kYWw6IGZhbHNlLAogICAgICBzaG93RmlsdGVyczogZmFsc2UsCiAgICAgIHNob3dUYWdzTWVudTogZmFsc2UsCiAgICAgIG5ld1RhZzogJycsCiAgICAgIHRhZ3NUb0FkZDogW10sCiAgICAgIHNob3dDdXN0b21lckRldGFpbDogZmFsc2UsCiAgICAgIGRpc3BsYXlJbmZvOiB0cnVlLAogICAgICBkaXNwbGF5Tm90ZXM6IGZhbHNlLAogICAgICBkaXNwbGF5VGFnczogZmFsc2UsCiAgICAgIGRpc3BsYXlBZG1pbjogZmFsc2UsCiAgICAgIGRpc3BsYXlDb250YWN0OiB0cnVlLAogICAgICBhZGRpbmdOb3RlOiBmYWxzZSwKICAgICAgc2VhcmNoVGV4dDogIiIsCiAgICAgIG5ld05vdGU6ICIiLAogICAgICBuZXdUYWc6ICIiLAogICAgICBzZWxlY3RlZFR5cGU6IGZhbHNlLAogICAgICBzZWxlY3RlZFZpZXc6ICJjaGF0IiwKICAgICAgb3BlbkN1c3RvbWVyTW9kYWw6IGZhbHNlLAogICAgICBvcGVuQ3VzdG9tZXJEZXRhaWxNb2RhbDogZmFsc2UsCiAgICAgIGRpc3BsYXlOb3RlTW9kYWw6IGZhbHNlLAogICAgICBzZWxlY3RlZEN1c3RvbWVyOiBudWxsLAogICAgICBzZWxlY3RlZEN1c3RvbWVyTm90ZXM6IFtdLAogICAgICBzaG93Q3VzdG9tZXJDaGF0OiBmYWxzZSwKICAgICAgcHJldmlld0NTVjogZmFsc2UsCiAgICAgIHJlcXVlc3RBZ2FpbjogZmFsc2UsCiAgICAgIHNvcnRUeXBlOiAibmFtZSIsCiAgICAgIGRlbGV0ZUxpc3Q6IFtdLAogICAgICBkaXNwbGF5QnV0dG9uczogZmFsc2UsCiAgICAgIHJhd0RhdGE6IFtdLAogICAgICBsb2NhdGlvblNlbGVjdGVkOiAiIiwKICAgICAgbG9jYXRpb25zOiBbXSwKICAgICAgaXNTdXBlckFkbWluOiBmYWxzZSwKICAgICAgc3RhdHVzRmlsdGVyOiAiIiwKICAgICAgcmF0aW5nRmlsdGVyOiAiIiwKICAgICAgbG9jYXRpb25GaWx0ZXI6ICIiLAogICAgICB0b3RhbFJlc3VsdHM6IDAsCiAgICAgIHRvdGFsVW5yZWFkOiAwLAogICAgICBzZWxlY3RlZFBhZ2U6IDAsCiAgICAgIG1vcmVDdXN0b21lcnNUb0xvYWQ6IGZhbHNlLAogICAgICBzY3JvbGxPYnNlcnZlcjogbnVsbCwKICAgICAgZmlsZU5hbWU6ICIiLAogICAgICBhbGxTOiBmYWxzZSwKICAgICAgc2VsZWN0ZWRMb2NhdGlvblFzOiAiIiwKICAgICAgdXNlclJvbGU6ICIiLAogICAgICBsb2NhdGlvbk5hbWU6ICIiLAogICAgICByYXdEYXRhOiAiIiwKICAgICAgbm90ZTogIiIsCiAgICAgIHBhZ2luYXRpb25EYXRhOiB7CiAgICAgICAgcGVyUGFnZTogMjUsCiAgICAgICAgY3VycmVudFBhZ2U6IDAsCiAgICAgICAgcGVyUGFnZU9wdGlvbnM6IFs1LCAxMCwgMjVdLAogICAgICAgIHRvdGFsOiAwLCAgICAgIAogICAgICB9LAogICAgICBjdXN0b21lclRhZ3M6IFtdCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHNvcnRlZEN1c3RvbWVyVGFncygpIHsKICAgICAgbGV0IHZtID0gdGhpczsKICAgICAgcmV0dXJuIHZtLmN1c3RvbWVyVGFncy5zb3J0KCk7CiAgICB9LAogICAgZmlsdGVyc0FjdGl2ZSgpIHsKICAgICAgbGV0IHZtID0gdGhpczsKICAgICAgaWYodm0uZmlsdGVycy5yYXRpbmdzLmxlbmd0aCB8fCB2bS5maWx0ZXJzLnN0YXR1cy5sZW5ndGggfHwgdm0uZmlsdGVycy50YWdzLmxlbmd0aCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIGdldEFjdGl2ZVN0YXR1czogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzdGF0dXMgPSB0aGlzLmN1c3RvbWVycy5zdGF0dXM7CiAgICAgIGlmIChzdGF0dXMgPT0gImFjdGl2ZSIpIHsKICAgICAgICByZXR1cm4gInN1YnNjcmliZWQiOwogICAgICB9IGVsc2UgaWYgKHN0YXR1cyA9PSAiaW5hY3RpdmUiKSB7CiAgICAgICAgcmV0dXJuICJ1bnN1YnNjcmliZWQiOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAiZGVsZXRlZCI7CiAgICAgIH0KICAgIH0sCiAgICBwYWdpbmF0aW9uUGFnZSgpIHsKICAgICAgcmV0dXJuICh0aGlzLnBhZ2luYXRpb25EYXRhLmN1cnJlbnRQYWdlKzEpOwogICAgfSwKICAgIHNob3dCdWxrQWN0aW9ucygpIHsKICAgICAgbGV0IHZtID0gdGhpczsKICAgICAgaWYodm0uZGVsZXRlTGlzdCAmJiB2bS5kZWxldGVMaXN0Lmxlbmd0aCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLmN1c3RvbWVySWQpIHsKICAgICAgbGV0IHJvdXRlQ3VzdG9tZXJJZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5jdXN0b21lcklkOwogICAgICBDdXN0b21lclNlcnZpY2UuZ2V0Q3VzdG9tZXIocm91dGVDdXN0b21lcklkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy5zZWxlY3RDdXN0b21lcihyZXMpOwogICAgICB9KTsKICAgIH0KICAgIGlmICh0aGlzLiRyb3V0ZS5xdWVyeS5saXN0KSB7CiAgICAgIHRoaXMuY2hhbmdlU2VsZWN0ZWQoInVucmVwbGllZCIpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5jaGVja0ZvckFkbWluKCk7CiAgICB9CgogICAgVXNlclNlcnZpY2UubG9nUGFnZVZpc2l0KCJjdXN0b21lckxpc3QiKTsKICAgIHRoaXMubG9jYXRpb25TZWxlY3RlZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJsb2NhdGlvbklkIik7CiAgICB0aGlzLmdldExvY2F0aW9uUXMoKTsKICAgIHRoaXMuZ2V0TG9jYXRpb25DdXN0b21lclRhZ3MoKTsKICAgIHRoaXMuZ2V0VXNlcigpOwogICAgdGhpcy5zZWFyY2hDdXN0b21lcnMoMCk7CiAgICBFdmVudFNlcnZpY2UuJG9uKCJsb2NhdGlvbkNoYW5nZSIsIHRoaXMubG9jYXRpb25DaGFuZ2UpOwogICAgRXZlbnRTZXJ2aWNlLiRvbigicmVsb2FkQ3VzdG9tZXJDaGF0TGlzdCIsIHRoaXMucmVsb2FkQ3VzdG9tZXJDaGF0TGlzdCk7CiAgICBFdmVudFNlcnZpY2UuJG9uKAogICAgICAic2V0QWN0aXZlQ3VzdG9tZXJBc1VucmVzb2x2ZWQiLAogICAgICB0aGlzLnNldEFjdGl2ZUN1c3RvbWVyQXNVbnJlc29sdmVkCiAgICApOwogIH0sCiAgYmVmb3JlRGVzdHJveTogZnVuY3Rpb24oKSB7CiAgICBpZiAodGhpcy5pbnRlcnZhbCkgewogICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpOwogICAgfQogICAgdGhpcy5zY3JvbGxPYnNlcnZlci5kaXNjb25uZWN0KCk7CiAgICBFdmVudFNlcnZpY2UuJG9mZigibG9jYXRpb25DaGFuZ2UiLCB0aGlzLmxvY2F0aW9uQ2hhbmdlKTsKICAgIEV2ZW50U2VydmljZS4kb2ZmKCJyZWxvYWRDdXN0b21lckNoYXRMaXN0IiwgdGhpcy5yZWxvYWRDdXN0b21lckNoYXRMaXN0KTsKICAgIEV2ZW50U2VydmljZS4kb2ZmKAogICAgICAic2V0QWN0aXZlQ3VzdG9tZXJBc1VucmVzb2x2ZWQiLAogICAgICB0aGlzLnNldEFjdGl2ZUN1c3RvbWVyQXNVbnJlc29sdmVkCiAgICApOwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0VXNlcigpIHsKICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgVXNlclNlcnZpY2UuZ2V0VXNlclJvbGUodm0ubG9jYXRpb25JZCkudGhlbigKICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgdm0udXNlclJvbGUgPSByZXNwb25zZS5yb2xlOwogICAgICAgIH0sCiAgICAgICAgZnVuY3Rpb24oZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgICB9CiAgICAgICk7CiAgICB9LAogICAgc2VsZWN0Q2hhdChjKSB7CiAgICAgIHRyeSB7CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImN1c3RvbWVyIiwgSlNPTi5zdHJpbmdpZnkoYykpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgfQogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IHBhdGg6ICIvY3VzdG9tZXJEZXRhaWxzIiB9KTsKICAgIH0sCiAgICBleHBvcnRDdXN0b21lcigpIHsKICAgICAgRXZlbnRTZXJ2aWNlLiRlbWl0KCJsb2FkaW5nIiwgInNob3ciKTsKICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgQ3VzdG9tZXJTZXJ2aWNlLmdldEFsbEN1c3RvbWVycyh0aGlzLmxvY2F0aW9uU2VsZWN0ZWQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHZhciBleHBvcnRhYmxlQ3VzdG9tZXIgPSByZXNwb25zZTsKICAgICAgICBFdmVudFNlcnZpY2UuJGVtaXQoImxvYWRpbmciLCAiaGlkZSIpOwogICAgICAgIHZtLmRvd25sb2FkQ3VzdG9tZXIoZXhwb3J0YWJsZUN1c3RvbWVyKTsKICAgICAgfSk7CiAgICB9LAogICAgZGlzcGxheUN1c3RvbWVySW5mbyhjdXN0b21lcikgewogICAgICBpZiAoY3VzdG9tZXIuZmlyc3ROYW1lIHx8IGN1c3RvbWVyLmxhc3ROYW1lKSB7CiAgICAgICAgcmV0dXJuIGN1c3RvbWVyLmZpcnN0TmFtZSArICIgIiArIGN1c3RvbWVyLmxhc3ROYW1lOwogICAgICB9IGVsc2UgaWYgKGN1c3RvbWVyLnBob25lKSB7CiAgICAgICAgcmV0dXJuIGN1c3RvbWVyLnBob25lOwogICAgICB9IGVsc2UgaWYgKGN1c3RvbWVyLmVtYWlsKSB7CiAgICAgICAgcmV0dXJuIGN1c3RvbWVyLmVtYWlsOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAiVW5rbm93biBDdXN0b21lciI7CiAgICAgIH0KICAgIH0sCiAgICBkb3dubG9hZEN1c3RvbWVyKGRhdGEpIHsKICAgICAgbGV0IHZtID0gdGhpczsKICAgICAgTG9jYXRpb25TZXJ2aWNlLmdldExvY2F0aW9uKHZtLmxvY2F0aW9uU2VsZWN0ZWQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHZtLmxvY2F0aW9uTmFtZSA9IHJlc3BvbnNlLm5hbWU7CiAgICAgICAgRXZlbnRTZXJ2aWNlLiRlbWl0KCJsb2FkaW5nIiwgInNob3ciKTsKICAgICAgICB2YXIgY3N2RG93bmxvYWQgPSBQYXBhLnVucGFyc2UoZGF0YS5yZXN1bHRzKTsKICAgICAgICB2YXIgTUlNRV9UWVBFID0gInRleHQvY3N2IjsKICAgICAgICB2YXIgYmxvYiA9IG5ldyBCbG9iKFtjc3ZEb3dubG9hZF0sIHsgdHlwZTogTUlNRV9UWVBFIH0pOwogICAgICAgIHZhciBjc3ZVUkwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgICB2YXIgdGVtcExpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgICAgdGVtcExpbmsuaHJlZiA9IGNzdlVSTDsKICAgICAgICB0ZW1wTGluay5zZXRBdHRyaWJ1dGUoCiAgICAgICAgICAiZG93bmxvYWQiLAogICAgICAgICAgYCR7dm0ubG9jYXRpb25OYW1lfSBDdXN0b21lciBSZXBvcnQuY3N2YAogICAgICAgICk7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0ZW1wTGluayk7CiAgICAgICAgdGVtcExpbmsuY2xpY2soKTsKICAgICAgICBFdmVudFNlcnZpY2UuJGVtaXQoImxvYWRpbmciLCAiaGlkZSIpOwogICAgICAgIGNzdkRvd25sb2FkID0ge307CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGVtcExpbmspOwogICAgICAgIH0gY2F0Y2ggKGUpIHt9CiAgICAgIH0pOwogICAgfSwKICAgIGNoZWNrRm9yQWRtaW4oKSB7CiAgICAgIHZhciB2bSA9IHRoaXM7CiAgICAgIFVzZXJTZXJ2aWNlLmdldEN1cnJlbnRVc2VyKCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdm0uaXNTdXBlckFkbWluID0gcmVzcG9uc2UuaXNTdXBlckFkbWluOwogICAgICAgIHZtLnVzZXJJZCA9IHJlc3BvbnNlLnVzZXJJZDsKICAgICAgICBpZiAoIXZtLmlzU3VwZXJBZG1pbikgdm0uY2hhbmdlU2VsZWN0ZWQoImFsbCIpOwogICAgICB9KTsKICAgIH0sCiAgICBkaXNwbGF5RGF0ZShtaWxsaXMpIHsKICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShtaWxsaXMpOwogICAgICByZXR1cm4gKAogICAgICAgIDEgKwogICAgICAgIGRhdGUuZ2V0TW9udGgoKSArCiAgICAgICAgIi8iICsKICAgICAgICBkYXRlLmdldERhdGUoKSArCiAgICAgICAgIi8iICsKICAgICAgICAoZGF0ZS5nZXRGdWxsWWVhcigpICUgMTAwKQogICAgICApOwogICAgfSwKICAgIHNlbGVjdEFsbCgpIHsKICAgICAgdGhpcy5jdXN0b21lcnMubWFwKChlLCBpKSA9PiB7CiAgICAgICAgdGhpcy5wcmVwRm9yRGVsZXRlKGUpOwogICAgICB9KTsKICAgIH0sCiAgICBsb2NhdGlvbkNoYW5nZSgpIHsKICAgICAgdGhpcy5sb2NhdGlvblNlbGVjdGVkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oImxvY2F0aW9uSWQiKTsKICAgICAgdGhpcy5kZWxldGVMaXN0ID0gW107CiAgICAgIHRoaXMuc2VhcmNoQ3VzdG9tZXJzKCk7CiAgICB9LAogICAgZ2V0TG9jYXRpb25RcygpIHsKICAgICAgbGV0IHZtID0gdGhpczsKICAgICAgaWYgKHZtLmxvY2F0aW9uU2VsZWN0ZWQpIHsKICAgICAgICBMb2NhdGlvblNlcnZpY2UuZ2V0TG9jYXRpb24odm0ubG9jYXRpb25TZWxlY3RlZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICB2bS5zZWxlY3RlZExvY2F0aW9uUXMgPSByZXNwb25zZS5xc0VuYWJsZWQ7CiAgICAgICAgICB2bS50ZW1wbGF0ZU9wdGlvbnMgPSByZXNwb25zZS5xdWVzdGlvblRlbXBsYXRlOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgZ2V0TG9jYXRpb25DdXN0b21lclRhZ3MoKSB7CiAgICAgIGxldCB2bSA9IHRoaXM7CiAgICAgIGxldCBzZWFyY2hPYmplY3QgPSB7fTsKICAgICAgbGV0IGxvY2F0aW9uSWRBcnJheSA9IFtdOwogICAgICBsZXQgbG9jYXRpb25JZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdsb2NhdGlvbklkJyk7CiAgICAgIGlmKGxvY2F0aW9uSWQpIHsKICAgICAgICBsb2NhdGlvbklkQXJyYXkucHVzaChsb2NhdGlvbklkKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBsZXQgbG9jT3B0aW9ucyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2xvY2F0aW9uT3B0aW9ucycpKTsKICAgICAgICBsb2NPcHRpb25zLm1hcChlbCA9PiBsb2NhdGlvbklkQXJyYXkucHVzaChlbC5sb2NhdGlvbklkKSk7CiAgICAgIH0KICAgICAgc2VhcmNoT2JqZWN0LmxvY2F0aW9ucyA9IGxvY2F0aW9uSWRBcnJheTsKICAgICAgTG9jYXRpb25TZXJ2aWNlLmdldEF2YWlsYWJsZUN1c3RvbWVyVGFncyhzZWFyY2hPYmplY3QpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHZtLmN1c3RvbWVyVGFncyA9IHJlc3BvbnNlLnRhZ3M7CiAgICAgIH0pCiAgICB9LAogICAgbWFzc1Jlc29sdmVDdXN0b21lckludGVyYWN0KCkgewogICAgICBpZiAod2luZG93LmNvbmZpcm0oIkFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBNYXJrIHRoZXNlIGFzIFJlc29sdmVkPyIpKSB7CiAgICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgICBsZXQgbmV3SW50ZXJhY3Rpb24gPSAicmVzb2x2ZSI7CiAgICAgICAgdGhpcy5kZWxldGVMaXN0Lm1hcCgoZSwgaSkgPT4gewogICAgICAgICAgQ3VzdG9tZXJTZXJ2aWNlLmFkZEN1c3RvbWVyRW5nYWdlbWVudExvZygKICAgICAgICAgICAgZS5jdXN0b21lcklkLAogICAgICAgICAgICAiSW50ZXJhY3Rpb24gbWFya2VkIGFzIGNsb3NlZCIKICAgICAgICAgICkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgdm0uc2VhcmNoQ3VzdG9tZXJzKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgaGFuZGxlU29ydChkYXRhKSB7CiAgICAgIGxldCB2bSA9IHRoaXM7CiAgICAgIGxldCBkaXJlY3Rpb24gPSAnLSc7CiAgICAgIGlmKHZtLnNvcnRUeXBlWzBdID09ICctJykgewogICAgICAgIGRpcmVjdGlvbiA9ICcnCiAgICAgIH0KICAgICAgdm0uc29ydFR5cGUgPSBkaXJlY3Rpb24gKyBkYXRhLnByb3A7ICAgICAgCiAgICAgIHZtLnNlYXJjaEN1c3RvbWVycygpOwogICAgfSwKICAgIHNlYXJjaEN1c3RvbWVycyhwYWdlTnVtKSB7CiAgICAgIEV2ZW50U2VydmljZS4kZW1pdCgibG9hZGluZyIsICJzaG93Iik7CiAgICAgIHRoaXMubW9yZUN1c3RvbWVyc1RvTG9hZCA9IGZhbHNlOwogICAgICB0aGlzLmN1c3RvbWVycyA9IFtdOwogICAgICB0aGlzLnRvdGFsUmVzdWx0cyA9IDA7CiAgICAgIHRoaXMudG90YWxVbnJlYWQgPSAwOwogICAgICB0aGlzLmRlbGV0ZUxpc3QgPSBbXTsKICAgICAgdGhpcy5hbGxTID0gZmFsc2U7CiAgICAgIHZhciB2bSA9IHRoaXM7CiAgICAgIHZtLnNob3dGaWx0ZXJzID0gZmFsc2U7CiAgICAgIHZhciBzZWFyY2hPYmplY3QgPSB7fTsKICAgICAgaWYgKHRoaXMuc2VhcmNoVGV4dCkgc2VhcmNoT2JqZWN0LnNlYXJjaFRleHQgPSB0aGlzLnNlYXJjaFRleHQudHJpbSgpOwogICAgICBzZWFyY2hPYmplY3QucmVzUGVyUGFnZSA9IHRoaXMucGFnaW5hdGlvbkRhdGEucGVyUGFnZTsKICAgICAgaWYgKHRoaXMuc29ydFR5cGUpIHsKICAgICAgICBpZiAodGhpcy5zb3J0VHlwZSA9PSAibmFtZSIpIHsKICAgICAgICAgIHNlYXJjaE9iamVjdC5zb3J0ID0gImZpcnN0TmFtZSI7CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNvcnRUeXBlID09ICItbmFtZSIpIHsKICAgICAgICAgIHNlYXJjaE9iamVjdC5zb3J0ID0gIi1maXJzdE5hbWUiOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5zb3J0VHlwZSA9PSAiZGF0ZSIpIHsKICAgICAgICAgIHNlYXJjaE9iamVjdC5zb3J0ID0gImNyZWF0ZWREYXRlIjsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc29ydFR5cGUgPT0gIi1kYXRlIikgewogICAgICAgICAgc2VhcmNoT2JqZWN0LnNvcnQgPSAiLWNyZWF0ZWREYXRlIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2VhcmNoT2JqZWN0LnNvcnQgPSB0aGlzLnNvcnRUeXBlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMubG9jYXRpb25TZWxlY3RlZCkgewogICAgICAgIHNlYXJjaE9iamVjdC5sb2NhdGlvbklkID0gdGhpcy5sb2NhdGlvblNlbGVjdGVkOwogICAgICB9CgogICAgICBpZiAocGFnZU51bSkgewogICAgICAgIHNlYXJjaE9iamVjdC5wYWdlTnVtID0gcGFnZU51bTsKICAgICAgICB2bS5wYWdpbmF0aW9uRGF0YS5jdXJyZW50UGFnZSA9IHBhZ2VOdW0gLSAxOwogICAgICB9IGVsc2UgewogICAgICAgIHNlYXJjaE9iamVjdC5wYWdlTnVtID0gMDsKICAgICAgICB0aGlzLnBhZ2luYXRpb25EYXRhLmN1cnJlbnRQYWdlID0gMDsKICAgICAgfQoKICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgc2VhcmNoT2JqZWN0LmZpbHRlcnMgPSB2bS5maWx0ZXJzOwogICAgICAvLyBpZih2bS5zZWxlY3RlZFZpZXcgPT0gJ2xpc3QnKSB7CiAgICAgIEN1c3RvbWVyU2VydmljZS5zZWFyY2hDdXN0b21lcnNBZHZhbmNlZChzZWFyY2hPYmplY3QpLnRoZW4oCiAgICAgICAgZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgIGlmKHJlc3BvbnNlWzBdLnJlc3VsdHMpIHZtLmN1c3RvbWVycyA9IHJlc3BvbnNlWzBdLnJlc3VsdHM7CiAgICAgICAgICBpZihyZXNwb25zZVswXS5jb3VudCAmJiByZXNwb25zZVswXS5jb3VudFswXSAmJiByZXNwb25zZVswXS5jb3VudFswXS50b3RhbCkgdm0ucGFnaW5hdGlvbkRhdGEudG90YWwgPSByZXNwb25zZVswXS5jb3VudFswXS50b3RhbDsKICAgICAgICAgIAogICAgICAgICAgRXZlbnRTZXJ2aWNlLiRlbWl0KCJsb2FkaW5nIiwgImhpZGUiKTsKICAgICAgICB9LAogICAgICAgIGZ1bmN0aW9uKGVycm9yKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgICBFdmVudFNlcnZpY2UuJGVtaXQoImxvYWRpbmciLCAiaGlkZSIpOwogICAgICAgIH0KICAgICAgKTsKICAgIH0sCiAgICByZWxvYWRDdXN0b21lckNoYXRMaXN0KCkgewogICAgICB0aGlzLnRvdGFsUmVzdWx0cyA9IDA7CiAgICAgIHRoaXMuc2VhcmNoQ3VzdG9tZXJzKDApOwogICAgfSwKICAgIHNldFBhZ2VOdW0ocGFnZU51bSkgewogICAgICB0aGlzLnNlbGVjdGVkUGFnZSA9IHBhZ2VOdW07CiAgICAgIHRoaXMuc2VhcmNoQ3VzdG9tZXJzKHBhZ2VOdW0pOwogICAgfSwKICAgIHRvZ2dsZVNvcnQoc2V0U29ydFR5cGUpIHsKICAgICAgaWYgKHRoaXMuc29ydFR5cGUgIT0gc2V0U29ydFR5cGUpIHsKICAgICAgICB0aGlzLnNvcnRUeXBlID0gc2V0U29ydFR5cGU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zb3J0VHlwZSA9ICItIiArIHRoaXMuc29ydFR5cGU7CiAgICAgIH0KICAgICAgdGhpcy5zZWFyY2hDdXN0b21lcnModGhpcy5zZWxlY3RlZFBhZ2UpOwogICAgfSwKICAgIGVkaXRDdXN0b21lcihjdXN0b21lcikgewogICAgICBpZiAoY3VzdG9tZXIpIHsKICAgICAgICB0aGlzLnNlbGVjdGVkQ3VzdG9tZXIgPSBjdXN0b21lcjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNlbGVjdGVkQ3VzdG9tZXIgPSBudWxsOwogICAgICB9CiAgICAgIHRoaXMub3BlbkN1c3RvbWVyTW9kYWwgPSB0cnVlOwogICAgfSwKICAgIG1hc3NBZGRDdXN0b21lcihldmVudCkgewogICAgICBFdmVudFNlcnZpY2UuJGVtaXQoImxvYWRpbmciLCAic2hvdyIpOwogICAgICBpZiAoZXZlbnQudGFyZ2V0LmZpbGVzWzBdKSB7CiAgICAgICAgCiAgICAgICAgbGV0IGZpbGVzTGlzdCA9IGV2ZW50LnRhcmdldC5maWxlc1swXTsKICAgICAgICB0aGlzLmZpbGVOYW1lID0gZXZlbnQudGFyZ2V0LmZpbGVzWzBdLm5hbWU7CiAgICAgICAgbGV0IHZtID0gdGhpczsKICAgICAgICBQYXBhLnBhcnNlKGZpbGVzTGlzdCwgewogICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uKHJlc3VsdCkgewogICAgICAgICAgICBFdmVudFNlcnZpY2UuJGVtaXQoImxvYWRpbmciLCAiaGlkZSIpOwogICAgICAgICAgICB2bS5yYXdEYXRhID0gcmVzdWx0LmRhdGE7CiAgICAgICAgICAgIHZtLnByZXZpZXdNb2RhbCgpOwogICAgICAgICAgfSwKICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihlcnJvcikgewogICAgICAgICAgICBFdmVudFNlcnZpY2UuJGVtaXQoImxvYWRpbmciLCAiaGlkZSIpOwogICAgICAgICAgICBFdmVudFNlcnZpY2UuJGVtaXQoCiAgICAgICAgICAgICAgImVycm9yTWVzc2FnZSIsCiAgICAgICAgICAgICAgIlNvcnJ5LCBzb21ldGhpbmcgd2VudCB3cm9uZy4gUGxlYXNlIHRyeSBhZ2Fpbi4iCiAgICAgICAgICAgICk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBzZWxlY3RDdXN0b21lcihjdXN0b21lcikgewogICAgICB0aGlzLnNlbGVjdGVkVmlldyA9ICdjaGF0JzsKICAgICAgdGhpcy5zZWxlY3RlZEN1c3RvbWVyID0gY3VzdG9tZXI7CiAgICAgIHRoaXMuc2hvd0N1c3RvbWVyRGV0YWlsID0gdHJ1ZTsKICAgICAgdGhpcy5zZWFyY2hDdXN0b21lcnMoKTsKICAgICAgLy8gdGhpcy5zZWFyY2hUZXh0ID0gY3VzdG9tZXIuZmlyc3ROYW1lICsgJyAnICsgY3VzdG9tZXIubGFzdE5hbWU7CiAgICB9LAogICAgZGVsZXRlQ3VzdG9tZXIoY3VzdG9tZXIpIHsKICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgaWYgKHdpbmRvdy5jb25maXJtKCJBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgY3VzdG9tZXI/IikpIHsKICAgICAgICBDdXN0b21lclNlcnZpY2UuZGVsZXRlQ3VzdG9tZXIoY3VzdG9tZXIuY3VzdG9tZXJJZCkudGhlbigKICAgICAgICAgIGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICAgIHZtLmNsb3NlQ3VzdG9tZXJDaGF0KCk7CiAgICAgICAgICAgIHZtLnNlYXJjaFRleHQgPSAiIjsKICAgICAgICAgICAgdm0uc2VhcmNoQ3VzdG9tZXJzKCk7CiAgICAgICAgICB9LAogICAgICAgICAgZnVuY3Rpb24oZXJyb3IpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgICAgfQogICAgICAgICk7CiAgICAgIH0KICAgIH0sCiAgICBjbG9zZUN1c3RvbWVyRGV0YWlscygpIHsKICAgICAgbGV0IHZtID0gdGhpczsKICAgICAgdm0uc2VsZWN0ZWRDdXN0b21lciA9ICcnOwogICAgICB2bS5zaG93Q3VzdG9tZXJEZXRhaWwgPSBmYWxzZQogICAgICB2bS5zZWFyY2hDdXN0b21lcnMoKTsKICAgIH0sCiAgICBoYW5kbGVTZWxlY3Rpb25DaGFuZ2UoY3VzdG9tZXJzKSB7ICAgICAgCiAgICAgIHRoaXMuZGVsZXRlTGlzdCA9IGN1c3RvbWVyczsKICAgIH0sCiAgICBkaXNwbGF5T3B0aW9ucygpIHsKICAgICAgdGhpcy5kaXNwbGF5QnV0dG9ucyA9ICF0aGlzLmRpc3BsYXlCdXR0b25zOwogICAgfSwKICAgIHByZXBGb3JEZWxldGUoY3VzdG9tZXIpIHsKICAgICAgdGhpcy5sb2NhdGlvblNlbGVjdGVkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oImxvY2F0aW9uSWQiKTsKICAgICAgaWYgKCF0aGlzLmRlbGV0ZUxpc3QuaW5jbHVkZXMoY3VzdG9tZXIpKSB7CiAgICAgICAgdGhpcy5kZWxldGVMaXN0LnB1c2goY3VzdG9tZXIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZGVsZXRlTGlzdCA9IHRoaXMuZGVsZXRlTGlzdC5maWx0ZXIoZGF0YSA9PiB7CiAgICAgICAgICByZXR1cm4gZGF0YSAhPT0gY3VzdG9tZXI7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBtYXNzQ2hhbmdlU3RhdHVzKHN0YXR1cykgewogICAgICBsZXQgbWVzc2FnZSA9ICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gY2hhbmdlIHRoZXNlIHN0YXR1c2VzPycKICAgICAgaWYoc3RhdHVzID09ICdkZWxldGVkJykgewogICAgICAgIG1lc3NhZ2UgPSAnQXJlIHlvdSBjZXJ0YWluIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGVzZSBjdXN0b21lcnM/JwogICAgICB9CiAgICAgIHRoaXMuJGNvbmZpcm0oIG1lc3NhZ2UsICdDb25maXJtYXRpb24nLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICdZZXMnLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICdDYW5jZWwnLAogICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgICBsZXQgbmV3Q3VzdG9tZXJTdGF0dXMgPSAiIjsKICAgICAgICB0aGlzLmRlbGV0ZUxpc3QubWFwKChlLCBpKSA9PiB7CiAgICAgICAgICBuZXdDdXN0b21lclN0YXR1cyA9IHN0YXR1czsKICAgICAgICAgIEN1c3RvbWVyU2VydmljZS5zZXRDdXN0b21lclN0YXR1cygKICAgICAgICAgICAgZS5jdXN0b21lcklkLAogICAgICAgICAgICBuZXdDdXN0b21lclN0YXR1cwogICAgICAgICAgKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgaWYocmVzcG9uc2UpIHsKICAgICAgICAgICAgICBFdmVudFNlcnZpY2UuJGVtaXQoJ3N1Y2Nlc3NNZXNzYWdlJywgJ1N0YXR1cyBjaGFuZ2VkIHN1Y2Nlc3NmdWxseSEnKQogICAgICAgICAgICAgIHZtLnNlYXJjaEN1c3RvbWVycygpOyAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgRXZlbnRTZXJ2aWNlLiRlbWl0KCdlcnJvck1lc3NhZ2UnLCAnU29tZXRoaW5nIHdlbnQgd3JvbmcsIHBsZWFzZSB0cnkgYWdhaW4uJykKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5kaXNwbGF5QnV0dG9ucyA9IGZhbHNlOwogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiAnaW5mbycsCiAgICAgICAgICBtZXNzYWdlOiAiRGVsZXRlIENhbmNlbGxlZCIKICAgICAgICB9KQogICAgICB9KQogICAgfSwKICAgIG9wZW5UYWdzTWVudSgpIHsKICAgICAgdGhpcy5zaG93VGFnc01lbnUgPSB0cnVlOwogICAgfSwKICAgIGNsb3NlVGFnc01lbnUoKSB7CiAgICAgIHRoaXMuc2hvd1RhZ3NNZW51ID0gZmFsc2U7CiAgICAgIHRoaXMuc2hvd0ZpbHRlcnMgPSBmYWxzZTsKICAgIH0sCiAgICBhZGRUYWdUb0xpc3QoKSB7CiAgICAgIGxldCB2bSA9IHRoaXM7CiAgICAgIGxldCBuZXdUYWcgPSB2bS5uZXdUYWcudHJpbSgpOwogICAgICBpZihuZXdUYWcpIHsKICAgICAgICB2bS50YWdzVG9BZGQucHVzaChuZXdUYWcpOwogICAgICAgIHZtLm5ld1RhZyA9ICcnOwogICAgICAgIG5ld1RhZyA9ICcnOwogICAgICB9IGVsc2UgewogICAgICAgIEV2ZW50U2VydmljZS4kZW1pdCgnd2FybmluZ01lc3NhZ2UnLCAnVGFncyBjYW5ub3QgYmUgYmxhbmshJykgICAgICAgIAogICAgICB9CiAgICB9LAogICAgcmVtb3ZlVGFnRnJvbUxpc3QoaW5kZXgpIHsKICAgICAgbGV0IHZtID0gdGhpczsKICAgICAgdm0udGFnc1RvQWRkLnNwbGljZShpbmRleCwxKTsKICAgIH0sCiAgICBhZGRUYWdzKCkgewogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICB0aGlzLmRlbGV0ZUxpc3QubWFwKChlLCBpKSA9PiB7CiAgICAgICAgdGhpcy50YWdzVG9BZGQubWFwKGggPT4gewogICAgICAgICAgQ3VzdG9tZXJTZXJ2aWNlLmFkZFRhZ1RvQ3VzdG9tZXIoaCwgZS5jdXN0b21lcklkKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgdm0uc2VhcmNoQ3VzdG9tZXJzKCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KQogICAgICB9KTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY2FyZC10aXRsZScpWzBdLmNsaWNrKCk7CiAgICAgIHRoaXMuY2xvc2VUYWdzTWVudSgpOwogICAgfSwKICAgIGRpc2NhcmRUYWdzKCkgewogICAgICBsZXQgdm0gPSB0aGlzOwogICAgICB2bS50YWdzVG9BZGQgPSBbXTsKICAgICAgdm0uY2xvc2VUYWdzTWVudSgpOwogICAgfSwKICAgIG1hc3NSZXF1ZXN0UmV2aWV3KCkgewogICAgICB0aGlzLnJlcXVlc3RNb2RhbCA9IHRydWU7CiAgICB9LAogICAgbWFzc0RlbGV0ZSgpIHsKICAgICAgaWYgKHdpbmRvdy5jb25maXJtKCJBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoZXNlIGN1c3RvbWVycz8iKSkgewogICAgICAgIHZhciB2bSA9IHRoaXM7CiAgICAgICAgdGhpcy5kZWxldGVMaXN0Lm1hcCgoZSwgaSkgPT4gewogICAgICAgICAgQ3VzdG9tZXJTZXJ2aWNlLmRlbGV0ZUN1c3RvbWVyKGUuY3VzdG9tZXJJZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgIHZtLnNlYXJjaEN1c3RvbWVycygpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5kaXNwbGF5QnV0dG9ucyA9IGZhbHNlOwogICAgICB9CiAgICB9LAogICAgcGFyc2VEYXRlKGRhdGUpIHsKICAgICAgbGV0IG5ld0RhdGUgPSBuZXcgRGF0ZShkYXRlKTsKICAgICAgbGV0IGRhdGVTdHJpbmcgPSAobmV3RGF0ZS5nZXRNb250aCgpKzEpICsgbmV3RGF0ZS50b1N0cmluZygpLnN1YnN0cig3LDgpOwogICAgICBsZXQgZm9ybWF0dGVkRGF0ZVN0cmluZyA9IGRhdGVTdHJpbmcucmVwbGFjZSgvXHMvZywgJy8nKTsKICAgICAgcmV0dXJuIGZvcm1hdHRlZERhdGVTdHJpbmc7CiAgICB9LAogICAgc2V0Q3VzdG9tZXJTdGF0dXMoY3VzdG9tZXIsIHN0YXR1cykgewogICAgICBsZXQgdm0gPSB0aGlzOwogICAgICBDdXN0b21lclNlcnZpY2Uuc2V0Q3VzdG9tZXJTdGF0dXMoY3VzdG9tZXIuY3VzdG9tZXJJZCwgc3RhdHVzKS50aGVuKAogICAgICAgIHJlc3BvbnNlID0+IHsKICAgICAgICAgIHZtLnNlYXJjaEN1c3RvbWVycygpOwogICAgICAgIH0KICAgICAgKTsKICAgIH0sCiAgICBjbG9zZVJlUmVxdWVzdE1vZGFsKCkgewogICAgICB0aGlzLnJlcXVlc3RBZ2FpbiA9IGZhbHNlOwogICAgfSwKICAgIHJlUmVxdWVzdFJldmlldyhzaW5nbGUpIHsKICAgICAgaWYgKHNpbmdsZSkgewogICAgICAgIHRoaXMucmVxdWVzdEFnYWluID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoCiAgICAgICAgICB3aW5kb3cuY29uZmlybSgKICAgICAgICAgICAgIlBsZWFzZSBjb25maXJtIHlvdSB3b3VsZCBsaWtlIHRvIGFzayB0aGVzZSBjdXN0b21lcnMgZm9yIGEgcmV2aWV3IGFnYWluLiIKICAgICAgICAgICkKICAgICAgICApIHsKICAgICAgICAgIGxldCBsb2NhdGlvbklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oImxvY2F0aW9uSWQiKTsKICAgICAgICAgIGxldCB2bSA9IHRoaXM7CiAgICAgICAgICB2bS5yZXF1ZXN0QWdhaW4gPSB0cnVlOwogICAgICAgICAgLy8gQmVsb3cgaXMgb2xkIGNvZGUgZm9yIGF1dG9tYXRpYyByZS1yZXF1ZXN0aW5nIGlmIG5vIFFzIGFyZSBlbmFibGVkLgogICAgICAgICAgLy8gaWYodm0uc2VsZWN0ZWRMb2NhdGlvblFzICYmIHZtLnNlbGVjdGVkTG9jYXRpb25RcyA9PSB0cnVlKSB7CiAgICAgICAgICAvLyAgIHZtLnJlcXVlc3RBZ2FpbiA9IHRydWU7CiAgICAgICAgICAvLyB9CiAgICAgICAgICAvLyBlbHNlIHsKICAgICAgICAgIC8vICAgQ3VzdG9tZXJTZXJ2aWNlLnJlUmVxdWVzdChsb2NhdGlvbklkLCB2bS5kZWxldGVMaXN0KS50aGVuKCByZXNwb25zZSA9PiB7CiAgICAgICAgICAvLyAgIGlmIChyZXNwb25zZS5zdWNjZXNzID09IHRydWUpIHsKICAgICAgICAgIC8vICAgICBFdmVudFNlcnZpY2UuJGVtaXQoImxvYWRpbmciLCAiaGlkZSIpOwogICAgICAgICAgLy8gICAgIEV2ZW50U2VydmljZS4kZW1pdCgic3VjY2Vzc01lc3NhZ2UiLCAiSG9vcmF5ISBSZXZpZXdzIFJlcXVlc3RlZC4iKTsKICAgICAgICAgIC8vICAgfSBlbHNlIHsKICAgICAgICAgIC8vICAgICBFdmVudFNlcnZpY2UuJGVtaXQoImxvYWRpbmciLCAiaGlkZSIpOwogICAgICAgICAgLy8gICAgIEV2ZW50U2VydmljZS4kZW1pdCgKICAgICAgICAgIC8vICAgICAgICJlcnJvck1lc3NhZ2UiLAogICAgICAgICAgLy8gICAgICAgIlNvcnJ5LCBzb21ldGhpbmcgd2VudCB3cm9uZy4gUGxlYXNlIHRyeSBhZ2Fpbi4iCiAgICAgICAgICAvLyAgICAgKTsKICAgICAgICAgIC8vICAgfQogICAgICAgICAgLy8gICB9KQogICAgICAgICAgLy8gfQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGNhbkFjdGlvbkN1c3RvbWVyKGFjdGlvbiwgY3VzdG9tZXIpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9LAogICAgcHJldmlld01vZGFsKCkgewogICAgICB0aGlzLnByZXZpZXdDU1YgPSB0cnVlOwogICAgfSwKICAgIHJlc2V0RmlsdGVycygpIHsKICAgICAgdGhpcy5maWx0ZXJzID0gewogICAgICAgIHJhdGluZ3M6IFtdLAogICAgICAgIHN0YXR1czogW10sCiAgICAgICAgdGFnczogW10KICAgICAgfQogICAgfSwKICAgIGZvcm1hdEZ1bGxEYXRlKGRhdGUpIHsKICAgICAgbGV0IG1lc3NhZ2VEYXRlID0gbmV3IERhdGUoZGF0ZSkKICAgICAgICAudG9TdHJpbmcoKQogICAgICAgIC5zdWJzdHIoNCwgMjApCiAgICAgICAgLnRyaW0oKTsKICAgICAgcmV0dXJuIG1lc3NhZ2VEYXRlOwogICAgfSwKICAgIGZvcm1hdERhdGUoZGF0ZSkgewogICAgICBsZXQgbWVzc2FnZURhdGUgPSBuZXcgRGF0ZShkYXRlKS50b0xvY2FsZVRpbWVTdHJpbmcoKTsKICAgICAgbGV0IGxhc3RDb2xvblBvcyA9IG1lc3NhZ2VEYXRlLmxhc3RJbmRleE9mKCI6Iik7CiAgICAgIG1lc3NhZ2VEYXRlID0KICAgICAgICBtZXNzYWdlRGF0ZS5zdWJzdHJpbmcoMCwgbGFzdENvbG9uUG9zKSArCiAgICAgICAgbWVzc2FnZURhdGUuc3Vic3RyaW5nKGxhc3RDb2xvblBvcyArIDMpOwogICAgICBpZiAoRGF0ZS5ub3coKSAtIGRhdGUgPiAxMDAwICogNjAgKiA2MCAqIDI0KSB7CiAgICAgICAgbWVzc2FnZURhdGUgPSBuZXcgRGF0ZShkYXRlKQogICAgICAgICAgLnRvU3RyaW5nKCkKICAgICAgICAgIC5zdWJzdHIoNCwgNikKICAgICAgICAgIC50cmltKCk7CiAgICAgIH0KICAgICAgcmV0dXJuIG1lc3NhZ2VEYXRlOwogICAgfSwKICAgIGdldExhc3RNZXNzYWdlVGV4dChsb2dzKSB7CiAgICAgIGxldCBsYXN0TWVzc2FnZVRleHQgPSAiIjsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsb2dzLmxlbmd0aCAmJiBsYXN0TWVzc2FnZVRleHQgPT0gIiI7IGkrKykgewogICAgICAgIGlmIChsb2dzW2ldLnRleHQpIHsKICAgICAgICAgIGxhc3RNZXNzYWdlVGV4dCA9IGxvZ3NbaV0udGV4dDsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGxhc3RNZXNzYWdlVGV4dDsKICAgIH0sCiAgICBjaGFuZ2VTZWxlY3RlZCh0eXBlKSB7CiAgICAgIGxldCB2bSA9IHRoaXM7CiAgICAgIHZtLnNlbGVjdGVkVHlwZSA9ICF2bS5zZWxlY3RlZFR5cGU7CiAgICAgIHZtLnNlbGVjdGVkID0gdHlwZTsKICAgICAgdm0uc2VhcmNoQ3VzdG9tZXJzKCk7CiAgICB9LAogICAgdG9nZ2xlTm90ZSgpIHsKICAgICAgdGhpcy5hZGRpbmdOb3RlID0gIXRoaXMuYWRkaW5nTm90ZTsKICAgICAgdGhpcy5uZXdOb3RlID0gIiI7CiAgICAgIGlmICh0aGlzLmFkZGluZ05vdGUpIHsKICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB0aGlzLiRyZWZzLm5vdGVJbnB1dC5mb2N1cygpKTsKICAgICAgfQogICAgfSwKICAgIHNhdmVOb3RlKCkgewogICAgICBsZXQgdm0gPSB0aGlzOwogICAgICBpZiAodm0ubmV3Tm90ZSkgewogICAgICAgIGxldCBub3RlID0gdm0ubmV3Tm90ZTsKICAgICAgICB0aGlzLmRlbGV0ZUxpc3QubWFwKChlLCBpKSA9PiB7CiAgICAgICAgICBDdXN0b21lclNlcnZpY2UuYWRkQ3VzdG9tZXJOb3RlKGUuY3VzdG9tZXJJZCwgdm0ubmV3Tm90ZSkudGhlbigKICAgICAgICAgICAgcmVzID0+IHsKICAgICAgICAgICAgICBpZiAocmVzKSB7CiAgICAgICAgICAgICAgICB2bS5uZXdOb3RlID0gIiI7CiAgICAgICAgICAgICAgICB2bS5kaXNwbGF5Tm90ZXMgPSAhdm0uZGlzcGxheU5vdGVzOwogICAgICAgICAgICAgICAgdm0uc2VhcmNoQ3VzdG9tZXJzKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICApOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgc2F2ZVRhZygpIHsKICAgICAgbGV0IHZtID0gdGhpczsKICAgICAgaWYgKHZtLm5ld1RhZykgewogICAgICAgIGxldCB0YWcgPSB2bS5uZXdUYWc7CiAgICAgICAgdGhpcy5kZWxldGVMaXN0Lm1hcCgoZSwgaSkgPT4gewogICAgICAgICAgQ3VzdG9tZXJTZXJ2aWNlLmFkZFRhZ1RvQ3VzdG9tZXIodm0ubmV3VGFnLCBlLmN1c3RvbWVySWQpLnRoZW4oCiAgICAgICAgICAgIHJlcyA9PiB7CiAgICAgICAgICAgICAgaWYgKHJlcykgewogICAgICAgICAgICAgICAgdm0ubmV3VGFnID0gIiI7CiAgICAgICAgICAgICAgICB2bS5kaXNwbGF5VGFncyA9ICF2bS5kaXNwbGF5VGFnczsKICAgICAgICAgICAgICAgIHZtLnNlYXJjaEN1c3RvbWVycygpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGNsb3NlQ3VzdG9tZXJDaGF0KCkgewogICAgICB0aGlzLnNlbGVjdGVkQ3VzdG9tZXIgPSBudWxsOwogICAgICB0aGlzLnNob3dDdXN0b21lckNoYXQgPSBmYWxzZTsKICAgIH0sCiAgICBjYW5jZWxOb3RlKCkgewogICAgICB0aGlzLmRpc3BsYXlOb3RlTW9kYWwgPSBmYWxzZTsKICAgIH0sCiAgICBjbG9zZU5vdGVNb2RhbChuZXdOb3RlKSB7CiAgICAgIC8vIEFkZCBub3RlIHRvIG5vdGVzIGFycmF5IG9uIHRoZSBiYWNrZW5kLgogICAgICBsZXQgdm0gPSB0aGlzOwogICAgICBDdXN0b21lclNlcnZpY2UuYWRkQ3VzdG9tZXJOb3RlKAogICAgICAgIHZtLnNlbGVjdGVkQ3VzdG9tZXIuY3VzdG9tZXJJZCwKICAgICAgICBuZXdOb3RlCiAgICAgICkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMpIHsKICAgICAgICAgIHRoaXMuc2VsZWN0ZWRDdXN0b21lck5vdGVzLnB1c2gobmV3Tm90ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJBbiBlcnJvciBoYXMgb2NjdXJyZWQuIik7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgdGhpcy5kaXNwbGF5Tm90ZU1vZGFsID0gZmFsc2U7CiAgICB9LAogICAgc2V0QWN0aXZlQ3VzdG9tZXIoY3VzdG9tZXIpIHsKICAgICAgbGV0IHZtID0gdGhpczsKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgdm0uc2VhcmNoVGV4dCA9IGN1c3RvbWVyLmVtYWlsIHx8IGN1c3RvbWVyLnBob25lOwogICAgICAgIHZtLnNlbGVjdEN1c3RvbWVyQ2hhdChjdXN0b21lcik7CiAgICAgIH0sIDEwMDApOwogICAgfSwKICAgIHNldEFjdGl2ZUN1c3RvbWVyQXNVbnJlc29sdmVkKCkgewogICAgICBpZiAodGhpcy5zZWxlY3RlZEN1c3RvbWVyKSB7CiAgICAgICAgdGhpcy5zZWxlY3RlZEN1c3RvbWVyLnJlc29sdmVkIC0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBjbG9zZVRhZ01lbnUoKSB7CiAgICAgIGxldCBjaGlsZHJlbiA9IHRoaXMuJGNoaWxkcmVuOwogICAgICBpZiAoY2hpbGRyZW4gJiYgY2hpbGRyZW4ubGVuZ3RoID4gMSkgewogICAgICAgIGlmICh0aGlzLiRjaGlsZHJlblswXS5jbG9zZU1lbnUpIHsKICAgICAgICAgIHRoaXMuJGNoaWxkcmVuWzBdLmNsb3NlTWVudSgpOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy4kY2hpbGRyZW5bMV0uY2xvc2VNZW51KSB7CiAgICAgICAgICB0aGlzLiRjaGlsZHJlblsxXS5jbG9zZU1lbnUoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBkaXNwbGF5aW50ZXJhY3Rpb25zKGxvZykgewogICAgICBpZiAobG9nLmxlbmd0aCA+IDApIHsKICAgICAgICAvLyBsZXQgaiA9IEpTT04ucGFyc2UobG9nW2xvZy5sZW5ndGggLSAxXSk7CiAgICAgICAgLy8gcmV0dXJuIGxvZ1tsb2cubGVuZ3RoIC0gMV07CiAgICAgICAgdmFyIGxvID0gbG9nW2xvZy5sZW5ndGggLSAxXTsKICAgICAgICB2YXIgdHlwZSA9IGxvLnR5cGU7CiAgICAgICAgbGV0IGludGVyYWN0aW9uID0gdHlwZS5zdWJzdHIoMCwgMTUpOwogICAgICAgIHJldHVybiBpbnRlcmFjdGlvbiArICIuLi4uIjsKICAgICAgfQogICAgfSwKICAgIGNsb3NlQ3VzdG9tZXJNb2RhbCgpIHsKICAgICAgdGhpcy5zZWxlY3RlZEN1c3RvbWVyID0gbnVsbDsKICAgICAgdGhpcy5vcGVuQ3VzdG9tZXJNb2RhbCA9IGZhbHNlOwogICAgICB0aGlzLm9wZW5DdXN0b21lckRldGFpbE1vZGFsID0gZmFsc2U7CiAgICAgIHRoaXMuc2hvd0N1c3RvbWVyQ2hhdCA9IGZhbHNlOwogICAgICB0aGlzLnByZXZpZXdDU1YgPSBmYWxzZTsKICAgICAgdGhpcy5yYXdEYXRhID0gW107CiAgICAgIHRoaXMuZGVsZXRlTGlzdCA9IFtdOwogICAgICB0aGlzLnJlcXVlc3RBZ2FpbiA9IGZhbHNlOwogICAgICB0aGlzLiRyZWZzLmNzdklucHV0LnZhbHVlID0gbnVsbDsKICAgICAgRXZlbnRTZXJ2aWNlLiRlbWl0KCJsb2FkaW5nIiwgImhpZGUiKTsKICAgICAgLy90aGlzLnNlYXJjaEN1c3RvbWVycygpOwogICAgfQogIH0KfTsK"},{"version":3,"sources":["Customers.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Customers.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"wrapper card-min-height\">\n    <el-card v-if=\"!showCustomerDetail\">\n      <div class=\"card-header\">\n        <div class=\"card-title\">\n          <h3>Customers</h3>\n        </div>\n        <div class=\"card-actions\">\n          <el-button\n            type=\"primary\"\n            @click=\"$refs.csvInput.click()\">\n            +<i class=\"fa fa-users fa-flip-horizontal\"></i>\n            Bulk Upload\n          </el-button>\n          <input\n            ref=\"csvInput\"\n            type=\"file\"\n          style=\"display:none\"\n            accept=\"text/csv\"\n            @change=\"massAddCustomer\"\n          />\n          <el-button\n            type=\"primary\"\n            @click=\"editCustomer()\"\n          >\n          <i class=\"fa fa-user-plus fa-flip-horizontal\"></i>\n             Add Customer\n          </el-button>\n          <div class=\"input-group\">\n            <el-popover trigger=\"click\" class=\"filter clickable\" v-model=\"showFilters\">\n              <div class=\"filter-button\" :class=\"{'filter-active': filtersActive}\" slot=\"reference\">\n                <i class=\"fas fa-filter\"></i>\n              </div>\n              <div class=\"dropdown-filter-menu\">\n                <div class=\"dropdown-filter-option\">\n                  <label>Rating</label>\n                  <el-select v-model=\"filters.ratings\" :collapse-tags=\"true\" multiple>\n                    <el-option v-for=\"rating in 5\" :key=\"rating\" :value=\"rating\">\n                      {{rating}}\n                    </el-option>\n                  </el-select>\n                </div>\n                <div class=\"dropdown-filter-option\">\n                  <label>Status</label>\n                  <el-select round v-model=\"filters.status\" :collapse-tags=\"true\" multiple>\n                    <el-option v-for=\"status in statusFilterOptions\" :key=\"status.value\" :value=\"status.value\" :label=\"status.label\">                      \n                    </el-option>\n                  </el-select>\n                </div>\n                <div class=\"dropdown-filter-option\">\n                  <label>Tags</label>\n                  <el-select v-model=\"filters.tags\" :collapse-tags=\"true\" multiple :multiple-limit=\"4\">\n                    <el-option v-for=\"tag in sortedCustomerTags\" :key=\"tag\" :value=\"tag\">\n                      {{tag}}\n                    </el-option>\n                  </el-select>\n                </div>\n                <div class=\"dropdown-filter-buttons\">\n                  <!-- <span class=\"filter-reset clickable\" @click=\"resetFilters()\">Reset Filters</span> -->\n                  <el-button type=\"text\" size=\"small\" style=\"color:#757575\" @click=\"resetFilters()\">Reset Filters</el-button>\n                  <el-button type=\"warning\" round size=\"small\" @click=\"searchCustomers()\">Apply</el-button>\n                </div>\n              </div>\n            </el-popover>\n            <el-input\n              v-model=\"searchText\"\n              @keyup.native.enter=\"searchCustomers()\"\n              placeholder=\"Search Customers...\"\n            ><i slot=\"suffix\" class=\"far fa-search\"></i></el-input>\n          </div>\n        </div>\n      </div>\n      <el-popover id=\"bulk-menu\"\n                  trigger=\"click\" \n                  placement=\"bottom-end\"                  \n                  >\n        <el-button type=\"primary\" slot=\"reference\" v-show=\"showBulkActions\" size=\"medium\" round>\n          <span >Actions&nbsp;<i class=\"fas fa-caret-down\"></i></span>\n        </el-button>\n        <div class=\"customer-mass-actions-menu\">\n          <el-link round class=\"dropdown-item\" @click=\"massChangeStatus('active')\">\n            Mark as Subscribed\n          </el-link>\n          <el-link round class=\"dropdown-item\" @click=\"massChangeStatus('inactive')\">\n            Mark as Unsubscribed\n          </el-link>\n          <el-link round class=\"dropdown-item\" @click=\"massChangeStatus('deleted')\">\n            Delete Customers\n          </el-link>\n          <el-link round class=\"dropdown-item\" @click=\"openTagsMenu()\">\n            Add Tag(s)\n          </el-link>\n          <div class=\"tags-menu\" v-if=\"showTagsMenu\">\n            <h3>Add Tags</h3>\n            <el-input v-model=\"newTag\" @keyup.native.enter=\"addTagToList\" multiple></el-input>\n            <div class=\"tags-container\">\n              <el-tag v-for=\"(tag, tagIndex) in tagsToAdd\" closable :key=\"tag\" @close=\"removeTagFromList(tagIndex)\">{{tag}}</el-tag>\n            </div>\n            <div class=\"tags-menu-buttons\">\n              <span class=\"discard clickable\" @click=\"discardTags\">Discard</span>\n              <el-button :disabled=\"!tagsToAdd.length\" round type=\"primary\" @click=\"addTags()\">ADD</el-button>\n            </div>\n          </div>\n          <el-link round class=\"dropdown-item\" @click=\"massRequestReview()\">\n            Request Review\n          </el-link>\n        </div>\n      </el-popover>\n      <div class=\"card-body\">\n        <div class=\"block\" v-if=\"customers\">\n          <el-table class=\"card-table-min-height\" \n          :data=\"customers\" \n          row-class-name=\"clickable\" \n          highlight-current-row \n          size=\"small\"\n          empty-text=\"No results found based on your search criteria.\"\n          ref=\"customerTable\" \n          height=\"calc(80vh - var(--navbar-height) - var(--footer-height) - 40px)\" \n          @sort-change=\"handleSort\"\n          @selection-change=\"handleSelectionChange\" \n          @row-click=\"selectCustomer($event)\">\n            <el-table-column type=\"selection\" v-model=\"deleteList\" width=\"50\"></el-table-column>\n            <el-table-column  label=\"Name\" \n                              min-width=\"120\" \n                              prop=\"name\" \n                              sortable=\"custom\" \n                              :sort-orders=\"sortOptions\" \n                              show-overflow-tooltip>\n              <template slot-scope=\"scope\">\n                <span>{{scope.row.firstName}} {{scope.row.lastName}}</span>\n              </template>\n            </el-table-column>\n            <el-table-column prop=\"status\" label=\"Status\" min-width=\"150\">\n              <!-- temp -->\n              <template slot-scope=\"scope\">\n                <span v-if=\"scope.row.status == 'deleted'\" class=\"status-bubble deleted\">{{scope.row.status}}</span>\n                <span v-else-if=\"scope.row.status == 'active'\" class=\"status-bubble subscribed\">Subscribed</span>\n                <span v-else-if=\"scope.row.status == 'inactive'\" class=\"status-bubble unsubscribed\">Unsubscribed</span>\n              </template>\n            </el-table-column>\n            <el-table-column prop=\"rating\" label=\"Rating\" min-width=\"120\" sortable=\"custom\" :sort-orders=\"sortOptions\" >\n              <template slot-scope=\"scope\">\n                <span class=\"star\" v-for=\"star of scope.row.rating\" :key=\"star\"><i style=\"color:#EBC545\" class=\"fas fa-star\"></i></span>\n              </template>\n            </el-table-column>\n            <el-table-column\n              min-width=\"200\"\n              prop=\"location.name\"\n              label=\"Location\"\n              show-overflow-tooltip\n            ></el-table-column>\n            <el-table-column prop=\"tags\" label=\"Tags\" min-width=\"200\" show-overflow-tooltip>\n              <template slot-scope=\"scope\">\n                <el-tag class=\"tag\" size=\"small\" v-for=\"tag in scope.row.tags\" :key=\"tag\">{{ tag }}</el-tag>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"Last Contact\" prop=\"lastContactDate\" min-width=\"140\">\n              <template slot-scope=\"scope\">\n                <span v-if=\"scope.row.lastContactDate\">{{parseDate(scope.row.lastContactDate.date)}}</span>\n                <span v-else>None</span>\n              </template>            \n            </el-table-column>\n          </el-table>\n        </div>\n        <div class=\"pagination block\" v-if=\"customers && customers.length\">\n          <span>Showing {{customers.length}} of {{paginationData.total}} Total Results</span>\n          <el-pagination\n            @current-change=\"searchCustomers\"\n            background\n            layout=\"prev, pager, next\"\n            :current-page=\"paginationPage\"\n            :page-size=\"paginationData.perPage\"\n            :total=\"paginationData.total\"\n            small\n          ></el-pagination>\n          <el-select class=\"per-page-select\" size=\"mini\" v-model=\"paginationData.perPage\" @change=\"searchCustomers()\">\n            <el-option v-for=\"option in paginationData.perPageOptions\"\n                       :value=\"option\"\n                       :key=\"option\"                       \n            >{{option}}\n            </el-option>\n          </el-select>\n        </div>        \n        <div class=\"block\" v-else></div>\n\n        <!-- <list-table :listName=\"'Customers'\" :headers=\"listHeaders\" :data=\"customers\" :sort=\"sortType\" v-on:toggleSort=\"toggleSort($event)\"></list-table> -->\n      </div>\n    </el-card>\n      <customerDetail :selectedCustomer=\"selectedCustomer\" v-if=\"showCustomerDetail\" @back=\"closeCustomerDetails()\" @closeModal=\"closeCustomerDetails()\"/>\n      <addCustomer :selectedCustomer=\"selectedCustomer\" :openCustomerModal=\"openCustomerModal\" v-if=\"openCustomerModal\" @closeModal=\"closeCustomerModal()\"/>\n      <!-- <CSVPreview :rawData=\"rawData\" :fileName=\"fileName\" v-if=\"previewCSV\" @closeModal=\"closeCustomerModal()\" />     -->\n      <CSVOld :rawData=\"rawData\" :fileName=\"fileName\" v-if=\"previewCSV\" @closeModal=\"closeCustomerModal()\" />\n      <requestReview v-if=\"requestModal\" :requestModal=\"requestModal\" @close=\"requestModal = false\" />\n  </div>\n</template>\n\n<script>\n  import UserService from \"../services/UserService\";\n  import RequestReview from \"./RequestReview\";\n  import CustomerService from \"../services/CustomerService\";\n  import LocationService from \"../services/LocationService\";\n  import { EventService } from \"../main\";\n  import AddCustomer from \"./AddCustomer\";\n  import CustomerDetail from \"./CustomerDetail\";\n  import CSVPreview from \"./CSVPreview\";\n  import CSVOld from \"./CSVOld\";\n  import Papa from \"../../node_modules/papaparse/papaparse.js\";\n  import Vue from 'vue'\n  import imageFile from '../assets/imageFile.js';\n  // Vue.use(Select)\n  // Vue.use(Option)\n\n  export default {\n    components : {\n      CustomerDetail,\n      AddCustomer,\n      CSVPreview,\n      CSVOld,\n      RequestReview\n    },\n  data: function() {\n    return {\n      selected: \"all\",\n      customers: [],\n      filters: {\n        ratings: [],\n        status: [],\n        tags: []\n      },\n      sortOptions: ['ascending', 'descending'],\n      statusFilterOptions: [{label: 'Subscribed', value: 'active'}, {label: 'Unsubscribed', value: 'inactive'}],\n      requestModal: false,\n      showFilters: false,\n      showTagsMenu: false,\n      newTag: '',\n      tagsToAdd: [],\n      showCustomerDetail: false,\n      displayInfo: true,\n      displayNotes: false,\n      displayTags: false,\n      displayAdmin: false,\n      displayContact: true,\n      addingNote: false,\n      searchText: \"\",\n      newNote: \"\",\n      newTag: \"\",\n      selectedType: false,\n      selectedView: \"chat\",\n      openCustomerModal: false,\n      openCustomerDetailModal: false,\n      displayNoteModal: false,\n      selectedCustomer: null,\n      selectedCustomerNotes: [],\n      showCustomerChat: false,\n      previewCSV: false,\n      requestAgain: false,\n      sortType: \"name\",\n      deleteList: [],\n      displayButtons: false,\n      rawData: [],\n      locationSelected: \"\",\n      locations: [],\n      isSuperAdmin: false,\n      statusFilter: \"\",\n      ratingFilter: \"\",\n      locationFilter: \"\",\n      totalResults: 0,\n      totalUnread: 0,\n      selectedPage: 0,\n      moreCustomersToLoad: false,\n      scrollObserver: null,\n      fileName: \"\",\n      allS: false,\n      selectedLocationQs: \"\",\n      userRole: \"\",\n      locationName: \"\",\n      rawData: \"\",\n      note: \"\",\n      paginationData: {\n        perPage: 25,\n        currentPage: 0,\n        perPageOptions: [5, 10, 25],\n        total: 0,      \n      },\n      customerTags: []\n    };\n  },\n  computed: {\n    sortedCustomerTags() {\n      let vm = this;\n      return vm.customerTags.sort();\n    },\n    filtersActive() {\n      let vm = this;\n      if(vm.filters.ratings.length || vm.filters.status.length || vm.filters.tags.length) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n    getActiveStatus: function() {\n      var status = this.customers.status;\n      if (status == \"active\") {\n        return \"subscribed\";\n      } else if (status == \"inactive\") {\n        return \"unsubscribed\";\n      } else {\n        return \"deleted\";\n      }\n    },\n    paginationPage() {\n      return (this.paginationData.currentPage+1);\n    },\n    showBulkActions() {\n      let vm = this;\n      if(vm.deleteList && vm.deleteList.length) {\n        return true;\n      }\n      return false;\n    }\n  },\n  created() {\n    if (this.$route.params.customerId) {\n      let routeCustomerId = this.$route.params.customerId;\n      CustomerService.getCustomer(routeCustomerId).then(res => {\n        this.selectCustomer(res);\n      });\n    }\n    if (this.$route.query.list) {\n      this.changeSelected(\"unreplied\");\n    } else {\n      this.checkForAdmin();\n    }\n\n    UserService.logPageVisit(\"customerList\");\n    this.locationSelected = localStorage.getItem(\"locationId\");\n    this.getLocationQs();\n    this.getLocationCustomerTags();\n    this.getUser();\n    this.searchCustomers(0);\n    EventService.$on(\"locationChange\", this.locationChange);\n    EventService.$on(\"reloadCustomerChatList\", this.reloadCustomerChatList);\n    EventService.$on(\n      \"setActiveCustomerAsUnresolved\",\n      this.setActiveCustomerAsUnresolved\n    );\n  },\n  beforeDestroy: function() {\n    if (this.interval) {\n      clearInterval(this.interval);\n    }\n    this.scrollObserver.disconnect();\n    EventService.$off(\"locationChange\", this.locationChange);\n    EventService.$off(\"reloadCustomerChatList\", this.reloadCustomerChatList);\n    EventService.$off(\n      \"setActiveCustomerAsUnresolved\",\n      this.setActiveCustomerAsUnresolved\n    );\n  },\n  methods: {\n    getUser() {\n      var vm = this;\n      UserService.getUserRole(vm.locationId).then(\n        function(response) {\n          vm.userRole = response.role;\n        },\n        function(error) {\n          console.log(error);\n        }\n      );\n    },\n    selectChat(c) {\n      try {\n        localStorage.setItem(\"customer\", JSON.stringify(c));\n      } catch (error) {\n        console.log(error);\n      }\n      this.$router.push({ path: \"/customerDetails\" });\n    },\n    exportCustomer() {\n      EventService.$emit(\"loading\", \"show\");\n      var vm = this;\n      CustomerService.getAllCustomers(this.locationSelected).then(response => {\n        var exportableCustomer = response;\n        EventService.$emit(\"loading\", \"hide\");\n        vm.downloadCustomer(exportableCustomer);\n      });\n    },\n    displayCustomerInfo(customer) {\n      if (customer.firstName || customer.lastName) {\n        return customer.firstName + \" \" + customer.lastName;\n      } else if (customer.phone) {\n        return customer.phone;\n      } else if (customer.email) {\n        return customer.email;\n      } else {\n        return \"Unknown Customer\";\n      }\n    },\n    downloadCustomer(data) {\n      let vm = this;\n      LocationService.getLocation(vm.locationSelected).then(response => {\n        vm.locationName = response.name;\n        EventService.$emit(\"loading\", \"show\");\n        var csvDownload = Papa.unparse(data.results);\n        var MIME_TYPE = \"text/csv\";\n        var blob = new Blob([csvDownload], { type: MIME_TYPE });\n        var csvURL = window.URL.createObjectURL(blob);\n        var tempLink = document.createElement(\"a\");\n        tempLink.href = csvURL;\n        tempLink.setAttribute(\n          \"download\",\n          `${vm.locationName} Customer Report.csv`\n        );\n        document.body.appendChild(tempLink);\n        tempLink.click();\n        EventService.$emit(\"loading\", \"hide\");\n        csvDownload = {};\n        try {\n          document.body.removeChild(tempLink);\n        } catch (e) {}\n      });\n    },\n    checkForAdmin() {\n      var vm = this;\n      UserService.getCurrentUser().then(response => {\n        vm.isSuperAdmin = response.isSuperAdmin;\n        vm.userId = response.userId;\n        if (!vm.isSuperAdmin) vm.changeSelected(\"all\");\n      });\n    },\n    displayDate(millis) {\n      var date = new Date(millis);\n      return (\n        1 +\n        date.getMonth() +\n        \"/\" +\n        date.getDate() +\n        \"/\" +\n        (date.getFullYear() % 100)\n      );\n    },\n    selectAll() {\n      this.customers.map((e, i) => {\n        this.prepForDelete(e);\n      });\n    },\n    locationChange() {\n      this.locationSelected = localStorage.getItem(\"locationId\");\n      this.deleteList = [];\n      this.searchCustomers();\n    },\n    getLocationQs() {\n      let vm = this;\n      if (vm.locationSelected) {\n        LocationService.getLocation(vm.locationSelected).then(response => {\n          vm.selectedLocationQs = response.qsEnabled;\n          vm.templateOptions = response.questionTemplate;\n        });\n      }\n    },\n    getLocationCustomerTags() {\n      let vm = this;\n      let searchObject = {};\n      let locationIdArray = [];\n      let locationId = localStorage.getItem('locationId');\n      if(locationId) {\n        locationIdArray.push(locationId);\n      } else {\n        let locOptions = JSON.parse(localStorage.getItem('locationOptions'));\n        locOptions.map(el => locationIdArray.push(el.locationId));\n      }\n      searchObject.locations = locationIdArray;\n      LocationService.getAvailableCustomerTags(searchObject).then(response => {\n        vm.customerTags = response.tags;\n      })\n    },\n    massResolveCustomerInteract() {\n      if (window.confirm(\"Are you sure you want to Mark these as Resolved?\")) {\n        var vm = this;\n        let newInteraction = \"resolve\";\n        this.deleteList.map((e, i) => {\n          CustomerService.addCustomerEngagementLog(\n            e.customerId,\n            \"Interaction marked as closed\"\n          ).then(response => {\n            if (response.success) {\n              vm.searchCustomers();\n            }\n          });\n        });\n      }\n    },\n    handleSort(data) {\n      let vm = this;\n      let direction = '-';\n      if(vm.sortType[0] == '-') {\n        direction = ''\n      }\n      vm.sortType = direction + data.prop;      \n      vm.searchCustomers();\n    },\n    searchCustomers(pageNum) {\n      EventService.$emit(\"loading\", \"show\");\n      this.moreCustomersToLoad = false;\n      this.customers = [];\n      this.totalResults = 0;\n      this.totalUnread = 0;\n      this.deleteList = [];\n      this.allS = false;\n      var vm = this;\n      vm.showFilters = false;\n      var searchObject = {};\n      if (this.searchText) searchObject.searchText = this.searchText.trim();\n      searchObject.resPerPage = this.paginationData.perPage;\n      if (this.sortType) {\n        if (this.sortType == \"name\") {\n          searchObject.sort = \"firstName\";\n        } else if (this.sortType == \"-name\") {\n          searchObject.sort = \"-firstName\";\n        } else if (this.sortType == \"date\") {\n          searchObject.sort = \"createdDate\";\n        } else if (this.sortType == \"-date\") {\n          searchObject.sort = \"-createdDate\";\n        } else {\n          searchObject.sort = this.sortType;\n        }\n      }\n\n      if (this.locationSelected) {\n        searchObject.locationId = this.locationSelected;\n      }\n\n      if (pageNum) {\n        searchObject.pageNum = pageNum;\n        vm.paginationData.currentPage = pageNum - 1;\n      } else {\n        searchObject.pageNum = 0;\n        this.paginationData.currentPage = 0;\n      }\n\n      var vm = this;\n      searchObject.filters = vm.filters;\n      // if(vm.selectedView == 'list') {\n      CustomerService.searchCustomersAdvanced(searchObject).then(\n        function(response) {\n          if(response[0].results) vm.customers = response[0].results;\n          if(response[0].count && response[0].count[0] && response[0].count[0].total) vm.paginationData.total = response[0].count[0].total;\n          \n          EventService.$emit(\"loading\", \"hide\");\n        },\n        function(error) {\n          console.log(error);\n          EventService.$emit(\"loading\", \"hide\");\n        }\n      );\n    },\n    reloadCustomerChatList() {\n      this.totalResults = 0;\n      this.searchCustomers(0);\n    },\n    setPageNum(pageNum) {\n      this.selectedPage = pageNum;\n      this.searchCustomers(pageNum);\n    },\n    toggleSort(setSortType) {\n      if (this.sortType != setSortType) {\n        this.sortType = setSortType;\n      } else {\n        this.sortType = \"-\" + this.sortType;\n      }\n      this.searchCustomers(this.selectedPage);\n    },\n    editCustomer(customer) {\n      if (customer) {\n        this.selectedCustomer = customer;\n      } else {\n        this.selectedCustomer = null;\n      }\n      this.openCustomerModal = true;\n    },\n    massAddCustomer(event) {\n      EventService.$emit(\"loading\", \"show\");\n      if (event.target.files[0]) {\n        \n        let filesList = event.target.files[0];\n        this.fileName = event.target.files[0].name;\n        let vm = this;\n        Papa.parse(filesList, {\n          complete: function(result) {\n            EventService.$emit(\"loading\", \"hide\");\n            vm.rawData = result.data;\n            vm.previewModal();\n          },\n          error: function(error) {\n            EventService.$emit(\"loading\", \"hide\");\n            EventService.$emit(\n              \"errorMessage\",\n              \"Sorry, something went wrong. Please try again.\"\n            );\n          }\n        });\n      }\n    },\n    selectCustomer(customer) {\n      this.selectedView = 'chat';\n      this.selectedCustomer = customer;\n      this.showCustomerDetail = true;\n      this.searchCustomers();\n      // this.searchText = customer.firstName + ' ' + customer.lastName;\n    },\n    deleteCustomer(customer) {\n      var vm = this;\n      if (window.confirm(\"Are you sure you want to delete this customer?\")) {\n        CustomerService.deleteCustomer(customer.customerId).then(\n          function(response) {\n            vm.closeCustomerChat();\n            vm.searchText = \"\";\n            vm.searchCustomers();\n          },\n          function(error) {\n            console.log(error);\n          }\n        );\n      }\n    },\n    closeCustomerDetails() {\n      let vm = this;\n      vm.selectedCustomer = '';\n      vm.showCustomerDetail = false\n      vm.searchCustomers();\n    },\n    handleSelectionChange(customers) {      \n      this.deleteList = customers;\n    },\n    displayOptions() {\n      this.displayButtons = !this.displayButtons;\n    },\n    prepForDelete(customer) {\n      this.locationSelected = localStorage.getItem(\"locationId\");\n      if (!this.deleteList.includes(customer)) {\n        this.deleteList.push(customer);\n      } else {\n        this.deleteList = this.deleteList.filter(data => {\n          return data !== customer;\n        });\n      }\n    },\n    massChangeStatus(status) {\n      let message = 'Are you sure you want to change these statuses?'\n      if(status == 'deleted') {\n        message = 'Are you certain you want to delete these customers?'\n      }\n      this.$confirm( message, 'Confirmation', {\n        confirmButtonText: 'Yes',\n        cancelButtonText: 'Cancel',\n        type: \"error\"\n      }).then(() => {\n        var vm = this;\n        let newCustomerStatus = \"\";\n        this.deleteList.map((e, i) => {\n          newCustomerStatus = status;\n          CustomerService.setCustomerStatus(\n            e.customerId,\n            newCustomerStatus\n          ).then(response => {\n            if(response) {\n              EventService.$emit('successMessage', 'Status changed successfully!')\n              vm.searchCustomers();              \n            } else {\n              EventService.$emit('errorMessage', 'Something went wrong, please try again.')\n            }\n          });\n        });\n        this.displayButtons = false;\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: \"Delete Cancelled\"\n        })\n      })\n    },\n    openTagsMenu() {\n      this.showTagsMenu = true;\n    },\n    closeTagsMenu() {\n      this.showTagsMenu = false;\n      this.showFilters = false;\n    },\n    addTagToList() {\n      let vm = this;\n      let newTag = vm.newTag.trim();\n      if(newTag) {\n        vm.tagsToAdd.push(newTag);\n        vm.newTag = '';\n        newTag = '';\n      } else {\n        EventService.$emit('warningMessage', 'Tags cannot be blank!')        \n      }\n    },\n    removeTagFromList(index) {\n      let vm = this;\n      vm.tagsToAdd.splice(index,1);\n    },\n    addTags() {\n      var vm = this;\n      this.deleteList.map((e, i) => {\n        this.tagsToAdd.map(h => {\n          CustomerService.addTagToCustomer(h, e.customerId).then(response => {\n            vm.searchCustomers();\n          });\n        })\n      });\n      document.getElementsByClassName('card-title')[0].click();\n      this.closeTagsMenu();\n    },\n    discardTags() {\n      let vm = this;\n      vm.tagsToAdd = [];\n      vm.closeTagsMenu();\n    },\n    massRequestReview() {\n      this.requestModal = true;\n    },\n    massDelete() {\n      if (window.confirm(\"Are you sure you want to delete these customers?\")) {\n        var vm = this;\n        this.deleteList.map((e, i) => {\n          CustomerService.deleteCustomer(e.customerId).then(response => {\n            vm.searchCustomers();\n          });\n        });\n        this.displayButtons = false;\n      }\n    },\n    parseDate(date) {\n      let newDate = new Date(date);\n      let dateString = (newDate.getMonth()+1) + newDate.toString().substr(7,8);\n      let formattedDateString = dateString.replace(/\\s/g, '/');\n      return formattedDateString;\n    },\n    setCustomerStatus(customer, status) {\n      let vm = this;\n      CustomerService.setCustomerStatus(customer.customerId, status).then(\n        response => {\n          vm.searchCustomers();\n        }\n      );\n    },\n    closeReRequestModal() {\n      this.requestAgain = false;\n    },\n    reRequestReview(single) {\n      if (single) {\n        this.requestAgain = true;\n      } else {\n        if (\n          window.confirm(\n            \"Please confirm you would like to ask these customers for a review again.\"\n          )\n        ) {\n          let locationId = localStorage.getItem(\"locationId\");\n          let vm = this;\n          vm.requestAgain = true;\n          // Below is old code for automatic re-requesting if no Qs are enabled.\n          // if(vm.selectedLocationQs && vm.selectedLocationQs == true) {\n          //   vm.requestAgain = true;\n          // }\n          // else {\n          //   CustomerService.reRequest(locationId, vm.deleteList).then( response => {\n          //   if (response.success == true) {\n          //     EventService.$emit(\"loading\", \"hide\");\n          //     EventService.$emit(\"successMessage\", \"Hooray! Reviews Requested.\");\n          //   } else {\n          //     EventService.$emit(\"loading\", \"hide\");\n          //     EventService.$emit(\n          //       \"errorMessage\",\n          //       \"Sorry, something went wrong. Please try again.\"\n          //     );\n          //   }\n          //   })\n          // }\n        }\n      }\n    },\n    canActionCustomer(action, customer) {\n      return true;\n    },\n    previewModal() {\n      this.previewCSV = true;\n    },\n    resetFilters() {\n      this.filters = {\n        ratings: [],\n        status: [],\n        tags: []\n      }\n    },\n    formatFullDate(date) {\n      let messageDate = new Date(date)\n        .toString()\n        .substr(4, 20)\n        .trim();\n      return messageDate;\n    },\n    formatDate(date) {\n      let messageDate = new Date(date).toLocaleTimeString();\n      let lastColonPos = messageDate.lastIndexOf(\":\");\n      messageDate =\n        messageDate.substring(0, lastColonPos) +\n        messageDate.substring(lastColonPos + 3);\n      if (Date.now() - date > 1000 * 60 * 60 * 24) {\n        messageDate = new Date(date)\n          .toString()\n          .substr(4, 6)\n          .trim();\n      }\n      return messageDate;\n    },\n    getLastMessageText(logs) {\n      let lastMessageText = \"\";\n      for (var i = 0; i < logs.length && lastMessageText == \"\"; i++) {\n        if (logs[i].text) {\n          lastMessageText = logs[i].text;\n        }\n      }\n      return lastMessageText;\n    },\n    changeSelected(type) {\n      let vm = this;\n      vm.selectedType = !vm.selectedType;\n      vm.selected = type;\n      vm.searchCustomers();\n    },\n    toggleNote() {\n      this.addingNote = !this.addingNote;\n      this.newNote = \"\";\n      if (this.addingNote) {\n        this.$nextTick(() => this.$refs.noteInput.focus());\n      }\n    },\n    saveNote() {\n      let vm = this;\n      if (vm.newNote) {\n        let note = vm.newNote;\n        this.deleteList.map((e, i) => {\n          CustomerService.addCustomerNote(e.customerId, vm.newNote).then(\n            res => {\n              if (res) {\n                vm.newNote = \"\";\n                vm.displayNotes = !vm.displayNotes;\n                vm.searchCustomers();\n              }\n            }\n          );\n        });\n      }\n    },\n    saveTag() {\n      let vm = this;\n      if (vm.newTag) {\n        let tag = vm.newTag;\n        this.deleteList.map((e, i) => {\n          CustomerService.addTagToCustomer(vm.newTag, e.customerId).then(\n            res => {\n              if (res) {\n                vm.newTag = \"\";\n                vm.displayTags = !vm.displayTags;\n                vm.searchCustomers();\n              }\n            }\n          );\n        });\n      }\n    },\n    closeCustomerChat() {\n      this.selectedCustomer = null;\n      this.showCustomerChat = false;\n    },\n    cancelNote() {\n      this.displayNoteModal = false;\n    },\n    closeNoteModal(newNote) {\n      // Add note to notes array on the backend.\n      let vm = this;\n      CustomerService.addCustomerNote(\n        vm.selectedCustomer.customerId,\n        newNote\n      ).then(res => {\n        if (res) {\n          this.selectedCustomerNotes.push(newNote);\n        } else {\n          console.log(\"An error has occurred.\");\n        }\n      });\n      this.displayNoteModal = false;\n    },\n    setActiveCustomer(customer) {\n      let vm = this;\n      setTimeout(() => {\n        vm.searchText = customer.email || customer.phone;\n        vm.selectCustomerChat(customer);\n      }, 1000);\n    },\n    setActiveCustomerAsUnresolved() {\n      if (this.selectedCustomer) {\n        this.selectedCustomer.resolved - false;\n      }\n    },\n    closeTagMenu() {\n      let children = this.$children;\n      if (children && children.length > 1) {\n        if (this.$children[0].closeMenu) {\n          this.$children[0].closeMenu();\n        } else if (this.$children[1].closeMenu) {\n          this.$children[1].closeMenu();\n        }\n      }\n    },\n    displayinteractions(log) {\n      if (log.length > 0) {\n        // let j = JSON.parse(log[log.length - 1]);\n        // return log[log.length - 1];\n        var lo = log[log.length - 1];\n        var type = lo.type;\n        let interaction = type.substr(0, 15);\n        return interaction + \"....\";\n      }\n    },\n    closeCustomerModal() {\n      this.selectedCustomer = null;\n      this.openCustomerModal = false;\n      this.openCustomerDetailModal = false;\n      this.showCustomerChat = false;\n      this.previewCSV = false;\n      this.rawData = [];\n      this.deleteList = [];\n      this.requestAgain = false;\n      this.$refs.csvInput.value = null;\n      EventService.$emit(\"loading\", \"hide\");\n      //this.searchCustomers();\n    }\n  }\n};\n</script>\n\n<style scoped>\n.el-popper {\n  margin-right: 125px;\n}\n\n.input-group-change {\n  position: relative;\n  z-index: 9999;\n  /* display: flex;\n    flex-direction: row; */\n  margin-top: 10px;\n}\n\n.input-group-addon {\n  border-right: none;\n  background-color: #f2f2f2;\n  color: #757575;\n  font-size: 16px;\n}\n.input-group-field {\n  background-color: #fafafa;\n  border: none !important;\n}\n.customer-controls-add {\n  float: left;\n  padding: 10px 10px 0 0;\n  cursor: pointer;\n  font-weight: normal;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  color: #4fcbc5;\n}\n\n.customer-controls-add span {\n  font-size: 12px;\n  margin-top: 4px;\n  color: #545454;\n}\n\n.customer-controls-add i {\n  font-size: 16pt;\n}\n\n.customer-controls-add input {\n  display: none;\n}\n\n.dropdown-item {\n  margin: 10px 20px;\n  color: #9a9a9a;\n}\n\n.el-link.el-link--default {\n  justify-content: flex-start;\n}\n\n.input-group-addon .dropdown-toggle::after {\n  border: none;\n}\n.resolvedRow {\n  background-color: #f2f6f9 !important;\n}\n.unResolvedRow {\n  font-weight: bold;\n  color: #212120;\n}\n\n.customer-mass-actions-menu {\n  display: flex;\n  flex-direction: column;\n}\n\n.per-page-select {\n  max-width: 80px;\n}\n\n.darkened {\n  background: #9a9a9a;\n  color: white;\n}\n\n.fa-caret-down {\n  margin-left: 10px;\n\n}\n\n.tags-menu {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  box-shadow: 0 3px 6px rgba(0, 0, 0, .25);\n  padding: 10px 20px;  \n  max-width: 200px;\n}\n\n.tags-menu-buttons {\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  margin-top: 5px;\n}\n\n.tags-container {\n  width: 100%;\n  overflow: hidden;\n}\n\n.filter-button {\n  width: 60px;\n  height: 50px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n</style>\n"]}]}