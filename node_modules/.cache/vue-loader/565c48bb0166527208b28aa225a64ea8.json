{"remainingRequest":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/src/components/Autocomplete.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/src/components/Autocomplete.vue","mtime":1581270622000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBDdXN0b21lclNlcnZpY2UgZnJvbSAnLi8uLi9zZXJ2aWNlcy9DdXN0b21lclNlcnZpY2UuanMnOwppbXBvcnQgTG9jYXRpb25TZXJ2aWNlIGZyb20gJy4vLi4vc2VydmljZXMvTG9jYXRpb25TZXJ2aWNlLmpzJzsKdmFyIGxvb2t1cFRhYmxlID0gcmVxdWlyZSgnLi9UYWJsZXMvYXV0b2NvbXBsZXRldGFibGUuanMnKTsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnYXV0b2NvbXBsZXRlJywKICBwcm9wczogWyJ0eXBlIiwgInNlbGVjdGVkQ3VzdG9tZXIiLCAic2VsZWN0ZWRMb2NhdGlvbiJdLAogIGRhdGE6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHsKICAgICAgc2VhcmNoVGV4dDogJycsCiAgICAgIHRhZ1R5cGU6ICcnLAogICAgICBjdXN0b21lcjoge30sCiAgICAgIGxvY2F0aW9uOiB7fSwKICAgICAgYWxsVGFnczogW10sCiAgICAgIG1lbnVPcGVuOiBmYWxzZSwKICAgICAgdGVzdDogdHJ1ZSwKICAgICAgc2VsZWN0ZWRUYWc6ICcnLAogICAgICBleGlzdGluZ1RhZzogJycsCiAgICAgIGF2YWlsYWJsZVRhZ3M6IFtdLAogICAgICBtYXRjaEZvdW5kOiBmYWxzZQogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLnRhZ1R5cGUgPSB0aGlzLnR5cGU7CiAgICAKICAgIGlmKHRoaXMuc2VsZWN0ZWRDdXN0b21lcikgewogICAgICB0aGlzLmZpbmRUYWdPcHRpb25zKCk7CiAgICAgIGlmKCF0aGlzLnNlbGVjdGVkQ3VzdG9tZXIudGFncykgdGhpcy5zZWxlY3RlZEN1c3RvbWVyLnRhZ3MgPSBbXTsKICAgICAgdGhpcy5jdXN0b21lciA9IHRoaXMuc2VsZWN0ZWRDdXN0b21lcjsKICAgICAgaWYodGhpcy5jdXN0b21lci50YWdzICYmIHRoaXMuY3VzdG9tZXIudGFncy5sZW5ndGggPiAwKSB0aGlzLmFsbFRhZ3MgPSB0aGlzLmN1c3RvbWVyLnRhZ3Muc29ydCgpOwogICAgfQogICAgaWYodGhpcy5zZWxlY3RlZExvY2F0aW9uKSB7CiAgICAgIHRoaXMubG9jYXRpb24gPSB0aGlzLnNlbGVjdGVkTG9jYXRpb247CiAgICAgIGlmKCF0aGlzLmxvY2F0aW9uLnRhZ3MpIHRoaXMubG9jYXRpb24udGFncyA9IFtdOwogICAgICBpZih0aGlzLmxvY2F0aW9uLnRhZ3MgJiYgdGhpcy5sb2NhdGlvbi50YWdzLmxlbmd0aCA+IDApIHRoaXMuYWxsVGFncyA9IHRoaXMubG9jYXRpb24udGFncy5zb3J0KCk7CiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgZmlsdGVyZWRUYWdzKCkgewogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICB2bS5tYXRjaEZvdW5kID0gZmFsc2U7CiAgICAgIGlmKHZtLnRhZ1R5cGUgPT0gJ2N1c3RvbWVyJykgewogICAgICAgIGlmKHZtLmF2YWlsYWJsZVRhZ3MpewogICAgICAgICAgdmFyIGN1c3RUYWJsZSA9IHZtLmF2YWlsYWJsZVRhZ3MuZmlsdGVyKGVsID0+IHsKICAgICAgICAgICAgaWYodm0uc2VhcmNoVGV4dCkgewogICAgICAgICAgICAgIGlmKHZtLnNlYXJjaFRleHQudG9Mb3dlckNhc2UoKSA9PSBlbC50b0xvd2VyQ2FzZSgpKSB7CiAgICAgICAgICAgICAgICB2bS5tYXRjaEZvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdm0uY2hlY2tGdXp6eShlbCk7ICAgICAgICAgICAgCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZWw7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfQogICAgICAgIHJldHVybiBjdXN0VGFibGU7CiAgICAgIH0gZWxzZSBpZiAodm0udGFnVHlwZSA9PSAnbG9jYXRpb24nKSB7CiAgICAgICAgdmFyIGxvY1RhYmxlID0gbG9va3VwVGFibGUubG9jYXRpb25UYWdzLmZpbHRlcihlbCA9PiB7CiAgICAgICAgICBpZihlbCAmJiB2bS5zZWFyY2hUZXh0KSB7CiAgICAgICAgICAgIHJldHVybiB2bS5jaGVja0Z1enp5KGVsKTsgICAgICAgICAgICAKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBlbDsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIHJldHVybiBsb2NUYWJsZTsKICAgICAgfQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgY2hlY2tGdXp6eSh0YWcpIHsKICAgICAgaWYodGFnKSB7CiAgICAgICAgbGV0IHZtID0gdGhpczsKICAgICAgICBsZXQgbGNUYWcgPSB0YWcudG9Mb3dlckNhc2UoKTsKICAgICAgICBsZXQgbGNTZWFyY2ggPSB2bS5zZWFyY2hUZXh0LnRvTG93ZXJDYXNlKCk7CiAgICAgICAgdmFyIGNvc3RzID0gbmV3IEFycmF5KCk7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPD0gbGNUYWcubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHZhciBsYXN0VmFsdWUgPSBpOwogICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPD0gbGNTZWFyY2gubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgaWYgKGkgPT0gMCkKICAgICAgICAgICAgICBjb3N0c1tqXSA9IGo7CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgIGlmIChqID4gMCkgewogICAgICAgICAgICAgICAgdmFyIG5ld1ZhbHVlID0gY29zdHNbaiAtIDFdOwogICAgICAgICAgICAgICAgaWYgKGxjVGFnLmNoYXJBdChpIC0gMSkgIT0gbGNTZWFyY2guY2hhckF0KGogLSAxKSkKICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBNYXRoLm1pbihNYXRoLm1pbihuZXdWYWx1ZSwgbGFzdFZhbHVlKSwKICAgICAgICAgICAgICAgICAgICBjb3N0c1tqXSkgKyAxOwogICAgICAgICAgICAgICAgY29zdHNbaiAtIDFdID0gbGFzdFZhbHVlOwogICAgICAgICAgICAgICAgbGFzdFZhbHVlID0gbmV3VmFsdWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoaSA+IDApCiAgICAgICAgICAgIGNvc3RzW2xjU2VhcmNoLmxlbmd0aF0gPSBsYXN0VmFsdWU7CiAgICAgICAgfQogICAgICAgIGxldCBkaXN0YW5jZSA9IGNvc3RzW2xjU2VhcmNoLmxlbmd0aF0KICAgICAgICAvLyBJZiB0aGVyZSBpcyBhIG1hdGNoZm91bmQsIGJ1dCB0aGUgdGFnIGJlaW5nIGNoZWNrZWQgaXNuJ3QgaXQsIHJldHVybiBmYWxzZS4KICAgICAgICBpZih2bS5tYXRjaEZvdW5kICYmIGxjVGFnICE9IGxjU2VhcmNoKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIC8vIElmIHRoZSB0YWcgaW5jbHVkZXMgdGhlIHNlYXJjaCwgYnV0IGlzbid0IGFuIGV4YWN0IG1hdGNoLCBrZWVwIGl0LgogICAgICAgIGVsc2UgaWYobGNUYWcuaW5jbHVkZXMobGNTZWFyY2gpKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgLy8gSWYgdGhlIHRhZyBpcyB3aXRoaW4gMSBlZGl0IGRpc3RhbmNlLCBidXQgYSBtYXRjaCBoYXNuJ3QgYmVlbiBmb3VuZCwga2VlcCBpdC4KICAgICAgICBlbHNlIGlmKGRpc3RhbmNlIDw9MSApIHsKICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBmaW5kVGFnT3B0aW9ucygpIHsKICAgICAgbGV0IHZtID0gdGhpczsKICAgICAgbGV0IHNlYXJjaE9iamVjdCA9IHt9OwogICAgICBsZXQgbG9jYXRpb25JZEFycmF5ID0gW107CiAgICAgIGxldCBsb2NhdGlvbklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2xvY2F0aW9uSWQnKTsKICAgICAgaWYobG9jYXRpb25JZCkgewogICAgICAgIGxvY2F0aW9uSWRBcnJheS5wdXNoKGxvY2F0aW9uSWQpOwogICAgICB9IGVsc2UgewogICAgICAgIGxldCBsb2NPcHRpb25zID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbG9jYXRpb25PcHRpb25zJykpOwogICAgICAgIGxvY09wdGlvbnMubWFwKGVsID0+IGxvY2F0aW9uSWRBcnJheS5wdXNoKGVsLmxvY2F0aW9uSWQpKTsKICAgICAgfQogICAgICBzZWFyY2hPYmplY3QubG9jYXRpb25zID0gbG9jYXRpb25JZEFycmF5OwogICAgICBMb2NhdGlvblNlcnZpY2UuZ2V0QXZhaWxhYmxlQ3VzdG9tZXJUYWdzKHNlYXJjaE9iamVjdCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgaWYocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc29ydGVkVGFncykgewogICAgICAgICAgdm0uYXZhaWxhYmxlVGFncyA9IHJlc3BvbnNlLnNvcnRlZFRhZ3M7CiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGNsZWFyU2VhcmNoKCkgewogICAgICB0aGlzLnNlYXJjaFRleHQgPSAnJzsKICAgICAgdGhpcy4kcmVmcy5zZWFyY2guZm9jdXMoKTsKICAgIH0sCiAgICBhZGRUYWcodGFnKSB7CiAgICAgIGxldCB2bSA9IHRoaXM7CiAgICAgIGlmKHRhZykgewogICAgICAgIGlmKHZtLnRhZ1R5cGUgPT0gJ2N1c3RvbWVyJykgewogICAgICAgICAgaWYodm0uc2VsZWN0ZWRDdXN0b21lci50YWdzLmluZGV4T2YodGFnKSA8IDApIHsKICAgICAgICAgICAgQ3VzdG9tZXJTZXJ2aWNlLmFkZFRhZ1RvQ3VzdG9tZXIodGFnLCB2bS5jdXN0b21lci5jdXN0b21lcklkKS50aGVuKCByZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgaWYocmVzcG9uc2Uuc3VjY2VzcykgewogICAgICAgICAgICAgICAgdm0ucmVmcmVzaERhdGEodGFnLCAnYWRkJyk7CiAgICAgICAgICAgICAgICBpZighdm0uYXZhaWxhYmxlVGFncy5pbmNsdWRlcyh0YWcpKSB2bS5hdmFpbGFibGVUYWdzLnB1c2godGFnKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgdGhpcy5jbGVhclNlYXJjaCgpOwogICAgICAgICAgICAgIHRoaXMuY2xvc2VNZW51KCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2bS5leGlzdGluZ1RhZyA9IHRhZzsKICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICB2bS5leGlzdGluZ1RhZyA9ICcnCiAgICAgICAgICAgIH0sIDE1MCApCiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh2bS50YWdUeXBlID09ICdsb2NhdGlvbicpIHsKICAgICAgICAgIGlmKHZtLnNlbGVjdGVkTG9jYXRpb24gJiYgdm0uc2VsZWN0ZWRMb2NhdGlvbi50YWdzLmluZGV4T2YodGFnKSA8IDApIHsKICAgICAgICAgICAgTG9jYXRpb25TZXJ2aWNlLmFkZFRhZ1RvTG9jYXRpb24odGFnLCB2bS5sb2NhdGlvbi5sb2NhdGlvbklkKS50aGVuKCByZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgaWYocmVzcG9uc2Uuc3VjY2VzcykgewogICAgICAgICAgICAgICAgdm0ucmVmcmVzaERhdGEodGFnLCAnYWRkJyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHRoaXMuY2xlYXJTZWFyY2goKTsKICAgICAgICAgICAgfSkKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZtLmV4aXN0aW5nVGFnID0gdGFnOwogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgIHZtLmV4aXN0aW5nVGFnID0gJycKICAgICAgICAgICAgfSwgMTUwICkKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICByZW1vdmVUYWcodGFnKSB7CiAgICAgIGxldCB2bSA9IHRoaXM7CiAgICAgIGlmKHZtLnRhZ1R5cGUgPT0gJ2N1c3RvbWVyJykgewogICAgICAgIEN1c3RvbWVyU2VydmljZS5yZW1vdmVUYWdGcm9tQ3VzdG9tZXIodGFnLCB2bS5jdXN0b21lci5jdXN0b21lcklkKS50aGVuKCByZXNwb25zZSA9PiB7CiAgICAgICAgICBpZihyZXNwb25zZS5zdWNjZXNzKSB7CiAgICAgICAgICAgIHZtLnJlZnJlc2hEYXRhKHRhZywgJ3JlbW92ZScpOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5jbGVhclNlYXJjaCgpOwogICAgICAgIH0pCiAgICAgIH0gZWxzZSBpZiAodm0udGFnVHlwZSA9PSAnbG9jYXRpb24nKSB7CiAgICAgICAgTG9jYXRpb25TZXJ2aWNlLnJlbW92ZVRhZ0Zyb21Mb2NhdGlvbih0YWcsIHZtLmxvY2F0aW9uLmxvY2F0aW9uSWQpLnRoZW4oIHJlc3BvbnNlID0+IHsKICAgICAgICAgIGlmKHJlc3BvbnNlLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgdm0ucmVmcmVzaERhdGEodGFnLCAncmVtb3ZlJyk7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmNsZWFyU2VhcmNoKCk7CiAgICAgICAgfSkKICAgICAgfQogICAgfSwKICAgIHJlZnJlc2hEYXRhKHRhZywgdXBkYXRlVHlwZSkgewogICAgICBsZXQgdm0gPSB0aGlzOwogICAgICBpZih2bS50YWdUeXBlID09ICdjdXN0b21lcicpIHsKICAgICAgICBpZih1cGRhdGVUeXBlID09ICdhZGQnKSB7CiAgICAgICAgICB2bS5jdXN0b21lci50YWdzLnB1c2godGFnKTsKICAgICAgICB9IGVsc2UgaWYgKHVwZGF0ZVR5cGUgPT0gJ3JlbW92ZScpIHsKICAgICAgICAgIHZtLmN1c3RvbWVyLnRhZ3Muc3BsaWNlKHZtLmN1c3RvbWVyLnRhZ3MuaW5kZXhPZih0YWcpLCAxKQogICAgICAgICAgfQogICAgICAgIHZtLmFsbFRhZ3MgPSB2bS5jdXN0b21lci50YWdzLnNvcnQoKTsKICAgICAgfSBlbHNlIGlmKHZtLnRhZ1R5cGUgPT0gJ2xvY2F0aW9uJykgewogICAgICAgIGlmKHVwZGF0ZVR5cGUgPT0gJ2FkZCcpIHsKICAgICAgICAgIHZtLmxvY2F0aW9uLnRhZ3MucHVzaCh0YWcpOwogICAgICAgIH0gZWxzZSBpZiAodXBkYXRlVHlwZSA9PSAncmVtb3ZlJykgewogICAgICAgICAgdm0ubG9jYXRpb24udGFncy5zcGxpY2Uodm0ubG9jYXRpb24udGFncy5pbmRleE9mKHRhZyksIDEpCiAgICAgICAgfQogICAgICAgIHZtLmFsbFRhZ3MgPSB2bS5sb2NhdGlvbi50YWdzLnNvcnQoKTsKICAgICAgfQogICAgfSwKICAgIHNob3dNZW51KCkgewogICAgICB0aGlzLm1lbnVPcGVuID0gdHJ1ZTsKICAgIH0sCiAgICBjbG9zZU1lbnUoKSB7CiAgICAgIHRoaXMuc2VhcmNoVGV4dCA9ICcnOwogICAgICB0aGlzLm1lbnVPcGVuID0gZmFsc2U7CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["Autocomplete.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Autocomplete.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"autocomplete-container\" >\n    <div class=\"search-container\">\n      <input type=\"text\" ref=\"search\" v-model=\"searchText\" @click=\"showMenu\" @keyup.enter=\"addTag(searchText)\" placeholder=\"Add New Tag\">\n      <!-- <i class=\"fal fa-times\" @click=\"clearSearch()\"></i> -->\n    </div>\n    <div class=\"results-display\" v-if=\"searchText && tagType == 'customer' || (tagType == 'customer' && menuOpen)\" >\n      <div class=\"results-line\" :class=\"{'already-tagged': selectedCustomer.tags.includes(tag), 'flash-existing': existingTag == tag}\" v-for=\"tag in filteredTags\"  @click=\"addTag(tag)\">\n        <span>{{tag}}</span>\n      </div>\n      <span style=\"margin: 20px;\" v-if=\"filteredTags && filteredTags.length < 1\">No suggested tags</span>\n    </div>\n    <div class=\"results-display\" v-if=\"menuOpen && tagType == 'location'\" >\n      <div class=\"results-line\" v-for=\"tag in filteredTags\" @click=\"addTag(tag)\">\n        <span >{{tag}}</span>\n      </div>\n      <span v-if=\"filteredTags && filteredTags.length <1\">No suggested tags</span>\n    </div>\n    <div class=\"tags-container hide-scroll\" >\n      <div class=\"existing-tag\" v-for=\"currentTag in allTags\">\n        <span> {{currentTag}} </span>\n        <i class='fal fa-times' @click=\"removeTag(currentTag)\"></i>\n      </div>\n    </div>\n  </div>\n</template>\n\n\n<script>\nimport CustomerService from './../services/CustomerService.js';\nimport LocationService from './../services/LocationService.js';\nvar lookupTable = require('./Tables/autocompletetable.js');\n\nexport default {\n  name: 'autocomplete',\n  props: [\"type\", \"selectedCustomer\", \"selectedLocation\"],\n  data: function() {\n    return {\n      searchText: '',\n      tagType: '',\n      customer: {},\n      location: {},\n      allTags: [],\n      menuOpen: false,\n      test: true,\n      selectedTag: '',\n      existingTag: '',\n      availableTags: [],\n      matchFound: false\n    };\n  },\n  created() {\n    this.tagType = this.type;\n    \n    if(this.selectedCustomer) {\n      this.findTagOptions();\n      if(!this.selectedCustomer.tags) this.selectedCustomer.tags = [];\n      this.customer = this.selectedCustomer;\n      if(this.customer.tags && this.customer.tags.length > 0) this.allTags = this.customer.tags.sort();\n    }\n    if(this.selectedLocation) {\n      this.location = this.selectedLocation;\n      if(!this.location.tags) this.location.tags = [];\n      if(this.location.tags && this.location.tags.length > 0) this.allTags = this.location.tags.sort();\n    }\n  },\n  computed: {\n    filteredTags() {\n      var vm = this;\n      vm.matchFound = false;\n      if(vm.tagType == 'customer') {\n        if(vm.availableTags){\n          var custTable = vm.availableTags.filter(el => {\n            if(vm.searchText) {\n              if(vm.searchText.toLowerCase() == el.toLowerCase()) {\n                vm.matchFound = true;\n            }\n            return vm.checkFuzzy(el);            \n          } else {\n            return el;\n          }\n        })\n      }\n        return custTable;\n      } else if (vm.tagType == 'location') {\n        var locTable = lookupTable.locationTags.filter(el => {\n          if(el && vm.searchText) {\n            return vm.checkFuzzy(el);            \n          } else {\n            return el;\n          }\n        })\n        return locTable;\n      }\n    }\n  },\n  methods: {\n    checkFuzzy(tag) {\n      if(tag) {\n        let vm = this;\n        let lcTag = tag.toLowerCase();\n        let lcSearch = vm.searchText.toLowerCase();\n        var costs = new Array();\n        for (var i = 0; i <= lcTag.length; i++) {\n          var lastValue = i;\n          for (var j = 0; j <= lcSearch.length; j++) {\n            if (i == 0)\n              costs[j] = j;\n            else {\n              if (j > 0) {\n                var newValue = costs[j - 1];\n                if (lcTag.charAt(i - 1) != lcSearch.charAt(j - 1))\n                  newValue = Math.min(Math.min(newValue, lastValue),\n                    costs[j]) + 1;\n                costs[j - 1] = lastValue;\n                lastValue = newValue;\n              }\n            }\n          }\n          if (i > 0)\n            costs[lcSearch.length] = lastValue;\n        }\n        let distance = costs[lcSearch.length]\n        // If there is a matchfound, but the tag being checked isn't it, return false.\n        if(vm.matchFound && lcTag != lcSearch) {\n          return false;\n        }\n        // If the tag includes the search, but isn't an exact match, keep it.\n        else if(lcTag.includes(lcSearch)) {\n          return true;\n        }\n        // If the tag is within 1 edit distance, but a match hasn't been found, keep it.\n        else if(distance <=1 ) {\n          return true\n        }\n        else {\n          return false;\n        }\n      } else {\n        return false;\n      }\n    },\n    findTagOptions() {\n      let vm = this;\n      let searchObject = {};\n      let locationIdArray = [];\n      let locationId = localStorage.getItem('locationId');\n      if(locationId) {\n        locationIdArray.push(locationId);\n      } else {\n        let locOptions = JSON.parse(localStorage.getItem('locationOptions'));\n        locOptions.map(el => locationIdArray.push(el.locationId));\n      }\n      searchObject.locations = locationIdArray;\n      LocationService.getAvailableCustomerTags(searchObject).then(response => {\n        if(response && response.sortedTags) {\n          vm.availableTags = response.sortedTags;\n        }\n      })\n    },\n    clearSearch() {\n      this.searchText = '';\n      this.$refs.search.focus();\n    },\n    addTag(tag) {\n      let vm = this;\n      if(tag) {\n        if(vm.tagType == 'customer') {\n          if(vm.selectedCustomer.tags.indexOf(tag) < 0) {\n            CustomerService.addTagToCustomer(tag, vm.customer.customerId).then( response => {\n              if(response.success) {\n                vm.refreshData(tag, 'add');\n                if(!vm.availableTags.includes(tag)) vm.availableTags.push(tag);\n              }\n              this.clearSearch();\n              this.closeMenu();\n            })\n          } else {\n            vm.existingTag = tag;\n            setTimeout(function() {\n              vm.existingTag = ''\n            }, 150 )\n          }\n        } else if (vm.tagType == 'location') {\n          if(vm.selectedLocation && vm.selectedLocation.tags.indexOf(tag) < 0) {\n            LocationService.addTagToLocation(tag, vm.location.locationId).then( response => {\n              if(response.success) {\n                vm.refreshData(tag, 'add');\n              }\n              this.clearSearch();\n            })\n          } else {\n            vm.existingTag = tag;\n            setTimeout(function() {\n              vm.existingTag = ''\n            }, 150 )\n          }\n        }\n      }\n    },\n    removeTag(tag) {\n      let vm = this;\n      if(vm.tagType == 'customer') {\n        CustomerService.removeTagFromCustomer(tag, vm.customer.customerId).then( response => {\n          if(response.success) {\n            vm.refreshData(tag, 'remove');\n          }\n          this.clearSearch();\n        })\n      } else if (vm.tagType == 'location') {\n        LocationService.removeTagFromLocation(tag, vm.location.locationId).then( response => {\n          if(response.success) {\n            vm.refreshData(tag, 'remove');\n          }\n          this.clearSearch();\n        })\n      }\n    },\n    refreshData(tag, updateType) {\n      let vm = this;\n      if(vm.tagType == 'customer') {\n        if(updateType == 'add') {\n          vm.customer.tags.push(tag);\n        } else if (updateType == 'remove') {\n          vm.customer.tags.splice(vm.customer.tags.indexOf(tag), 1)\n          }\n        vm.allTags = vm.customer.tags.sort();\n      } else if(vm.tagType == 'location') {\n        if(updateType == 'add') {\n          vm.location.tags.push(tag);\n        } else if (updateType == 'remove') {\n          vm.location.tags.splice(vm.location.tags.indexOf(tag), 1)\n        }\n        vm.allTags = vm.location.tags.sort();\n      }\n    },\n    showMenu() {\n      this.menuOpen = true;\n    },\n    closeMenu() {\n      this.searchText = '';\n      this.menuOpen = false;\n    }\n  }\n}\n</script>\n\n\n<style scoped>\n\n.search-container {\n  width: 250px;\n  border: 1px solid lightgrey;\n  border-radius: 3px;\n  margin: 0 5px 10px 0;\n}\n\n.search-container input {\n  margin: 0;\n  border-bottom: none;\n  width: 180px;\n  font-size: 18px;\n}\n\n.results-display {\n  position: absolute;\n  height: 100px;\n  width: 250px;\n  border: 1px solid lightgrey;\n  box-shadow: 2px 2px rgba(211, 211, 211, .35);\n  transform: translate(0px, -10px);\n  background: white;\n  overflow-y: scroll;\n  z-index: 999;\n}\n\n.results-line {\n  padding: 10px;\n}\n\n.results-line:hover {\n  background: rgb(233, 232, 232);\n  cursor: pointer;\n}\n\n.already-tagged:hover {\n  color: rgb(119, 60, 60);\n}\n\n.search-container .fa-times {\n  font-size: 18px;\n  margin-left: 4px;\n  transform: translateY(5px);\n  cursor: pointer;\n  color: grey;\n}\n\n.tags-container {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  max-height: 116px;\n}\n\n.existing-tag {\n  min-width: 35px;\n  min-height: 25px;\n  margin: 0 10px 5px 0;\n  border: 1px solid rgb(33, 102, 206);\n  border-radius: 25px;\n  padding: 0px 10px;\n  display: flex;\n  color: rgb(33, 102, 206);\n  font-size: 14px;\n  display: flex;\n  font-weight: 450;\n  flex-direction: row;\n  align-content: center;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.existing-tag .fa-times {\n  margin-left: 5px;\n  transform: translateY(1px);\n  color: rgb(33, 102, 206);\n  cursor: pointer;\n}\n\n.flash-existing {\n  background: rgba(255, 104, 104, .3);\n}\n\n.flash-existing:hover {\n  background: rgba(255, 104, 104, .3);\n}\n\n.fa-plus {\n  color: #4fcbc5;\n  cursor: pointer;\n}\n\n</style>\n"]}]}