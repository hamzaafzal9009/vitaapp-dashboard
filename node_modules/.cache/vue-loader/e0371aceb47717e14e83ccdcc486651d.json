{"remainingRequest":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/src/components/Autocomplete.vue?vue&type=style&index=0&id=e7c95fd0&scoped=true&lang=css&","dependencies":[{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/src/components/Autocomplete.vue","mtime":1581270622000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5zZWFyY2gtY29udGFpbmVyIHsKICB3aWR0aDogMjUwcHg7CiAgYm9yZGVyOiAxcHggc29saWQgbGlnaHRncmV5OwogIGJvcmRlci1yYWRpdXM6IDNweDsKICBtYXJnaW46IDAgNXB4IDEwcHggMDsKfQoKLnNlYXJjaC1jb250YWluZXIgaW5wdXQgewogIG1hcmdpbjogMDsKICBib3JkZXItYm90dG9tOiBub25lOwogIHdpZHRoOiAxODBweDsKICBmb250LXNpemU6IDE4cHg7Cn0KCi5yZXN1bHRzLWRpc3BsYXkgewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICBoZWlnaHQ6IDEwMHB4OwogIHdpZHRoOiAyNTBweDsKICBib3JkZXI6IDFweCBzb2xpZCBsaWdodGdyZXk7CiAgYm94LXNoYWRvdzogMnB4IDJweCByZ2JhKDIxMSwgMjExLCAyMTEsIC4zNSk7CiAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoMHB4LCAtMTBweCk7CiAgYmFja2dyb3VuZDogd2hpdGU7CiAgb3ZlcmZsb3cteTogc2Nyb2xsOwogIHotaW5kZXg6IDk5OTsKfQoKLnJlc3VsdHMtbGluZSB7CiAgcGFkZGluZzogMTBweDsKfQoKLnJlc3VsdHMtbGluZTpob3ZlciB7CiAgYmFja2dyb3VuZDogcmdiKDIzMywgMjMyLCAyMzIpOwogIGN1cnNvcjogcG9pbnRlcjsKfQoKLmFscmVhZHktdGFnZ2VkOmhvdmVyIHsKICBjb2xvcjogcmdiKDExOSwgNjAsIDYwKTsKfQoKLnNlYXJjaC1jb250YWluZXIgLmZhLXRpbWVzIHsKICBmb250LXNpemU6IDE4cHg7CiAgbWFyZ2luLWxlZnQ6IDRweDsKICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoNXB4KTsKICBjdXJzb3I6IHBvaW50ZXI7CiAgY29sb3I6IGdyZXk7Cn0KCi50YWdzLWNvbnRhaW5lciB7CiAgZGlzcGxheTogZmxleDsKICBmbGV4LWRpcmVjdGlvbjogcm93OwogIGZsZXgtd3JhcDogd3JhcDsKICBtYXgtaGVpZ2h0OiAxMTZweDsKfQoKLmV4aXN0aW5nLXRhZyB7CiAgbWluLXdpZHRoOiAzNXB4OwogIG1pbi1oZWlnaHQ6IDI1cHg7CiAgbWFyZ2luOiAwIDEwcHggNXB4IDA7CiAgYm9yZGVyOiAxcHggc29saWQgcmdiKDMzLCAxMDIsIDIwNik7CiAgYm9yZGVyLXJhZGl1czogMjVweDsKICBwYWRkaW5nOiAwcHggMTBweDsKICBkaXNwbGF5OiBmbGV4OwogIGNvbG9yOiByZ2IoMzMsIDEwMiwgMjA2KTsKICBmb250LXNpemU6IDE0cHg7CiAgZGlzcGxheTogZmxleDsKICBmb250LXdlaWdodDogNDUwOwogIGZsZXgtZGlyZWN0aW9uOiByb3c7CiAgYWxpZ24tY29udGVudDogY2VudGVyOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwp9CgouZXhpc3RpbmctdGFnIC5mYS10aW1lcyB7CiAgbWFyZ2luLWxlZnQ6IDVweDsKICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMXB4KTsKICBjb2xvcjogcmdiKDMzLCAxMDIsIDIwNik7CiAgY3Vyc29yOiBwb2ludGVyOwp9CgouZmxhc2gtZXhpc3RpbmcgewogIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAxMDQsIDEwNCwgLjMpOwp9CgouZmxhc2gtZXhpc3Rpbmc6aG92ZXIgewogIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAxMDQsIDEwNCwgLjMpOwp9CgouZmEtcGx1cyB7CiAgY29sb3I6ICM0ZmNiYzU7CiAgY3Vyc29yOiBwb2ludGVyOwp9Cgo="},{"version":3,"sources":["Autocomplete.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0PA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Autocomplete.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"autocomplete-container\" >\n    <div class=\"search-container\">\n      <input type=\"text\" ref=\"search\" v-model=\"searchText\" @click=\"showMenu\" @keyup.enter=\"addTag(searchText)\" placeholder=\"Add New Tag\">\n      <!-- <i class=\"fal fa-times\" @click=\"clearSearch()\"></i> -->\n    </div>\n    <div class=\"results-display\" v-if=\"searchText && tagType == 'customer' || (tagType == 'customer' && menuOpen)\" >\n      <div class=\"results-line\" :class=\"{'already-tagged': selectedCustomer.tags.includes(tag), 'flash-existing': existingTag == tag}\" v-for=\"tag in filteredTags\"  @click=\"addTag(tag)\">\n        <span>{{tag}}</span>\n      </div>\n      <span style=\"margin: 20px;\" v-if=\"filteredTags && filteredTags.length < 1\">No suggested tags</span>\n    </div>\n    <div class=\"results-display\" v-if=\"menuOpen && tagType == 'location'\" >\n      <div class=\"results-line\" v-for=\"tag in filteredTags\" @click=\"addTag(tag)\">\n        <span >{{tag}}</span>\n      </div>\n      <span v-if=\"filteredTags && filteredTags.length <1\">No suggested tags</span>\n    </div>\n    <div class=\"tags-container hide-scroll\" >\n      <div class=\"existing-tag\" v-for=\"currentTag in allTags\">\n        <span> {{currentTag}} </span>\n        <i class='fal fa-times' @click=\"removeTag(currentTag)\"></i>\n      </div>\n    </div>\n  </div>\n</template>\n\n\n<script>\nimport CustomerService from './../services/CustomerService.js';\nimport LocationService from './../services/LocationService.js';\nvar lookupTable = require('./Tables/autocompletetable.js');\n\nexport default {\n  name: 'autocomplete',\n  props: [\"type\", \"selectedCustomer\", \"selectedLocation\"],\n  data: function() {\n    return {\n      searchText: '',\n      tagType: '',\n      customer: {},\n      location: {},\n      allTags: [],\n      menuOpen: false,\n      test: true,\n      selectedTag: '',\n      existingTag: '',\n      availableTags: [],\n      matchFound: false\n    };\n  },\n  created() {\n    this.tagType = this.type;\n    \n    if(this.selectedCustomer) {\n      this.findTagOptions();\n      if(!this.selectedCustomer.tags) this.selectedCustomer.tags = [];\n      this.customer = this.selectedCustomer;\n      if(this.customer.tags && this.customer.tags.length > 0) this.allTags = this.customer.tags.sort();\n    }\n    if(this.selectedLocation) {\n      this.location = this.selectedLocation;\n      if(!this.location.tags) this.location.tags = [];\n      if(this.location.tags && this.location.tags.length > 0) this.allTags = this.location.tags.sort();\n    }\n  },\n  computed: {\n    filteredTags() {\n      var vm = this;\n      vm.matchFound = false;\n      if(vm.tagType == 'customer') {\n        if(vm.availableTags){\n          var custTable = vm.availableTags.filter(el => {\n            if(vm.searchText) {\n              if(vm.searchText.toLowerCase() == el.toLowerCase()) {\n                vm.matchFound = true;\n            }\n            return vm.checkFuzzy(el);            \n          } else {\n            return el;\n          }\n        })\n      }\n        return custTable;\n      } else if (vm.tagType == 'location') {\n        var locTable = lookupTable.locationTags.filter(el => {\n          if(el && vm.searchText) {\n            return vm.checkFuzzy(el);            \n          } else {\n            return el;\n          }\n        })\n        return locTable;\n      }\n    }\n  },\n  methods: {\n    checkFuzzy(tag) {\n      if(tag) {\n        let vm = this;\n        let lcTag = tag.toLowerCase();\n        let lcSearch = vm.searchText.toLowerCase();\n        var costs = new Array();\n        for (var i = 0; i <= lcTag.length; i++) {\n          var lastValue = i;\n          for (var j = 0; j <= lcSearch.length; j++) {\n            if (i == 0)\n              costs[j] = j;\n            else {\n              if (j > 0) {\n                var newValue = costs[j - 1];\n                if (lcTag.charAt(i - 1) != lcSearch.charAt(j - 1))\n                  newValue = Math.min(Math.min(newValue, lastValue),\n                    costs[j]) + 1;\n                costs[j - 1] = lastValue;\n                lastValue = newValue;\n              }\n            }\n          }\n          if (i > 0)\n            costs[lcSearch.length] = lastValue;\n        }\n        let distance = costs[lcSearch.length]\n        // If there is a matchfound, but the tag being checked isn't it, return false.\n        if(vm.matchFound && lcTag != lcSearch) {\n          return false;\n        }\n        // If the tag includes the search, but isn't an exact match, keep it.\n        else if(lcTag.includes(lcSearch)) {\n          return true;\n        }\n        // If the tag is within 1 edit distance, but a match hasn't been found, keep it.\n        else if(distance <=1 ) {\n          return true\n        }\n        else {\n          return false;\n        }\n      } else {\n        return false;\n      }\n    },\n    findTagOptions() {\n      let vm = this;\n      let searchObject = {};\n      let locationIdArray = [];\n      let locationId = localStorage.getItem('locationId');\n      if(locationId) {\n        locationIdArray.push(locationId);\n      } else {\n        let locOptions = JSON.parse(localStorage.getItem('locationOptions'));\n        locOptions.map(el => locationIdArray.push(el.locationId));\n      }\n      searchObject.locations = locationIdArray;\n      LocationService.getAvailableCustomerTags(searchObject).then(response => {\n        if(response && response.sortedTags) {\n          vm.availableTags = response.sortedTags;\n        }\n      })\n    },\n    clearSearch() {\n      this.searchText = '';\n      this.$refs.search.focus();\n    },\n    addTag(tag) {\n      let vm = this;\n      if(tag) {\n        if(vm.tagType == 'customer') {\n          if(vm.selectedCustomer.tags.indexOf(tag) < 0) {\n            CustomerService.addTagToCustomer(tag, vm.customer.customerId).then( response => {\n              if(response.success) {\n                vm.refreshData(tag, 'add');\n                if(!vm.availableTags.includes(tag)) vm.availableTags.push(tag);\n              }\n              this.clearSearch();\n              this.closeMenu();\n            })\n          } else {\n            vm.existingTag = tag;\n            setTimeout(function() {\n              vm.existingTag = ''\n            }, 150 )\n          }\n        } else if (vm.tagType == 'location') {\n          if(vm.selectedLocation && vm.selectedLocation.tags.indexOf(tag) < 0) {\n            LocationService.addTagToLocation(tag, vm.location.locationId).then( response => {\n              if(response.success) {\n                vm.refreshData(tag, 'add');\n              }\n              this.clearSearch();\n            })\n          } else {\n            vm.existingTag = tag;\n            setTimeout(function() {\n              vm.existingTag = ''\n            }, 150 )\n          }\n        }\n      }\n    },\n    removeTag(tag) {\n      let vm = this;\n      if(vm.tagType == 'customer') {\n        CustomerService.removeTagFromCustomer(tag, vm.customer.customerId).then( response => {\n          if(response.success) {\n            vm.refreshData(tag, 'remove');\n          }\n          this.clearSearch();\n        })\n      } else if (vm.tagType == 'location') {\n        LocationService.removeTagFromLocation(tag, vm.location.locationId).then( response => {\n          if(response.success) {\n            vm.refreshData(tag, 'remove');\n          }\n          this.clearSearch();\n        })\n      }\n    },\n    refreshData(tag, updateType) {\n      let vm = this;\n      if(vm.tagType == 'customer') {\n        if(updateType == 'add') {\n          vm.customer.tags.push(tag);\n        } else if (updateType == 'remove') {\n          vm.customer.tags.splice(vm.customer.tags.indexOf(tag), 1)\n          }\n        vm.allTags = vm.customer.tags.sort();\n      } else if(vm.tagType == 'location') {\n        if(updateType == 'add') {\n          vm.location.tags.push(tag);\n        } else if (updateType == 'remove') {\n          vm.location.tags.splice(vm.location.tags.indexOf(tag), 1)\n        }\n        vm.allTags = vm.location.tags.sort();\n      }\n    },\n    showMenu() {\n      this.menuOpen = true;\n    },\n    closeMenu() {\n      this.searchText = '';\n      this.menuOpen = false;\n    }\n  }\n}\n</script>\n\n\n<style scoped>\n\n.search-container {\n  width: 250px;\n  border: 1px solid lightgrey;\n  border-radius: 3px;\n  margin: 0 5px 10px 0;\n}\n\n.search-container input {\n  margin: 0;\n  border-bottom: none;\n  width: 180px;\n  font-size: 18px;\n}\n\n.results-display {\n  position: absolute;\n  height: 100px;\n  width: 250px;\n  border: 1px solid lightgrey;\n  box-shadow: 2px 2px rgba(211, 211, 211, .35);\n  transform: translate(0px, -10px);\n  background: white;\n  overflow-y: scroll;\n  z-index: 999;\n}\n\n.results-line {\n  padding: 10px;\n}\n\n.results-line:hover {\n  background: rgb(233, 232, 232);\n  cursor: pointer;\n}\n\n.already-tagged:hover {\n  color: rgb(119, 60, 60);\n}\n\n.search-container .fa-times {\n  font-size: 18px;\n  margin-left: 4px;\n  transform: translateY(5px);\n  cursor: pointer;\n  color: grey;\n}\n\n.tags-container {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  max-height: 116px;\n}\n\n.existing-tag {\n  min-width: 35px;\n  min-height: 25px;\n  margin: 0 10px 5px 0;\n  border: 1px solid rgb(33, 102, 206);\n  border-radius: 25px;\n  padding: 0px 10px;\n  display: flex;\n  color: rgb(33, 102, 206);\n  font-size: 14px;\n  display: flex;\n  font-weight: 450;\n  flex-direction: row;\n  align-content: center;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.existing-tag .fa-times {\n  margin-left: 5px;\n  transform: translateY(1px);\n  color: rgb(33, 102, 206);\n  cursor: pointer;\n}\n\n.flash-existing {\n  background: rgba(255, 104, 104, .3);\n}\n\n.flash-existing:hover {\n  background: rgba(255, 104, 104, .3);\n}\n\n.fa-plus {\n  color: #4fcbc5;\n  cursor: pointer;\n}\n\n</style>\n"]}]}