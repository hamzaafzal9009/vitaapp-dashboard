{"remainingRequest":"/Library/WebServer/Documents/Projects/Vite Dashboard/node_modules/vue-loader/lib/index.js??vue-loader-options!/Library/WebServer/Documents/Projects/Vite Dashboard/src/components/DashboardComponents/OpiniionRating.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Library/WebServer/Documents/Projects/Vite Dashboard/src/components/DashboardComponents/OpiniionRating.vue","mtime":1581270622000},{"path":"/Library/WebServer/Documents/Projects/Vite Dashboard/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/Projects/Vite Dashboard/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/Projects/Vite Dashboard/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/Projects/Vite Dashboard/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBEYXNoYm9hcmRTZXJ2aWNlIGZyb20gJy4vLi4vLi4vc2VydmljZXMvRGFzaGJvYXJkU2VydmljZScKaW1wb3J0IHtFdmVudFNlcnZpY2V9IGZyb20gJy4uLy4uL21haW4nCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ29waW5paW9uUmF0aW5nJywKICBkYXRhOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiB7CiAgICAgIGNhcmREYXRhOiAwLAogICAgICB0aW1lZnJhbWU6IDMwLAogICAgICBzaG93TG9hZGluZzogdHJ1ZQogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0RGF0YSgpOwogICAgRXZlbnRTZXJ2aWNlLiRvbignbG9jYXRpb25DaGFuZ2UnLCB0aGlzLmdldERhdGEpOwogIH0sCiAgYmVmb3JlRGVzdHJveTogZnVuY3Rpb24gKCkgewogICAgRXZlbnRTZXJ2aWNlLiRvZmYoJ2xvY2F0aW9uQ2hhbmdlJywgdGhpcy5nZXREYXRhKTsKICB9LAogIGZpbHRlcnM6IHsKICAgIGZvcm1hdE51bSh2YWx1ZSkgewogICAgICBsZXQgdmFsID0gKHZhbHVlLzEpLnRvRml4ZWQoMCkucmVwbGFjZSgnLicsICcsJykKICAgICAgcmV0dXJuIHZhbC50b1N0cmluZygpLnJlcGxhY2UoL1xCKD89KFxkezN9KSsoPyFcZCkpL2csICIsIikKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGZvbGxvd0xpbmsodGFyZ2V0UGFnZSkgewogICAgICB0cnkgewogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwYXNzZWRGaWx0ZXJzJywgSlNPTi5zdHJpbmdpZnkoe25hbWU6ICdzb3VyY2UnLCB2YWx1ZTogWydPcGluaWlvbiddfSkpOyAgCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICB9CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHRhcmdldFBhZ2UpOwogICAgfSwKICAgIGNoYW5nZVRpbWVmcmFtZSh0aW1lKSB7CiAgICAgIHRoaXMudGltZWZyYW1lID0gdGltZTsKICAgICAgdGhpcy5nZXREYXRhKCk7CiAgICB9LAogICAgY2hlY2tGb3JTZWxlY3RlZChjb21tYW5kKSB7CiAgICAgIGxldCB2bSA9IHRoaXM7CiAgICAgIGlmKGNvbW1hbmQgPT0gdm0udGltZWZyYW1lKSB7CiAgICAgICAgcmV0dXJuICdlbC1pY29uLWNoZWNrJwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQogICAgfSwKICAgIGdldERhdGEoKSB7CiAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlOwogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICBsZXQgbG9jYXRpb25JZEFycmF5ID0gW107CiAgICAgIGxldCBsb2NhdGlvbklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2xvY2F0aW9uSWQnKTsKICAgICAgaWYobG9jYXRpb25JZCkgewogICAgICAgIGxvY2F0aW9uSWRBcnJheS5wdXNoKGxvY2F0aW9uSWQpOwogICAgICB9IGVsc2UgewogICAgICAgIGxldCBsb2NPcHRpb25zID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbG9jYXRpb25PcHRpb25zJykpOwogICAgICAgIGxvY09wdGlvbnMubWFwKGVsID0+IGxvY2F0aW9uSWRBcnJheS5wdXNoKGVsLmxvY2F0aW9uSWQpKTsKICAgICAgfQoKICAgICAgbGV0IHNlYXJjaE9iamVjdCA9IHsKICAgICAgICBsb2NhdGlvbnM6IGxvY2F0aW9uSWRBcnJheSwKICAgICAgICB0aW1lZnJhbWU6IHZtLnRpbWVmcmFtZQogICAgICB9CiAgICAgIAogICAgICBEYXNoYm9hcmRTZXJ2aWNlLmdldE9waW5paW9uUmF0aW5nKHNlYXJjaE9iamVjdCkudGhlbihmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgIHZtLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgaWYgKHJlc3BvbnNlLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHZtLmNhcmREYXRhID0gcmVzcG9uc2VbMF0uYXZlcmFnZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdm0uY2FyZERhdGEgPSAwOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["OpiniionRating.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"OpiniionRating.vue","sourceRoot":"src/components/DashboardComponents","sourcesContent":["<template>\n  <el-card shadow=\"always\" class=\"short-card\">\n    <el-row>\n      <el-col :span=\"12\">\n        <div class=\"o-card-title-3 clickable\" @click=\"followLink('/feedback')\">        \n          Opiniion Rating\n        </div>\n        <div class=\"o-card-data\" v-show=\"!showLoading && cardData >= 0\">\n          {{ cardData.toFixed(1) }}\n        </div>\n        <div class=\"dashboard-row dashboard-loader\" v-show=\"showLoading\"><i class=\"far fa-hourglass fa-spin\"></i></div>\n      </el-col>\n      <el-col :span=\"11\">\n        <div class=\"o-card-icon\">\n          <img src=\"../../../public/img/Opiniion_Icon.png\" alt=\"Opiniion Rating\" />\n        </div>\n      </el-col>\n      <el-col :span=\"1\">\n        <el-dropdown trigger=\"click\" @command=\"changeTimeframe\">\n          <span class=\"opiniion-grey el-dropdown-link\">\n            <i class=\"fa fa-ellipsis-v clickable\" aria-hidden=\"true\"></i>\n          </span>\n          <el-dropdown-menu slot=\"dropdown\">\n            <el-dropdown-item :icon=\"checkForSelected('always')\" command=\"always\">All time</el-dropdown-item>\n            <el-dropdown-item :icon=\"checkForSelected(30)\" :command=\"30\">Last 30 days</el-dropdown-item>\n            <el-dropdown-item :icon=\"checkForSelected(120)\" :command=\"120\">Last 3 months</el-dropdown-item>\n            <el-dropdown-item :icon=\"checkForSelected(240)\" :command=\"240\">Last 6 months</el-dropdown-item>\n            <el-dropdown-item :icon=\"checkForSelected(365)\" :command=\"365\">In the last year</el-dropdown-item>\n          </el-dropdown-menu>\n        </el-dropdown>\n      </el-col>\n    </el-row>\n  </el-card>\n</template>\n\n<script>\nimport DashboardService from './../../services/DashboardService'\nimport {EventService} from '../../main'\n\nexport default {\n  name: 'opiniionRating',\n  data: function() {\n    return {\n      cardData: 0,\n      timeframe: 30,\n      showLoading: true\n    }\n  },\n  created() {\n    this.getData();\n    EventService.$on('locationChange', this.getData);\n  },\n  beforeDestroy: function () {\n    EventService.$off('locationChange', this.getData);\n  },\n  filters: {\n    formatNum(value) {\n      let val = (value/1).toFixed(0).replace('.', ',')\n      return val.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\")\n    }\n  },\n  methods: {\n    followLink(targetPage) {\n      try {\n        localStorage.setItem('passedFilters', JSON.stringify({name: 'source', value: ['Opiniion']}));  \n      } catch (error) {\n        console.log(error);\n      }\n      this.$router.push(targetPage);\n    },\n    changeTimeframe(time) {\n      this.timeframe = time;\n      this.getData();\n    },\n    checkForSelected(command) {\n      let vm = this;\n      if(command == vm.timeframe) {\n        return 'el-icon-check'\n      } else {\n        return '';\n      }\n    },\n    getData() {\n      this.showLoading = true;\n      var vm = this;\n      let locationIdArray = [];\n      let locationId = localStorage.getItem('locationId');\n      if(locationId) {\n        locationIdArray.push(locationId);\n      } else {\n        let locOptions = JSON.parse(localStorage.getItem('locationOptions'));\n        locOptions.map(el => locationIdArray.push(el.locationId));\n      }\n\n      let searchObject = {\n        locations: locationIdArray,\n        timeframe: vm.timeframe\n      }\n      \n      DashboardService.getOpiniionRating(searchObject).then(function(response) {\n        vm.showLoading = false;\n        if (response.length > 0) {\n          vm.cardData = response[0].average;\n        } else {\n          vm.cardData = 0;\n        }\n      });\n    }\n  }\n}\n</script>\n\n<style scoped>\n\n</style>"]}]}