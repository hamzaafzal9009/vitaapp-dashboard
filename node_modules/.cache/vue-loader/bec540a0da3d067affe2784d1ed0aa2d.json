{"remainingRequest":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/src/components/AddUser.vue?vue&type=style&index=0&id=4be8ec0c&scoped=true&lang=css&","dependencies":[{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/src/components/AddUser.vue","mtime":1581270622000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hamzaafzal/OLD DATA/Mac Home/vueJS/OPINIION FINAL/opiniionv4/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5jb250ZW50LWNvbnRhaW5lciB7CiAgbWFyZ2luOiBhdXRvOwogIHdpZHRoOiAxMDAlOwp9Ci51c2VyLWlucHV0cyB7CiAgbWFyZ2luLXRvcDogMjBweDsKICBtYXgtaGVpZ2h0OiA0MDBweDsKfQouZWwtYnV0dG9uIHsKICB3aWR0aDogMjYwcHg7Cn0KLnNlbGVjdC1sYWJlbCB7CiAgcGFkZGluZy1sZWZ0OiAxMHB4Owp9Cgouc2Nyb2xsZWQgewogIG92ZXJmbG93LXk6IGF1dG87CiAgb3ZlcmZsb3cteDogaGlkZGVuOwp9Ci5lbC1kaWFsb2dfX2JvZHkgewogIHdpZHRoOiAzMDBweDsKICBtYXJnaW46IGF1dG87Cn0KLmVsLWRpYWxvZyAuZWwtZGlhbG9nX19oZWFkZXIgewogIHBhZGRpbmc6IDA7Cn0KLnVzZXItaW5mbyB7CiAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xMDAlKTsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgY29sb3I6ICM5YTlhOWE7Cn0KLmFkZC1pdGVtIHsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogY2VudGVyOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgYmFja2dyb3VuZDogI2ZhZmFmYTsKICBoZWlnaHQ6IDQwcHg7CiAgYm9yZGVyOiAxcHggc29saWQgIzlhOWE5YTM1OwogIGJvcmRlci1yYWRpdXM6IDEycHg7CiAgbWFyZ2luLXRvcDogMjBweDsKICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlOwogIC13ZWJraXQtdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsKICBjdXJzb3I6IHBvaW50ZXI7Cn0KLmFkZC1pdGVtOmhvdmVyIHsKICBiYWNrZ3JvdW5kOiAjZjJmMmYyOwp9Ci5hZGQtaXRlbSA+IGRpdiB7CiAgZGlzcGxheTogZmxleDsKICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOwp9Ci8qIC5kaWFsb2ctdGl0bGUgewogIHdpZHRoOiAxMDAlOwogIGRpc3BsYXk6IGZsZXg7CiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgbWFyZ2luLWJvdHRvbTogMjBweDsKICBtYXJnaW4tdG9wOiAwOwogIGZvbnQtc2l6ZTogMjVweDsKfSAqLwoKLnVzZXItaW5wdXRzIC5pbnB1dC1sYWJlbCB7CiAgZm9udC1zaXplOiAxNHB4OwogIGNvbG9yOiAjOWE5YTlhOwp9CgoudXNlci1pbnB1dHMgLmVsLWlucHV0IHsKICBtYXJnaW4tdG9wOiA1cHg7Cn0KLmVsLWlucHV0X19pbm5lciB7CiAgYmFja2dyb3VuZDogcmVkICFpbXBvcnRhbnQ7Cn0KLnVzZXItaW5mbyB7CiAgbWFyZ2luOiAwIGF1dG87Cn0KCi5zZWxlY3QtbGFiZWwgewogIG1hcmdpbi1ib3R0b206IDEwcHg7CiAgZm9udC13ZWlnaHQ6IDYwMDsKfQoKLnVzZXItaW5wdXRzIC5lbC1zZWxlY3QgewogIG1hcmdpbjogMTVweCA1cHggMHB4IDVweDsKICB3aWR0aDogMTAwJTsKfQoKLmFkZC1idXR0b24gLmVsLWJ1dHRvbiB7CiAgbWFyZ2luLXRvcDogMTBweDsKICB3aWR0aDogMTAwJTsKfQoKLmRpYWxvZy1mb290ZXIgewogIHdpZHRoOiAxMDAlOwp9Cg=="},{"version":3,"sources":["AddUser.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"AddUser.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <el-dialog\n    :title=\"currentTitle\"\n    :width=\"step == 1 ? '600px' : '1000px'\"\n    center\n    :show-close=\"false\"\n    :visible.sync=\"openedModal\"\n    :before-close=\"closeModal\"\n  >\n    <div\n      v-show=\"step == 2\"\n      class=\"user-info\"\n    >{{user.firstName + ' ' + user.lastName + ' - ' + user.email}}</div>\n    <div class=\"user-inputs\" v-if=\"step == 1\">\n      <el-form :model=\"user\" ref=\"userForm\" :rules=\"userRules\">\n        <el-row :gutter=\"20\" type=\"flex\" class=\"row-bg\">\n          <el-col :span=\"12\">\n            <label class=\"input-label\">First Name</label>\n            <el-form-item prop=\"firstName\">\n              <el-input v-model=\"user.firstName\"></el-input>\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"12\">\n            <label class=\"input-label\">Last Name</label>\n            <el-form-item prop=\"lastName\">\n              <el-input v-model=\"user.lastName\"></el-input>\n            </el-form-item>\n          </el-col>\n        </el-row>\n        <el-row type=\"flex\" class=\"row-bg\">\n          <el-col :span=\"24\">\n            <label class=\"input-label\">Email</label>\n            <el-form-item prop=\"email\">\n              <el-input type=\"email\" v-model=\"user.email\"></el-input>\n            </el-form-item>\n          </el-col>\n        </el-row>\n      </el-form>\n    </div>\n    <div class=\"content-container\">\n      <div class=\"user-inputs\" :class=\"{'scrolled': step == 2}\" v-if=\"step == 2\">\n        <!-- <span slot=\"title\" class=\"dialog-title\">Assign User Roles & Locations</span> -->\n        <!-- <span class=\"user-info\">{{user.firstName}} {{user.lastName}} - {{user.email}}</span> -->\n        <el-row :gutter=\"20\">\n          <el-col :span=\"6\">\n            <label class=\"select-label\">LOCATION</label>\n          </el-col>\n          <el-col :span=\"6\">\n            <label class=\"select-label\">ROLE</label>\n          </el-col>\n          <el-col :span=\"12\">\n            <label class=\"select-label\">COMMUNICATION PREFERENCE</label>\n          </el-col>\n          <div v-for=\"userLocation in userLocations\">\n            <el-col :span=\"6\">\n              <el-select placeholder=\"Select Location\" v-model=\"userLocation.locationId\" filterable >\n                <el-option\n                  v-for=\"location in locationOptions\"\n                  :key=\"location.locationId\"\n                  :value=\"location.locationId\"\n                  :label=\"location.name\"\n                ></el-option>\n              </el-select>\n            </el-col>\n            <el-col :span=\"6\">\n              <el-select placeholder=\"Select Role\" v-model=\"userLocation.role\">\n                <el-option v-for=\"role in roles\" :value=\"role.value\" :label=\"role.label\"></el-option>\n              </el-select>\n            </el-col>\n            <el-col :span=\"10\">\n              <el-select\n                placeholder=\"Select Multiple Types\"\n                :collapse-tags=\"true\"\n                multiple\n                v-model=\"userLocation.communications\"\n              >\n                <el-option v-for=\"option in communicationsOptions\" :value=\"option\" :label=\"option\"></el-option>\n              </el-select>\n            </el-col>\n          </div>\n        </el-row>\n      </div>\n      <el-row :gutter=\"20\" v-if=\"step == 2\">\n        <div class=\"add-item\" @click=\"addUserLocation()\">\n          <el-col v-if=\"userLocations.length == 0\" :span=\"20\">Add New</el-col>\n          <el-col v-else :span=\"20\">Add Another</el-col>\n          <!-- <el-button type=\"primary\" @click=\"addUserLocation()\">Add User Location</el-button> -->\n        </div>\n      </el-row>\n    </div>\n    <div slot=\"footer\" class=\"dialog-footer\">\n      <el-row type=\"flex\" class=\"row-bg\" justify=\"space-between\">\n        <el-col :span=\"step == 1 ? 12 : 7\">\n          <el-button type=\"text\" v-if=\"step == 1\" @click=\"closeModal\">Cancel</el-button>\n          <el-button type=\"text\" v-else @click=\"step = 1\">Go Back</el-button>\n        </el-col>\n        <el-col :span=\"step == 1 ? 12 : 7\">\n          <el-button\n            type=\"primary\"\n            v-if=\"step == 1\"\n            @click=\"validateUser('userForm')\"\n            class=\"btn-next\"\n          >Next Step</el-button>\n          <el-button type=\"primary\" v-else @click=\"saveUser()\" class=\"btn-next\">ADD USER</el-button>\n        </el-col>\n      </el-row>\n    </div>\n  </el-dialog>\n</template>\n\n<script>\nimport UserService from \"./../services/UserService\";\nimport { EventService } from \"../main\";\nimport imageFile from \"../assets/imageFile.js\";\n\nexport default {\n  name: \"addUser\",\n  props: [\"selectedUser\", \"assignUser\"],\n\n  data: function() {\n    var checkUserEmail = (rule, value, callback) => {\n      UserService.findUserByEmail(value).then(response => {\n        if(response && response.found) {\n          return callback(new Error('User email already found, please enter another valid email.'))\n        } else {\n          callback();\n        }\n      })\n    };\n    return {\n      pageAction: \"Create New\",\n      step: 1,\n      isSuperAdmin: \"\",\n      user: {\n        isSuperAdmin: false,\n        firstName: \"\",\n        lastName: \"\",\n        email: \"\"\n      },\n      userLocations: [],\n      newUserLocation: {\n        userId: \"\",\n        locationId: \"\",\n        role: \"\",\n        getEmail: true,\n        communications: []\n      },\n      locationOptions: [],\n      roles: [\n        { label: \"Owner\", value: \"owner\" },\n        { label: \"Manager\", value: \"manager\" },\n        { label: \"Agent\", value: \"agent\" },\n        { label: \"None\", value: \"none\" }\n      ],\n      communicationsOptions: [\n        \"New Review\",\n        \"Potential Negative Review\",\n        \"New Customer Message\"\n      ],\n      openedModal: true,\n      showLogoSizeError: false,\n      userImageBackground: \"\",\n      userRules: {\n        firstName: [\n          {\n            required: true,\n            message: \"Please input first name\",\n            trigger: \"blur\"\n          }\n        ],\n        lastName: [\n          { required: true, message: \"Please input last name\", trigger: \"blur\" }\n        ],\n        email: [\n          {\n            required: true,\n            type: \"email\",\n            message: \"Please input valid email\",\n            trigger: \"blur\"\n          },\n          {\n            validator: checkUserEmail,\n            message: \"User email already found, please enter another valid email.\",\n            trigger: \"blur\"\n          }\n        ]\n      }\n    };\n  },\n  computed: {\n    isDisabled() {\n      if (this.user.email) return this.user.email.indexOf(\" \") >= 0;\n    },\n    currentTitle() {\n      if (this.step == 1) {\n        return \"Add New User\";\n      } else {\n        return \"Assign User Roles & Locations\";\n      }\n    }\n  },\n  created() {\n    if (this.selectedUser) {\n      this.pageAction = \"Update\";\n      this.user = this.selectedUser;\n      if (this.user.userImage && this.user.userImage[0] !== \",\") {\n        this.setUserImageBackground(\n          \"data:image/png;base64,\" + this.user.userImage\n        );\n      } else if (this.user.userImage && this.user.userImage[0] == \",\") {\n        this.setUserImageBackground(\n          \"data:image/png;base64\" + this.user.userImage\n        );\n      }\n    }\n    var vm = this;\n    vm.isSuperAdmin = JSON.parse(\n      localStorage.getItem(\"currentUser\")\n    ).isSuperAdmin;\n    vm.locationOptions = JSON.parse(localStorage.getItem(\"locationOptions\"));\n    vm.userLocations.push(vm.newUserLocation);\n    let imgText = imageFile.imgBlock();\n    this.userImageBackground = 'url(\"data:image/png;base64,' + imgText;\n  },\n  methods: {\n    onChange() {\n      this.user.email = this.user.email.trim();\n      this.user.email = this.user.email.replace(\" \", \"\");\n    },\n    validateUser(ruleForm) {\n      let vm = this;\n      vm.$refs[ruleForm].validate(valid => {\n        if (valid) {\n          vm.step = 2;\n        } else {\n          return false;\n        }\n      });\n    },\n    saveUser() {\n      EventService.$emit(\"loading\", \"show\");\n      var vm = this;\n      UserService.saveUser(this.user).then(\n        function(response) {\n          if (response) {\n            vm.user = response;\n            EventService.$emit(\"loading\", \"hide\");\n            EventService.$emit(\"successMessage\", \"Hooray! User Saved.\");\n            vm.saveUserLocations(response);                        \n            vm.closeModal();\n          }\n        },\n        function(error) {\n          if (error == \"User already exists.\") {\n            EventService.$emit(\"loading\", \"hide\");\n            EventService.$emit(\n              \"warningMessage\",\n              \"User already exists, please contact an administrator if you believe this message is in error.\"\n            );\n          } else {\n            EventService.$emit(\"loading\", \"hide\");\n            EventService.$emit(\n              \"errorMessage\",\n              \"Sorry, something went wrong. Please try again.\"\n            );\n          }\n        }\n      );\n    },\n    saveUserLocations(user) {\n      var vm = this;\n      vm.userLocations.map(location => {\n        if (location.role == \"\" || location.role == \"None\") {\n          location.getsEmail = false;\n          UserService.saveUserLocation(\n            user.userId,\n            location.locationId,\n            location.role,\n            location.communications\n          ).then(\n            function(response) {\n              vm.closeModal()\n            },\n            function(error) {\n              console.log(error);\n            }\n          );\n          this.unassignUser(location);\n        } else {\n          UserService.saveUserLocation(\n            user.userId,\n            location.locationId,\n            location.role,\n            location.communications\n          ).then(\n            function(response) {              \n              vm.closeModal()\n            },\n            function(error) {\n              console.log(error);\n            }\n          );\n        }\n      vm.closeModal();\n      });\n    },\n    unassignUser: function(location) {\n      var vm = this;\n      UserService.removeUserLocation(vm.user.userId, location.locationId).then(\n        function(response) {},\n        function(error) {\n          console.log(error);\n        }\n      );\n    },\n    addUserLocation() {\n      let vm = this;\n      vm.userLocations.push(JSON.parse(JSON.stringify(vm.newUserLocation)));\n    },\n    closeModal: function() {\n      this.$emit(\"closeModal\");\n      this.user = {};\n      this.openedModal = false;\n      EventService.$emit(\"loading\", \"hide\");\n    },\n    switchModal(event, user) {\n      this.$emit(\"switchModal\", this.user);\n      EventService.$emit(\"loading\", \"hide\");\n    },\n    userImageChange: function() {\n      var element = this.$refs.imageUpload;\n      var vm = this;\n      this.showLogoSizeError = false;\n      this.userImageBackground = {};\n      if (element.files && element.files[0]) {\n        var reader = new FileReader();\n        reader.onloadend = function() {\n          if (reader.result.length > 500000 * 1.36) {\n            vm.showLogoSizeError = true;\n          } else {\n            vm.user.userImage = reader.result.substring(22);\n            vm.setUserImageBackground(reader.result);\n          }\n        };\n        reader.readAsDataURL(element.files[0]);\n      }\n    },\n    setUserImageBackground: function(rawData) {\n      this.userImageBackground = \"url('\" + rawData + \"')\";\n    }\n  }\n};\n</script>\n\n<style scoped>\n.content-container {\n  margin: auto;\n  width: 100%;\n}\n.user-inputs {\n  margin-top: 20px;\n  max-height: 400px;\n}\n.el-button {\n  width: 260px;\n}\n.select-label {\n  padding-left: 10px;\n}\n\n.scrolled {\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n.el-dialog__body {\n  width: 300px;\n  margin: auto;\n}\n.el-dialog .el-dialog__header {\n  padding: 0;\n}\n.user-info {\n  transform: translateY(-100%);\n  text-align: center;\n  color: #9a9a9a;\n}\n.add-item {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background: #fafafa;\n  height: 40px;\n  border: 1px solid #9a9a9a35;\n  border-radius: 12px;\n  margin-top: 20px;\n  transition: all 0.2s ease;\n  -webkit-transition: all 0.2s ease;\n  cursor: pointer;\n}\n.add-item:hover {\n  background: #f2f2f2;\n}\n.add-item > div {\n  display: flex;\n  justify-content: center;\n  text-transform: uppercase;\n}\n/* .dialog-title {\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  margin-bottom: 20px;\n  margin-top: 0;\n  font-size: 25px;\n} */\n\n.user-inputs .input-label {\n  font-size: 14px;\n  color: #9a9a9a;\n}\n\n.user-inputs .el-input {\n  margin-top: 5px;\n}\n.el-input__inner {\n  background: red !important;\n}\n.user-info {\n  margin: 0 auto;\n}\n\n.select-label {\n  margin-bottom: 10px;\n  font-weight: 600;\n}\n\n.user-inputs .el-select {\n  margin: 15px 5px 0px 5px;\n  width: 100%;\n}\n\n.add-button .el-button {\n  margin-top: 10px;\n  width: 100%;\n}\n\n.dialog-footer {\n  width: 100%;\n}\n</style>\n"]}]}